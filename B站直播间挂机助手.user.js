// ==UserScript==
// @namespace      https://github.com/andywang425
// @name           Bç«™ç›´æ’­é—´æŒ‚æœºåŠ©æ‰‹
// @name:en        Bç«™ç›´æ’­é—´æŒ‚æœºåŠ©æ‰‹
// @author         andywang425
// @description    è‡ªåŠ¨è·å–å°å¿ƒå¿ƒï¼Œå‚åŠ å¤©é€‰æ—¶åˆ»æŠ½å¥–ï¼Œç›´æ’­åŒºç­¾åˆ°ï¼Œåº”æ´å›¢ç­¾åˆ°ï¼Œé“¶ç“œå­æ¢ç¡¬å¸ï¼Œå®Œæˆä¸»ç«™æ¯æ—¥ä»»åŠ¡(ç™»å½•,è§‚çœ‹è§†é¢‘,æŠ•å¸,åˆ†äº«è§†é¢‘)ï¼Œæ‰¹é‡é€ç¤¼ï¼Œå‘é€ç²‰ä¸å‹‹ç« æ‰“å¡å¼¹å¹•ï¼Œå‚ä¸å®ç‰©æŠ½å¥–ï¼Œå‚ä¸Bilibiliç›´æ’­åŒºç¤¼ç‰©æŠ½å¥–ï¼Œå‚åŠ è¢«å¹¿æ’­çš„èŠ‚å¥é£æš´ï¼Œå®šæ—¶å‘å¼¹å¹•ï¼Œå¿«æ·è´­ä¹°ç²‰ä¸å‹‹ç« 
// @description:en è‡ªåŠ¨è·å–å°å¿ƒå¿ƒï¼Œå‚åŠ å¤©é€‰æ—¶åˆ»æŠ½å¥–ï¼Œç›´æ’­åŒºç­¾åˆ°ï¼Œåº”æ´å›¢ç­¾åˆ°ï¼Œé“¶ç“œå­æ¢ç¡¬å¸ï¼Œå®Œæˆä¸»ç«™æ¯æ—¥ä»»åŠ¡(ç™»å½•,è§‚çœ‹è§†é¢‘,æŠ•å¸,åˆ†äº«è§†é¢‘)ï¼Œæ‰¹é‡é€ç¤¼ï¼Œå‘é€ç²‰ä¸å‹‹ç« æ‰“å¡å¼¹å¹•ï¼Œå‚ä¸å®ç‰©æŠ½å¥–ï¼Œå‚ä¸Bilibiliç›´æ’­åŒºç¤¼ç‰©æŠ½å¥–ï¼Œå‚åŠ è¢«å¹¿æ’­çš„èŠ‚å¥é£æš´ï¼Œå®šæ—¶å‘å¼¹å¹•ï¼Œå¿«æ·è´­ä¹°ç²‰ä¸å‹‹ç« 
// @updateURL      https://raw.githubusercontent.com/andywang425/BLTH/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E9%97%B4%E6%8C%82%E6%9C%BA%E5%8A%A9%E6%89%8B.user.js
// @downloadURL    https://raw.githubusercontent.com/andywang425/BLTH/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E9%97%B4%E6%8C%82%E6%9C%BA%E5%8A%A9%E6%89%8B.user.js
// @homepageURL    https://github.com/andywang425/BLTH
// @supportURL     https://github.com/andywang425/BLTH/issues
// @icon           https://cdn.jsdelivr.net/gh/andywang425/BLTH@7d7ca494edd314806460e24c6b59be8ae1bd7dc6/img/script-icon.png
// @copyright      2020, andywang425 (https://github.com/andywang425)
// @license        MIT
// @compatible     chrome 80 or later
// @compatible     firefox 77 or later
// @compatible     opera 69 or later
// @version        5.6.3
// @include        /https?:\/\/live\.bilibili\.com\/[blanc\/]?[^?]*?\d+\??.*/
// @run-at         document-start
// @connect        passport.bilibili.com
// @connect        api.live.bilibili.com
// @connect        live-trace.bilibili.com
// @connect        sc.ftqq.com
// @require        https://cdn.jsdelivr.net/gh/andywang425/BLTH@adad0a90c758fd1cb441784f01e7ea4aa8bed123/modules/Ajax-hook.min.js
// @require        https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js
// @require        https://cdn.jsdelivr.net/gh/andywang425/BLTH@0f7a397839262357127a10cc8dfd2cbb5c706994/modules/BilibiliAPI_Mod.min.js
// @require        https://cdn.jsdelivr.net/gh/andywang425/BLTH@4716930900e64769f19dd7aa00b0824a4961cdd0/modules/layer.js
// @require        https://cdn.jsdelivr.net/gh/andywang425/BLTH@adad0a90c758fd1cb441784f01e7ea4aa8bed123/modules/libBilibiliToken.min.js
// @require        https://cdn.jsdelivr.net/gh/andywang425/BLTH@adad0a90c758fd1cb441784f01e7ea4aa8bed123/modules/libWasmHash.min.js
// @require        https://cdn.jsdelivr.net/gh/andywang425/BLTH@97bf818a906154a418f72ecbb644de9cf19c80b1/modules/base64.min.js
// @resource       layerCss https://cdn.jsdelivr.net/gh/andywang425/BLTH@d86732c07164300f64a2e543f264ce4f6099fbfc/modules/layer.css
// @grant          unsafeWindow
// @grant          GM_xmlhttpRequest
// @grant          GM_getResourceText
// @grant          GM_notification
// ==/UserScript==
(function(){const NAME="IGIFTMSG",BAPI=BilibiliAPI,UA=navigator.userAgent,tz_offset=(new Date).getTimezoneOffset()+480,W="undefined"==typeof unsafeWindow?window:unsafeWindow,eventListener=window.addEventListener,ts_ms=()=>Date.now(),ts_s=()=>Math.round(ts_ms()/1e3),anchorFollowTagName="BLTHå¤©é€‰å…³æ³¨UP",anchorPrizeTagName="BLTHå¤©é€‰ä¸­å¥–UP",delayCall=(e,t=12e4)=>{const i=$.Deferred();return setTimeout(()=>{const t=e();t&&t.then?t.then((e,t,n,o,a,r)=>i.resolve(e,t,n,o,a,r)):i.resolve()},t),i},MYDEBUG=(e,...t)=>{if(!debugSwitch)return;let i=new Date;i=`[${NAME}][${i.getHours()}:${i.getMinutes()}:${i.getSeconds()}:${i.getMilliseconds()}]`,1!==t.length?console.log(i,e+":",t):console.log(i,e+":",t[0])},runMidnight=(e,t)=>{const i=new Date;let n=t||" ";i.setMinutes(i.getMinutes()+tz_offset),i.setDate(i.getDate()+1),i.setHours(0,1,0,0),i.setMinutes(i.getMinutes()-tz_offset),setTimeout(e,i-ts_ms()),MYDEBUG("runMidnight",n+" "+i.toString())},runExactMidnight=(e,t)=>{const i=new Date;let n=t||" ";i.setMinutes(i.getMinutes()+tz_offset),i.setDate(i.getDate()+1),i.setHours(0,0,0,0),i.setMinutes(i.getMinutes()-tz_offset),setTimeout(e,i-ts_ms()),MYDEBUG("runExactMidnight",n+" "+i.toString())},runTomorrow=(e,t,i,n)=>{const o=new Date;let a=n||" ";o.setMinutes(o.getMinutes()+tz_offset),o.setDate(o.getDate()+1),o.setHours(t,i,0,0),o.setMinutes(o.getMinutes()-tz_offset),setTimeout(e,o-ts_ms()),MYDEBUG("runTomorrow",a+" "+o.toString())},appToken=new BilibiliToken,baseQuery=`actionKey=appkey&appkey=${BilibiliToken.appKey}&build=5561000&channel=bili&device=android&mobi_app=android&platform=android&statistics=%7B%22appId%22%3A1%2C%22platform%22%3A3%2C%22version%22%3A%225.57.0%22%2C%22abtest%22%3A%22%22%7D`,setToken=async()=>(tokenData.time>ts_s()||(tokenData=await appToken.getToken(),tokenData.time=ts_s()+tokenData.expires_in,localStorage.setItem(NAME+"_Token",JSON.stringify(tokenData))),userToken=tokenData,MYDEBUG(NAME+"_Token",tokenData),"OK"),newWindow={init:()=>newWindow.Toast.init(),Toast:{init:()=>{try{const e=[];return window.toast=(t,i="info",n=5e3)=>{switch(i){case"success":case"info":break;case"caution":break;case"error":break;default:i="info"}const o=$(`<div class="link-toast ${i} fixed" style="z-index:20000"><span class="toast-text">${t}</span></div>`)[0];document.body.appendChild(o),o.style.top=document.body.scrollTop+40*e.length+10+"px",o.style.left=document.body.offsetWidth+document.body.scrollLeft-o.offsetWidth-5+"px","hide"==msgHide&&$(".link-toast").hide(),e.push(o),setTimeout(()=>{o.className+=" out",setTimeout(()=>{e.shift(),e.forEach(e=>{e.style.top=parseInt(e.style.top,10)-40+"px"}),$(o).remove()},200)},n)},$.Deferred().resolve()}catch(e){return console.error("åˆå§‹åŒ–æµ®åŠ¨æç¤ºæ—¶å‡ºç°å¼‚å¸¸",e),$.Deferred().reject()}}}},addStyle=async()=>{const e=await GM_getResourceText("layerCss")+".chatLogDiv{text-align:center;border-radius:4px;min-height:30px;width:256px;color:#9585ff;line-height:30px;padding:0 10px;margin:10px auto}.chatLogMsg{word-wrap:break-word;width:100%;line-height:1em;margin-bottom:10px}.chatLogWarning{border:1px solid rgb(236,221,192);color:rgb(218,142,36);background:rgb(245,235,221) none repeat scroll 0% 0%}.chatLogSuccess{border:1px solid rgba(22,140,0,.28);color:rgb(69,171,69);background:none 0% 0% repeat scroll rgba(16,255,0,.18)}.chatLogError{border:1px solid rgba(255,0,39,.28);color:rgb(116,0,15);background:none 0% 0% repeat scroll rgba(255,0,39,.18)}.chatLogDefault{border:1px solid rgb(203,195,255);background:rgb(233,230,255) none repeat scroll 0% 0%}.igiftMsg_input{outline:none;border:1px solid #e9eaec;background-color:#fff;border-radius:4px;padding:1px 0 0;overflow:hidden;font-size:12px;line-height:19px;width:30px;z-index:9999}.igiftMsg_btn{background-color:#23ade5;color:#fff;border-radius:4px;border:none;padding:5px;cursor:pointer;box-shadow:0 0 2px #00000075;line-height:10px;z-index:9999}.igiftMsg_btn:active{background-color:#0e8bbd;position:relative;top:1px}.igiftMsg_fs{border:2px solid #d4d4d4;z-index:9999}.chatLogDiv{text-align:center;border-radius:4px;min-height:30px;width:256px;line-height:30px;padding:0 10px;margin:10px auto}.chatLogMsg{word-wrap:break-word;width:100%;line-height:1em;margin-bottom:10px}.chatLogWarning{border:1px solid rgb(209,194,164);color:rgb(190,125,33);background:rgb(255,223,175) none repeat scroll 0% 0%}.chatLogSuccess{border:1px solid rgba(22,140,0,.28);color:rgb(69,171,69);background:none 0% 0% repeat scroll rgba(16,255,0,.18)}.chatLogError{border:1px solid rgba(255,0,39,.28);color:rgb(116,0,15);background:none 0% 0% repeat scroll rgba(255,0,39,.18)}.chatLogDefault{border:1px solid rgb(203,195,255);color:#9585ff;background:rgb(233,230,255) none repeat scroll 0% 0%}.chatLogLottery{text-align:center;border-radius:4px;min-height:30px;width:256px;color:#9585ff;line-height:30px;padding:0 10px;margin:10px auto;border:1px solid rgb(203,195,255);background:rgb(233,230,255) none repeat scroll 0% 0%}.chatLogWinPrize{border:1px solid rgb(223,187,0);color:rgb(145,123,0);background:none 0% 0% repeat scroll rgb(255,215,0,30%)}.igiftMsg_num{min-width:12px;height:16px;padding:0 3px;border-radius:8px;line-height:16px;font-size:12px;text-align:center;color:#fff;position:absolute;top:6px;right:11px;z-index:10000;background-color:#fa5a57}.clickableText{font-size:12px;color:#0080c6;cursor:pointer;text-decoration:underline}code{padding:.2em .4em;margin:0;font-size:85%;background-color:rgb(27 31 35 / 5%);border-radius:6px}blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}",t=document.createElement("style");return t.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(t)},getScrollPosition=(e=window)=>({x:void 0!==e.pageXOffset?e.pageXOffset:e.scrollLeft,y:void 0!==e.pageYOffset?e.pageYOffset:e.scrollTop}),linkMsg=(e,t)=>'<a href="'+t+'"target="_blank" style="color:">'+e+"</a>",liveRoomUrl="https://live.bilibili.com/";let msgHide=localStorage.getItem(NAME+"_msgHide")||"hide",winPrizeNum=0,winPrizeTotalCount=0,SEND_GIFT_NOW=!1,SEND_DANMU_NOW=!1,hideBtnClickable=!0,getFollowBtnClickable=!0,unFollowBtnClickable=!0,mainSiteTasksBtnClickable=!0,danmuTaskRunning=!1,medalDanmuRunning=!1,debugSwitch="true"===localStorage.getItem(NAME+"_debugSwitch"),Live_info={room_id:void 0,uid:void 0,ruid:void 0,gift_list:void 0,rnd:void 0,visit_id:void 0,bili_jct:void 0,tid:void 0,uname:void 0,user_level:void 0,level:void 0},userToken=void 0,tokenData=JSON.parse(localStorage.getItem(NAME+"_Token"))||{time:0},mainIndex=void 0,menuIndex=void 0,layerMenuWindow=void 0,menuDiv=void 0,JQlogRedPoint=void 0,JQmenuWindow=void 0,layerMenuWindow_Height=void 0,layerMenuWindow_ScrollHeight=void 0,layerMenuWindow_ScrollTop=void 0,layerMenuWindow_ScrollY=void 0,awardScrollCount=0,nosleepConfig=void 0,INVISIBLE_ENTER_config=void 0,readConfigArray=[void 0];function init(){const MY_API={CONFIG_DEFAULT:{AUTO_DANMU:!1,AUTO_GIFT:!1,AUTO_GIFT_ROOMID:["0"],AUTO_GROUP_SIGN:!0,ANCHOR_LOTTERY:!1,ANCHOR_AUTO_DEL_FOLLOW:!1,ANCHOR_MAXROOM:600,ANCHOR_MAXLIVEROOM_SAVE:100,ANCHOR_CHECK_INTERVAL:5,ANCHOR_IGNORE_BLACKLIST:!0,ANCHOR_IGNORE_PWDROOM:!0,ANCHOR_BLACKLIST_WORD:["æµ‹è¯•","é’“é±¼","ç‚¸é±¼","å¤§èˆªæµ·","ä¸Šèˆ¹","èˆ°é•¿","è¿”ç°","æŠµç”¨","ä»£é‡‘","é»‘å±‹","ä¸Šè½¦","ä¸Šåèˆ¹"],ANCHOR_INTERVAL:250,AHCHOR_NEED_GOLD:0,ANCHOR_WAIT_REPLY:!0,ANCHOR_UPLOAD_DATA:!1,ANCHOR_UPLOAD_DATA_INTERVAL:10,ANCHOR_TYPE:"ANCHOR_POLLING",ANCHOR_GETDATA_ROOM:22474988,ANCHOR_PRIVATE_LETTER:!1,ANCHOR_LETTER_CONTENT:"UPæˆ‘ä¸­å¤©é€‰äº†ï¼Œè¯·é—®æ€ä¹ˆé¢†å¥–[doge]",ANCHOR_ADD_TO_WHITELIST:!1,ANCHOR_MOVETO_FOLLOW_TAG:!0,ANCHOR_MOVETO_PRIZE_TAG:!0,ANCHOR_DANMU:!1,ANCHOR_DANMU_CONTENT:["æˆ‘ä¸­å•¦ï¼","èŠœæ¹–"],CHECK_HOUR_ROOM:!1,CHECK_HOUR_ROOM_INTERVAL:600,ANCHOR_IGNORE_MONEY:0,COIN:!1,COIN_NUMBER:0,COIN_TYPE:"COIN_DYN",COIN_UID:["0"],DANMU_CONTENT:["è¿™æ˜¯ä¸€æ¡å¼¹å¹•"],DANMU_ROOMID:["22474988"],DANMU_INTERVAL_TIME:["10m"],EXCLUDE_ROOMID:["0"],FT_NOTICE:!1,FT_SCKEY:"SCKEY",GIFT_LIMIT:1,GIFT_SEND_HOUR:23,GIFT_SEND_MINUTE:59,GIFT_INTERVAL:5,GIFT_METHOD:"GIFT_SEND_TIME",GIFT_SORT:"GIFT_SORT_HIGH",GM_NOTICE:!1,IN_TIME_RELOAD_DISABLE:!1,LOTTERY:!1,LIVE_SIGN:!0,LOGIN:!0,LITTLE_HEART:!0,MEDAL_DANMU_ROOM:["0"],MEDAL_DANMU_METHOD:"MEDAL_DANMU_BLACK",MATERIAL_LOTTERY:!0,MATERIAL_LOTTERY_CHECK_INTERVAL:60,MATERIAL_LOTTERY_IGNORE_QUESTIONABLE_LOTTERY:!0,MEDAL_DANMU:!1,MEDAL_DANMU_CONTENT:["(âŒ’â–½âŒ’)","ï¼ˆï¿£â–½ï¿£ï¼‰","(=ãƒ»Ï‰ãƒ»=)","(ï½€ãƒ»Ï‰ãƒ»Â´)","(ã€œï¿£â–³ï¿£)ã€œ","(ï½¥âˆ€ï½¥)","(Â°âˆ€Â°)ï¾‰","(ï¿£3ï¿£)","â•®(ï¿£â–½ï¿£)â•­","_(:3ã€âˆ )_","(^ãƒ»Ï‰ãƒ»^ )","(â—ï¿£(ï½´)ï¿£â—)","Îµ=Îµ=(ãƒâ‰§âˆ‡â‰¦)ãƒ","â„(â„ â„â€¢â„Ï‰â„â€¢â„ â„)â„"],QUESTIONABLE_LOTTERY:["test","encrypt","æµ‹è¯•","é’“é±¼","åŠ å¯†","ç‚¸é±¼"],MATERIAL_LOTTERY_REM:10,RANDOM_DELAY:!0,RANDOM_SEND_DANMU:0,RANDOM_SKIP:0,REMOVE_ELEMENT_2233:!1,REMOVE_ELEMENT_activity:!0,REMOVE_ELEMENT_rank:!0,RND_DELAY_END:5,RND_DELAY_START:2,SEND_ALL_GIFT:!1,SHARE:!0,SILVER2COIN:!1,SPARE_GIFT_ROOM:"0",STORM:!1,STORM_MAX_COUNT:100,STORM_ONE_LIMIT:200,STORM_QUEUE_SIZE:3,TIME_AREA_DISABLE:!0,TIME_AREA_END_H0UR:8,TIME_AREA_END_MINUTE:0,TIME_AREA_START_H0UR:2,TIME_AREA_START_MINUTE:0,TIME_RELOAD:!1,TIME_RELOAD_MINUTE:120,WATCH:!0},CACHE_DEFAULT:{AUTO_SEND_DANMU_TS:[],AUTO_GROUP_SIGH_TS:0,DailyReward_TS:0,LiveReward_TS:0,Silver2Coin_TS:0,Gift_TS:0,GiftInterval_TS:0,LittleHeart_TS:0,materialobject_ts:0,AnchorLottery_TS:0,last_aid:659,medalDanmu_TS:0},CONFIG:{},CACHE:{},GIFT_COUNT:{COUNT:0,ANCHOR_COUNT:0,MATERIAL_COUNT:0,CLEAR_TS:0},init:async()=>{await addStyle();const e=$(".tab-list.dp-flex"),t=$(".tab-content"),i=t.offset(),n=$("#chat-history-list").outerWidth(!0),o=$("#aside-area-vm").height(),a=$("#chat-control-panel-vm").height(),r=i.top,l=i.left;menuDiv=$('<li data-v-2fdbecb2="" data-v-d2be050a="" class="item dp-i-block live-skin-separate-border border-box t-center pointer live-skin-normal-text" style = \'font-weight:bold;color: #999;\' id = "menuDiv"><span id="menuDivText">æ—¥å¿—</span><div class="igiftMsg_num" style="display: none;" id = \'logRedPoint\'>0</div></li>'),([".chat-history-list",".attention-btn-ctnr",".live-player-mounter"].some(e=>0===e.length)||0===e.length||0===t.length)&&window.toast("å¿…è¦é¡µé¢å…ƒç´ ç¼ºå¤±ï¼Œå¼ºåˆ¶è¿è¡Œï¼ˆå¯èƒ½ä¼šçœ‹ä¸åˆ°æ§åˆ¶é¢æ¿ï¼Œæç¤ºä¿¡æ¯ï¼‰","error"),e.append(menuDiv),JQlogRedPoint=$("#logRedPoint");let s=[];for(let t=0;t<e.children("li").length;t++)s.push(e.children("li")[t]);function d(e=!0){return e?t.hide():t.show()}menuIndex=await layer.open({type:1,title:!1,offset:[String(r-getScrollPosition().y)+"px",String(l-getScrollPosition().x)+"px"],closeBtn:0,shade:0,zIndex:9999,fixed:!1,area:[String(n)+"px",String(o-a)+"px"],anim:-1,isOutAnim:!1,resize:!1,content:'<div id = "menuWindow"></div>',success:()=>{layerMenuWindow=$("#layui-layer1 .layui-layer-content"),JQmenuWindow=$("#menuWindow");let e=$("#menuDivText");layerMenuWindow.on("DOMNodeInserted",(function(){layerMenuWindow_Height=$(this).height(),layerMenuWindow_ScrollHeight=$(this)[0].scrollHeight,layerMenuWindow_ScrollHeight>layerMenuWindow_Height&&(0===winPrizeNum&&e.text("æ—¥å¿—ğŸš€"),$(this).off("DOMNodeInserted"))})),layerMenuWindow.scroll((function(){layerMenuWindow_Height=$(this).height(),layerMenuWindow_ScrollHeight=$(this)[0].scrollHeight,layerMenuWindow_ScrollTop=$(this)[0].scrollTop,layerMenuWindow_ScrollY=layerMenuWindow_ScrollTop+layerMenuWindow_Height+1,layerMenuWindow_ScrollY<layerMenuWindow_ScrollHeight&&0===winPrizeNum?e.text("æ—¥å¿—ğŸš€"):e.text("æ—¥å¿—")}))}}),layer.style(menuIndex,{"box-shadow":"none",display:"none","z-index":990,"background-color":"#f2f3f5"});for(const e of s){let t=$(e);t.click(()=>{for(const i of s){let n=$(i);i!=e?("rgb(153, 153, 153)"!==n.css("color")&&n.css("color","#999"),n.hasClass("live-skin-main-text")&&n.removeClass("live-skin-main-text"),n.hasClass("active")&&n.removeClass("active"),n.hasClass("live-skin-normal-text")||n.addClass("live-skin-normal-text")):("rgb(51, 51, 51)"!==n.css("color")&&t.css("color","#333"),n.hasClass("live-skin-main-text")||t.addClass("live-skin-main-text"),n.hasClass("active")||t.addClass("active"),n.hasClass("live-skin-normal-text")&&t.removeClass("live-skin-normal-text"))}return"menuDiv"===t.attr("id")?(layer.style(menuIndex,{display:"block"}),0===winPrizeNum?(JQlogRedPoint.hide(),(layerMenuWindow_ScrollY<layerMenuWindow_ScrollHeight||void 0===layerMenuWindow_ScrollY)&&layerMenuWindow.scrollTop(layerMenuWindow.prop("scrollHeight"))):winPrizeNum>0&&awardScrollCount<winPrizeTotalCount&&$(".chatLogWinPrize").length>0&&($(".chatLogWinPrize")[awardScrollCount++].scrollIntoView(!1),$(window).scrollTop(0),JQlogRedPoint.text(--winPrizeNum),0===winPrizeNum&&JQlogRedPoint.hide()),d(!0)):(layer.style(menuIndex,{display:"none"}),d(!1))})}let _=$.Deferred(),c=$.Deferred(),A=$.Deferred();try{BAPI.setCommonArgs(Live_info.bili_jct),_.resolve()}catch(e){console.error(`[${NAME}]è®¾ç½®tokené”™è¯¯`,e),_.reject()}try{MY_API.loadConfig().then(()=>{MY_API.chatLog("è„šæœ¬è½½å…¥é…ç½®æˆåŠŸ","success"),c.resolve()})}catch(e){console.error("APIåˆå§‹åŒ–å‡ºé”™",e),MY_API.chatLog("APIåˆå§‹åŒ–å‡ºé”™","error"),c.reject()}try{MY_API.loadCache().then(()=>{window.toast("CACHEè½½å…¥æˆåŠŸ","success"),A.resolve()})}catch(e){console.error("CACHEåˆå§‹åŒ–å‡ºé”™",e),window.toast("CACHEåˆå§‹åŒ–å‡ºé”™","error"),A.reject()}return $.when(_,c,A)},loadConfig:()=>{let e=$.Deferred();try{const t=JSON.parse(localStorage.getItem(NAME+"_CONFIG"));$.extend(!0,MY_API.CONFIG,MY_API.CONFIG_DEFAULT);for(const e in MY_API.CONFIG)MY_API.CONFIG.hasOwnProperty(e)&&void 0!==t[e]&&null!==t[e]&&(MY_API.CONFIG[e]=t[e]);MY_API.loadGiftCount(),e.resolve()}catch(t){MYDEBUG("APIè½½å…¥é…ç½®å¤±è´¥ï¼ŒåŠ è½½é»˜è®¤é…ç½®",t),MY_API.setDefaults(),e.reject()}return e},loadCache:()=>{let e=$.Deferred();try{const t=JSON.parse(localStorage.getItem(NAME+"_CACHE"));$.extend(!0,MY_API.CACHE,MY_API.CACHE_DEFAULT);for(const e in MY_API.CACHE)MY_API.CACHE.hasOwnProperty(e)&&void 0!==t[e]&&null!==t[e]&&(MY_API.CACHE[e]=t[e]);e.resolve()}catch(t){MYDEBUG("CACHEè½½å…¥é…ç½®å¤±è´¥ï¼ŒåŠ è½½é»˜è®¤é…ç½®",t),MY_API.setDefaults(),e.reject()}return e},newMessage:e=>{try{const t=localStorage.getItem(NAME+"_NEWMSG_CACHE");null!=t&&t===e||(layer.open({title:e+"æ›´æ–°æç¤º",content:`\n                            1.æ–°å¢ä¸¤ç§èƒ½è¯†åˆ«çš„å¤©é€‰æ—¶åˆ»ç§ç±»<br>\n                            2.ç›´æ’­ç”»é¢å…¨å±åè‡ªåŠ¨å…³é—­é¢æ¿<br>\n                            3.ä¿®å¤ç§»åŠ¨åˆ†ç»„ç­‰ç½‘ç»œè¯·æ±‚è¢«é£æ§ä½¿è„šæœ¬åœæ­¢è¿è¡Œçš„é—®é¢˜<br>\n                            4.æ–°å¢<code>æ§åˆ¶å°æ—¥å¿—</code>é€‰é¡¹<br>\n                            5.è‹¥å¯ç”¨éœ€åˆ›å»ºåˆ†ç»„çš„åŠŸèƒ½åˆ™ä¸åˆ›å»º<br>\n                            6.<strong>æ–°é€‰é¡¹ï¼šä¸å‚ä¸åŠ å¯†ç›´æ’­é—´çš„å¤©é€‰</strong><br>\n                            7.ä¼˜åŒ–äº†è¯·æ±‚å¤±è´¥åå†æ¬¡å°è¯•å‘èµ·è¯·æ±‚çš„é€»è¾‘<br>\n                            <hr>\n                            <em style="color:grey;">\n                            å¦‚æœä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œæ¬¢è¿å»${linkMsg("github","https://github.com/andywang425/BLTH/issues")}\n                            ï¼ˆæˆ–è€…è¿›qqç¾¤${linkMsg("1106094437","https://jq.qq.com/?_wv=1027&amp;k=fCSfWf1O")}ï¼‰åé¦ˆã€‚\n                            </em>`}),localStorage.setItem(NAME+"_NEWMSG_CACHE",e))}catch(e){MYDEBUG("æç¤ºä¿¡æ¯CACHEè½½å…¥å¤±è´¥",e)}},saveConfig:(e=!0)=>{try{return localStorage.setItem(NAME+"_CONFIG",JSON.stringify(MY_API.CONFIG)),e&&window.toast("é…ç½®å·²ä¿å­˜ï¼Œéƒ¨åˆ†è®¾ç½®éœ€åˆ·æ–°åæ‰èƒ½ç”Ÿæ•ˆ","info"),MYDEBUG("MY_API.CONFIG",MY_API.CONFIG),!0}catch(e){return MYDEBUG("APIä¿å­˜å‡ºé”™",e),!1}},saveCache:(e=!0)=>{try{return localStorage.setItem(NAME+"_CACHE",JSON.stringify(MY_API.CACHE)),e&&MYDEBUG("CACHEå·²ä¿å­˜",MY_API.CACHE),!0}catch(e){return MYDEBUG("CACHEä¿å­˜å‡ºé”™",e),!1}},setDefaults:()=>{MY_API.CONFIG=MY_API.CONFIG_DEFAULT,MY_API.CACHE=MY_API.CACHE_DEFAULT,MY_API.saveConfig(),MY_API.saveCache(),MY_API.chatLog("é…ç½®å’ŒCACHEå·²é‡ç½®ä¸ºé»˜è®¤ã€‚3ç§’ååˆ·æ–°é¡µé¢"),setTimeout(()=>{window.location.reload()},3e3)},ReDoAllTasks:()=>{window.toast("3ç§’åå†æ¬¡æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡","info"),setTimeout(()=>{MY_API.CACHE=MY_API.CACHE_DEFAULT,MY_API.GroupSign.run(),MY_API.DailyReward.run(),MY_API.LiveReward.run(),MY_API.Exchange.runS2C(),MY_API.Gift.run(),MY_API.LITTLE_HEART.run(),MY_API.AUTO_DANMU.run(),MY_API.MaterialObject.run(),MY_API.AnchorLottery.run(),MY_API.MEDAL_DANMU.run()},3e3)},loadGiftCount:()=>{try{const e=JSON.parse(localStorage.getItem(NAME+"_GIFT_COUNT"));for(const t in MY_API.GIFT_COUNT)MY_API.GIFT_COUNT.hasOwnProperty(t)&&void 0!==e[t]&&null!==e[t]&&(MY_API.GIFT_COUNT[t]=e[t]);MYDEBUG("MY_API.GIFT_COUNT",MY_API.GIFT_COUNT)}catch(e){MYDEBUG("è¯»å–ç»Ÿè®¡å¤±è´¥",e)}},saveGiftCount:(e=!0)=>{try{return localStorage.setItem(NAME+"_GIFT_COUNT",JSON.stringify(MY_API.GIFT_COUNT)),e&&MYDEBUG("ç»Ÿè®¡ä¿å­˜æˆåŠŸ",MY_API.GIFT_COUNT),!0}catch(e){return MYDEBUG("ç»Ÿè®¡ä¿å­˜å‡ºé”™",e),!1}},addAnchor:(e=1)=>{MY_API.GIFT_COUNT.ANCHOR_COUNT+=e,$("#giftCount span:eq(0)").text(MY_API.GIFT_COUNT.ANCHOR_COUNT),MY_API.saveGiftCount(!1)},addMaterial:(e=1)=>{MY_API.GIFT_COUNT.MATERIAL_COUNT+=e,$("#giftCount span:eq(1)").text(MY_API.GIFT_COUNT.MATERIAL_COUNT),MY_API.saveGiftCount(!1)},removeUnnecessary:()=>{const e=["#my-dear-haruna-vm",".activity-entry",".activity-rank"],t=["REMOVE_ELEMENT_2233","REMOVE_ELEMENT_activity","REMOVE_ELEMENT_rank"],i=i=>{MY_API.CONFIG[t[i]]&&setInterval(()=>{const t=$(e[i]);t.length>0&&t.remove()},200)};for(let t=0;t<e.length;t++)i(t)},buyFanMedal:e=>BAPI.live_user.get_anchor_in_room(e).then((function(e){if(MYDEBUG("API.live_user.get_anchor_in_room response",e),0===e.code&&e.data.info){const t=String(e.data.info.uid),i=e.data.info.uname;layer.confirm(`<div style = "text-align:center">æ˜¯å¦æ¶ˆè€—20ç¡¬å¸è´­ä¹°UPä¸»<br>${linkMsg(i,"https://space.bilibili.com/"+t)}<br>çš„ç²‰ä¸å‹‹ç« ï¼Ÿ</div>`,{title:"è´­ä¹°å‹‹ç« ",btn:["æ˜¯","å¦"]},(function(){return BAPI.link_group.buy_medal(e.data.info.uid).then(e=>{MYDEBUG("API.link_group.buy_medal re",e),0===e.code?layer.msg("è´­ä¹°æˆåŠŸ",{time:2e3,icon:1}):layer.msg("è´­ä¹°å¤±è´¥ "+e.message,{time:2500,icon:2})})}),(function(){layer.msg("å·²å–æ¶ˆè´­ä¹°",{time:2e3})}))}else 0===e.code&&void 0===e.data.info?layer.msg("æˆ¿é—´ä¸å­˜åœ¨",{time:2500}):layer.msg("æ£€æŸ¥æˆ¿é—´å‡ºé”™ "+e.message,{time:2500})})),creatSetBox:async()=>{const e=$(`<button class="igiftMsg_btn" style="display: inline-block; float: left; margin-right: 7px;cursor: pointer;box-shadow: 1px 1px 2px #00000075;" id="hiderbtn">${"hide"==msgHide?"æ˜¾ç¤ºçª—å£å’Œæç¤ºä¿¡æ¯":"éšè—çª—å£å’Œæç¤ºä¿¡æ¯"}<br></button>`),t=$(".bilibili-live-player.relative");let i='"float:left"';UA.toLowerCase().indexOf("firefox")>-1&&(i='""');const n=`<div id='allsettings' class="igiftMsg_main">\n                <fieldset class="igiftMsg_fs">\n                    <legend style="color: black">ä»Šæ—¥ç»Ÿè®¡</legend>\n                <span data-toggle="topArea">\n                    <span id="giftCount" style="font-size: large; font-weight: bold; color: blueviolet;">\n                        å‚ä¸å¤©é€‰æ—¶åˆ»&nbsp;<span>0</span>&nbsp;æ¬¡\n                        å‚ä¸å®ç‰©æŠ½å¥–&nbsp;<span>0</span>&nbsp;æ¬¡\n                        &nbsp;<button style="font-size: small" class="igiftMsg_btn" data-action="save">ä¿å­˜æ‰€æœ‰è®¾ç½®</button>\n                    </span>\n                </span>\n                </fieldset>\n                <div id="left_fieldset" style=${i}>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">æŠ½å¥–è®¾ç½®</legend>\n                        <div data-toggle="LOTTERY">\n                            <label style="margin: 5px auto; color: purple;line-height:30px" ;>\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                å‚ä¸ç¤¼ç‰©æŠ½å¥–\n                            </label>\n                        </div>\n                        <div data-toggle="RANDOM_DELAY">\n                            <label style="margin: 5px auto; color: darkgreen">&nbsp;&nbsp;&nbsp;&nbsp;\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                æŠ½å¥–é™„åŠ éšæœºå»¶è¿Ÿ\n                                <input class="RND_DELAY_START igiftMsg_input" style="width: 30px;vertical-align: top;" type="text">~\n                                <input class="RND_DELAY_END igiftMsg_input" style="width: 30px;vertical-align: top;" type="text">s\n                            </label>\n                        </div>\n                        <div data-toggle="RANDOM_SKIP">\n                            <label style="margin: 5px auto; color: darkgreen">&nbsp;&nbsp;&nbsp;&nbsp;\n                                éšæœºè·³è¿‡æŠ½å¥–<input class="per igiftMsg_input" style="width: 30px;" type="text">%\n                            </label>\n                        </div>\n                        <div data-toggle="RANDOM_SEND_DANMU">\n                            <label style="margin: 5px auto; color: darkgreen">&nbsp;&nbsp;&nbsp;&nbsp;\n                                æŠ½å¥–æ—¶æ´»è·ƒå¼¹å¹•å‘é€æ¦‚ç‡(0åˆ°5,ä¸º0åˆ™ä¸å‘é€)<input class="per igiftMsg_input" style="width: 30px;" type="text">%\n                            </label>\n                        </div>\n                        <div data-toggle="CHECK_HOUR_ROOM">\n                            <label style="margin: 5px auto; color: darkgreen">&nbsp;&nbsp;&nbsp;&nbsp;\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                æ£€æŸ¥å°æ—¶æ¦œï¼ˆé—´éš”æ—¶é—´<input class="num igiftMsg_input" style="width: 25px;" type="text">ç§’ï¼‰\n                            </label>\n                        </div>\n                        <div data-toggle="MATERIAL_LOTTERY" style="line-height: 20px">\n                            <label style="margin: 5px auto; color: purple;">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                å‚ä¸å®ç‰©æŠ½å¥–\n                            </label>\n                        </div>\n                        <div data-toggle="MATERIAL_LOTTERY_CHECK_INTERVAL">\n                            <label style="margin: 5px auto; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;\n                                æ£€æŸ¥é—´éš”\n                                <input class="num igiftMsg_input" style="width: 30px;" type="text">\n                                åˆ†é’Ÿ\n                            </label>\n                        </div>\n                        <div data-toggle="MATERIAL_LOTTERY_REM">\n                            <label style="margin: 5px auto; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;\n                                æ£€æµ‹åˆ°\n                                <input class="num igiftMsg_input" style="width: 30px;" type="text">\n                                ä¸ªä¸å­˜åœ¨æ´»åŠ¨çš„aidååœæ­¢æ£€æµ‹\n                            </label>\n                        </div>\n                        <div data-toggle="MATERIAL_LOTTERY_IGNORE_QUESTIONABLE_LOTTERY">\n                            <label style="margin: 5px auto; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                å¿½ç•¥å…³é”®å­—\n                                <label class='str' style='font-weight:bold'>0ä¸ª</label>\n                                &nbsp;<button style="font-size: small" class="igiftMsg_btn"\n                                    data-action="edit_QUESTIONABLE_LOTTERY">ç¼–è¾‘</button>\n                            </label>\n                        </div>\n                    </fieldset>\n            \n                    <fieldset class="igiftMsg_fs" style="line-height:16px;">\n                        <legend style="color: black">æ¯æ—¥ä»»åŠ¡è®¾ç½®</legend>\n                        <div data-toggle="LOGIN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            ç™»é™†\n                        </div>\n                        <div data-toggle="WATCH" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            è§‚çœ‹è§†é¢‘\n                        </div>\n                        <div data-toggle="COIN" style=" color: black">\n                            <label style="cursor: pointer">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                è‡ªåŠ¨æŠ•å¸<input class="coin_number igiftMsg_input" style="width: 40px;" type="text">ä¸ª(0-5)\n                            </label>\n                        </div>\n                        <div data-toggle="COIN_TYPE" style=" color: black">\n                            <div data-toggle="COIN_UID">\n                                <input style="vertical-align: text-top;" type="radio" name="COIN_TYPE">\n                                ç»™ç”¨æˆ·(UID:<input class="num igiftMsg_input" style="width: 150px;" type="text">)\n                                çš„è§†é¢‘æŠ•å¸\n                            </div>\n                            <div data-toggle="COIN_DYN">\n                                <input style="vertical-align: text-top;" type="radio" name="COIN_TYPE">\n                                ç»™åŠ¨æ€ä¸­çš„çš„è§†é¢‘æŠ•å¸\n                            </div>\n                        </div>\n                        <div data-toggle="SHARE" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            åˆ†äº«è§†é¢‘\n                        </div>\n                        <div data-toggle="SILVER2COIN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            é“¶ç“œå­æ¢ç¡¬å¸\n                        </div>\n                        <div data-toggle="LIVE_SIGN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            ç›´æ’­åŒºç­¾åˆ°\n                        </div>\n                        <div data-toggle="AUTO_GROUP_SIGN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            åº”æ´å›¢ç­¾åˆ°\n                        </div>\n                        <div data-toggle="MEDAL_DANMU" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            ç²‰ä¸å‹‹ç« æ‰“å¡å¼¹å¹•\n                            &nbsp;<button style="font-size: small" class="igiftMsg_btn"\n                                data-action="edit_medalDanmu">ç¼–è¾‘å¼¹å¹•å†…å®¹</button>\n                        </div>\n                        <div data-toggle="MEDAL_DANMU_METHOD" style="line-height: 15px; color: black; display:inline">\n                        &nbsp;&nbsp;&nbsp;&nbsp;\n                        æ‰“å¡å¼¹å¹•æ¨¡å¼ï¼š\n                        <div data-toggle="MEDAL_DANMU_WHITE" style="color: black; display:inline">\n                            <input style="vertical-align: text-top;" type="radio" name="MEDAL_DANMU_METHOD">\n                            ç™½åå•\n                        </div>\n                        <div data-toggle="MEDAL_DANMU_BLACK" style="color: black; display:inline">\n                            <input style="vertical-align: text-top;" type="radio" name="MEDAL_DANMU_METHOD">\n                            é»‘åå•\n                        </div>\n                        &nbsp;<button style="font-size: small" class="igiftMsg_btn" data-action="edit_lightMedalList">ç¼–è¾‘æˆ¿é—´åˆ—è¡¨</button>\n                    </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">è‡ªåŠ¨é€ç¤¼è®¾ç½®</legend>\n                        <div data-toggle="AUTO_GIFT" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            è‡ªåŠ¨é€ç¤¼\n                        </div>\n            \n                        <div data-toggle="AUTO_GIFT_ROOMID" style=" color: purple">\n                            ä¼˜å…ˆé€ç¤¼æˆ¿é—´\n                            <input class="num igiftMsg_input" style="width: 150px;" type="text">\n                        </div>\n            \n                        <div data-toggle="EXCLUDE_ROOMID" style=" color: purple">\n                            ä¸é€ç¤¼æˆ¿é—´\n                            <input class="num igiftMsg_input" style="width: 150px;" type="text">\n                        </div>\n                        <div data-toggle="GIFT_INTERVAL" style=" color: black">\n                            <input style="vertical-align: text-top;" type="radio" name="GIFT_METHOD">\n                            é—´éš”\n                            <input class="num igiftMsg_input" style="width: 30px;" type="text">\n                            åˆ†é’Ÿé€ç¤¼\n                        </div>\n                        <div data-toggle="GIFT_SEND_TIME" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="radio" name="GIFT_METHOD">\n                            å®šæ—¶é€ç¤¼<br>&nbsp;&nbsp;&nbsp;&nbsp;\n                            é€ç¤¼æ—¶é—´\n                            <input class="Hour igiftMsg_input" style="width: 20px;" type="text">ç‚¹\n                            <input class="Minute igiftMsg_input" style="width: 20px;" type="text">åˆ†\n                            &nbsp;<button style="font-size: small" class="igiftMsg_btn" data-action="sendGiftNow">ç«‹åˆ»å¼€å§‹é€ç¤¼</button>\n                        </div>\n            \n                        <div data-toggle="GIFT_LIMIT" style=" color: purple">\n                            ç¤¼ç‰©åˆ°æœŸæ—¶é—´\n                            <input class="num igiftMsg_input" style="width: 20px;" type="text">\n                            å¤©\n                        </div>\n                        <div data-toggle="GIFT_SORT_HIGH" style=" color: black;line-height: 20px;">\n                            ç²‰ä¸ç‰Œé€ç¤¼ä¼˜å…ˆçº§<br>\n                            &nbsp;&nbsp;&nbsp;&nbsp;<input style="vertical-align: text-top;" type="radio" name="GIFT_SORT">\n                            ä¼˜å…ˆ<strong style="color: purple">é«˜</strong>ç­‰çº§ç²‰ä¸ç‰Œ\n                        </div>\n                        <div data-toggle="GIFT_SORT_LOW" style=" color: black">\n                            &nbsp;&nbsp;&nbsp;&nbsp;<input style="vertical-align: text-top;" type="radio" name="GIFT_SORT">\n                            ä¼˜å…ˆ<strong style="color: purple">ä½</strong>ç­‰çº§ç²‰ä¸ç‰Œ\n                        </div>\n                        <div data-toggle="SEND_ALL_GIFT" style="color: #ff5200;line-height:20px;">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            æ— è§†ç¤¼ç‰©ç±»å‹å’Œåˆ°æœŸæ—¶é—´é™åˆ¶\n                        </div>\n                        <div data-toggle="SPARE_GIFT_ROOM" style="color: black;line-height:20px;">\n                            å‰©ä½™ç¤¼ç‰©é€ç¤¼ç›´æ’­é—´ï¼š\n                            <input class="num igiftMsg_input" type="text" style="width: 100px;">\n                        </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">èŠ‚å¥é£æš´è®¾ç½®</legend>\n                        <div data-toggle="STORM" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: #ff5200">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                å‚ä¸èŠ‚å¥é£æš´\n                            </label>\n                        </div>\n                        <div data-toggle="STORM_QUEUE_SIZE" style="color: black">\n                            å…è®¸åŒæ—¶å‚ä¸çš„èŠ‚å¥é£æš´æ¬¡æ•°ï¼š\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                        </div>\n                        <div data-toggle="STORM_MAX_COUNT" style="color: black">\n                            å•ä¸ªé£æš´æœ€å¤§å°è¯•æ¬¡æ•°ï¼š\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                        </div>\n                        <div data-toggle="STORM_ONE_LIMIT" style="color: black">\n                            å•ä¸ªé£æš´å‚ä¸æ¬¡æ•°é—´éš”ï¼š\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                            æ¯«ç§’\n                        </div>\n                    </fieldset>\n                </div>\n            \n            \n            \n                <div id="right_fieldset" style=${i}>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">è´­ä¹°ç²‰ä¸å‹‹ç« </legend>\n                        <div data-toggle="BUY_MEDAL" style="color: black; line-height: 15px">\n                            è¾“å…¥ç²‰ä¸å‹‹ç« å¯¹åº”æˆ¿é—´å·ï¼š<input class="num igiftMsg_input" type="text" value=${Live_info.room_id} onclick="select();"\n                                style="width: 70px">\n                            &nbsp;<button class="igiftMsg_btn" data-action="buy_medal">ç‚¹å‡»è´­ä¹°å‹‹ç« </button>\n                        </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">å°å¿ƒå¿ƒ</legend>\n                        <div data-toggle="LITTLE_HEART" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox"> è‡ªåŠ¨è·å–å°å¿ƒå¿ƒ\n                            </label>\n                        </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">å¤©é€‰æ—¶åˆ»</legend>\n                        <div data-toggle="ANCHOR_LOTTERY" style="line-height: 20px">\n                            <label style="margin: 5px auto; color: purple">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                å‚åŠ å¤©é€‰æ—¶åˆ»æŠ½å¥–\n                            </label>\n                        </div>\n            \n                        <div data-toggle="ANCHOR_POLLING" style="line-height: 20px">\n                            <input style="vertical-align: text-top;" type="radio" name="ANCHOR_TYPE">\n                            è½®è¯¢ç›´æ’­é—´è·å–å¤©é€‰æ—¶åˆ»æ•°æ®\n                        </div>\n                        <div data-toggle="ANCHOR_MAXROOM" style="line-height: 20px">\n                            <label style="margin: 5px auto; color: black">\n                                &nbsp;&nbsp;&nbsp;&nbsp;\n                                æ£€æŸ¥æˆ¿é—´æœ€å¤§æ•°é‡\n                                <input class="roomNum igiftMsg_input" style="width: 50px;" type="text">\n                            </label>\n                        </div>\n                        <div data-toggle="ANCHOR_UPLOAD_DATA" style="line-height: 20px">\n                            <label style="margin: 5px auto; color: purple">\n                                &nbsp;&nbsp;&nbsp;&nbsp;\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                ä¸Šä¼ å¤©é€‰æ•°æ®è‡³ç›´æ’­é—´ä¸ªäººç®€ä»‹(é—´éš”\n                                <input class="num igiftMsg_input" style="width: 30px;" type="text">\n                                ç§’)\n                            </label>\n                        </div>\n                        <div data-toggle="ANCHOR_MAXLIVEROOM_SAVE" style="line-height: 20px">\n                            <label style="margin: 5px auto; color: black">\n                                &nbsp;&nbsp;&nbsp;&nbsp;\n                                ä¸ªäººç®€ä»‹å‚¨å­˜æˆ¿é—´æœ€å¤§æ•°é‡\n                                <input class="roomNum igiftMsg_input" style="width: 50px;" type="text">\n                            </label>\n                        </div>\n                        <div data-toggle="ANCHOR_LIVEROOM" style="line-height: 20px">\n                            <input style="vertical-align: text-top;" type="radio" name="ANCHOR_TYPE">\n                            ä»ç›´æ’­é—´\n                            <input class="num igiftMsg_input" style="width: 100px;" type="text">\n                            çš„ä¸ªäººç®€ä»‹è·å–å¤©é€‰æ—¶åˆ»æ•°æ®\n                        </div>\n            \n                        <div data-toggle="ANCHOR_CHECK_INTERVAL" style="line-height: 20px">\n                            <label style="margin: 5px auto; color: black">\n                                å¤©é€‰è·å–æ•°æ®é—´éš”\n                                <input class="num igiftMsg_input" style="width: 25px;" type="text">\n                                åˆ†é’Ÿ\n                            </label>\n                        </div>\n                        <div data-toggle="AHCHOR_NEED_GOLD" style="line-height: 20px">\n                            <label style="margin: 5px auto; color: black">\n                                å¿½ç•¥æ‰€éœ€é‡‘ç“œå­å¤§äº\n                                <input class="num igiftMsg_input" style="width: 50px;" type="text">\n                                çš„å¤©é€‰\n                            </label>\n                        </div>\n                        <div data-toggle="ANCHOR_IGNORE_BLACKLIST" style="line-height: 20px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                å¿½ç•¥å…³é”®å­—\n                                <label class='str' style='font-weight:bold'>0ä¸ª</label>\n                                &nbsp;<button style="font-size: small" class="igiftMsg_btn"\n                                    data-action="edit_ANCHOR_BLACKLIST_WORD">ç¼–è¾‘</button>\n                            </label>\n                        </div>\n                        <div data-toggle="ANCHOR_IGNORE_MONEY" style="line-height: 20px">\n                            <label style="margin: 5px auto; color: black">\n                                å¿½ç•¥é‡‘é¢å°äº\n                                <input class="num igiftMsg_input" style="width: 30px;" type="text">\n                                å…ƒçš„å¤©é€‰\n                            </label>\n                        </div>\n                        <div data-toggle="ANCHOR_INTERVAL" style="line-height: 20px">\n                            <label style="margin: 5px auto; color: black">\n                                è¯·æ±‚é—´éš”\n                                <input class="num igiftMsg_input" style="width: 30px;" type="text">\n                                æ¯«ç§’\n                            </label>\n                        </div>\n                        <div data-toggle="ANCHOR_WAIT_REPLY" style="line-height: 20px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                å‘å‡ºè¯·æ±‚åç­‰å¾…å›å¤\n                            </label>\n                        </div>\n                        <div data-toggle="ANCHOR_IGNORE_PWDROOM" style="line-height: 20px">\n                        <label style="margin: 5px auto; color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                                ä¸å‚ä¸åŠ å¯†ç›´æ’­é—´çš„å¤©é€‰\n                        </label>\n                        </div>\n                        <div data-toggle="ANCHOR_MOVETO_FOLLOW_TAG" style="line-height: 20px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                æŠŠå‚ä¸å¤©é€‰æ—¶å…³æ³¨çš„UPç§»åˆ°æ–°åˆ†ç»„\n                                &nbsp;<button style="font-size: small;color: red;" class="igiftMsg_btn"\n                                data-action="removeAnchorFollowingInTag">å–å…³è¯¥åˆ†ç»„å†…çš„UPä¸»</button>\n                            </label>\n                        </div>\n                        æ£€æµ‹åˆ°<strong style="color: purple">æœªä¸­å¥–</strong>å<br>\n                        <div data-toggle="ANCHOR_AUTO_DEL_FOLLOW" style="line-height: 20px">\n                            <label style="margin: 5px auto; color: black">\n                                &nbsp;&nbsp;&nbsp;&nbsp;\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                è‡ªåŠ¨å–å…³å‘èµ·æŠ½å¥–çš„UP\n                            </label>\n                        </div>\n                        æ£€æµ‹åˆ°<strong style="color: purple">ä¸­å¥–</strong>å<br>\n                        <div data-toggle="ANCHOR_PRIVATE_LETTER" style="line-height: 25px">\n                            <label style="margin: 5px auto; color: black">\n                                &nbsp;&nbsp;&nbsp;&nbsp;\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                ç»™å‘èµ·æŠ½å¥–çš„UPå‘ä¸€æ¡ç§ä¿¡\n                                &nbsp;<button style="font-size: small" class="igiftMsg_btn"\n                                    data-action="edit_ANCHOR_LETTER_CONTENT">ç¼–è¾‘ç§ä¿¡å†…å®¹</button>\n                            </label>\n                        </div>\n                        <div data-toggle="ANCHOR_DANMU" style="line-height: 25px">\n                        <label style="margin: 5px auto; color: black">\n                            &nbsp;&nbsp;&nbsp;&nbsp;\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            åœ¨å¯¹åº”ç›´æ’­é—´å‘ä¸€æ¡å¼¹å¹•\n                            &nbsp;<button style="font-size: small" class="igiftMsg_btn"\n                            data-action="edit_ANCHOR_DANMU_CONTENT">ç¼–è¾‘å¼¹å¹•å†…å®¹</button>\n                        </label>\n                        </div>\n                        <div data-toggle="ANCHOR_MOVETO_PRIZE_TAG" style="line-height: 20px">\n                        <label style="margin: 5px auto; color: black">\n                            &nbsp;&nbsp;&nbsp;&nbsp;\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            æŠŠå‘èµ·æŠ½å¥–çš„UPç§»åˆ°æ–°åˆ†ç»„\n                            &nbsp;<button style="font-size: small;color: red;" class="igiftMsg_btn"\n                            data-action="removeAnchorPrizeInTag">å–å…³è¯¥åˆ†ç»„å†…çš„UPä¸»</button>\n                        </label>\n                    </div>\n                        <div data-toggle="ANCHOR_ADD_TO_WHITELIST" style="line-height: 25px">\n                            <label style="margin: 5px auto; color: black">\n                                &nbsp;&nbsp;&nbsp;&nbsp;\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                æŠŠå‘èµ·æŠ½å¥–çš„UPåŠ å…¥ç™½åå•\n                            </label>\n                        </div>\n                        <div data-toggle="anchorBtnArea" style="line-height:25px;">\n                            &nbsp;<button data-action="saveFollowingList" class="igiftMsg_btn">ä¿å­˜å½“å‰å…³æ³¨åˆ—è¡¨ä¸ºç™½åå•</button>\n                            &nbsp;<button data-action="removeAnchorFollowing" class="igiftMsg_btn"\n                                style="color: red;">å–å…³ä¸åœ¨ç™½åå•å†…çš„UPä¸»</button>\n                            &nbsp;<button data-action="editWhiteList" class="igiftMsg_btn">ç¼–è¾‘ç™½åå•</button>\n                        </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">å†…å®¹å±è”½</legend>\n                        <div data-toggle="REMOVE_ELEMENT_2233" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                ç§»é™¤2233æ¨¡å‹\n                            </label>\n                        </div>\n                        <div data-toggle="REMOVE_ELEMENT_activity" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                ç§»é™¤æ´»åŠ¨å…¥å£\n                            </label>\n                        </div>\n                        <div data-toggle="REMOVE_ELEMENT_rank" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                ç§»é™¤æ’è¡Œæ¦œ\n                            </label>\n                        </div>\n                        <div data-toggle="NOSLEEP">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                å±è”½æŒ‚æœºæ£€æµ‹\n                            </label>\n                        </div>\n                        <div data-toggle="INVISIBLE_ENTER">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                éšèº«å…¥åœº\n                            </label>\n                        </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs" style="line-height: 25px">\n                        <legend style="color: black">å¼¹å¹•è®¾ç½®</legend>\n                        <div data-toggle="AUTO_DANMU">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            è‡ªåŠ¨å‘å¼¹å¹•\n                        </div>\n                        <div data-toggle="AUTO_DANMU_SETTINGS">\n                            å¼¹å¹•å†…å®¹\n                            <input class="Danmu igiftMsg_input" style="width: 330px;" type="text"><br>\n                            æˆ¿é—´å·\n                            <input class="Roomid igiftMsg_input" style="width: 330px;" type="text"><br>\n                            å‘é€æ—¶é—´\n                            <input class="Time igiftMsg_input" style="width: 330px;" type="text">\n                        </div>\n                        &nbsp;<button style="font-size: small" class="igiftMsg_btn" data-action="sendDanmuNow">ç«‹åˆ»å‘é€å¼¹å¹•</button>\n                        &nbsp;<button style="font-size: small" class="igiftMsg_btn" data-action="clearDanmuCache">æ¸…é™¤å¼¹å¹•ç¼“å­˜</button>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs" style="line-height: 25px">\n                        <legend style="color: black">å…¶ä»–è®¾ç½®</legend>\n                        <div data-toggle="TIME_AREA_DISABLE">\n                        <label style="margin: 5px auto; color: darkgreen">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            ä¼‘çœ æ—¶æ®µï¼š\n                            <input class="startHour igiftMsg_input" style="width: 20px;" type="text">ç‚¹\n                            <input class="startMinute igiftMsg_input" style="width: 20px;" type="text">åˆ†è‡³\n                            <input class="endHour igiftMsg_input" style="width: 20px;" type="text">ç‚¹\n                            <input class="endMinute igiftMsg_input" style="width: 20px;" type="text">åˆ†\n                        </label>\n                    </div>\n                        <div data-toggle="TIME_RELOAD">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            æ¯\n                            <input class="delay-seconds igiftMsg_input" type="text" style="width: 30px;">\n                            åˆ†é’Ÿåˆ·æ–°ä¸€æ¬¡é¡µé¢\n                        </div>\n                        <div data-toggle="IN_TIME_RELOAD_DISABLE">\n                            <label style="margin: 5px auto">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                ä¸æŠ½å¥–æ—¶æ®µä¸åˆ·æ–°ç›´æ’­é—´\n                            </label>\n                        </div>\n                        <div data-toggle = "debugSwitch">\n                        <label style="margin: 5px auto">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            æ§åˆ¶å°æ—¥å¿—\n                            </label>\n                        </div>\n                        <div data-toggle="GM_NOTICE">\n                            <label style="margin: 5px auto;">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                å®ç‰©/å¤©é€‰ä¸­å¥–åç³»ç»Ÿé€šçŸ¥\n                            </label>\n                        </div>\n                        <div data-toggle="FT_NOTICE">\n                            <label style="margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                å®ç‰©/å¤©é€‰ä¸­å¥–åé€šè¿‡${linkMsg("æ–¹ç³–","https://sc.ftqq.com/")}æ¨é€é€šçŸ¥\n                                &nbsp;<button style="font-size: small" class="igiftMsg_btn"\n                                    data-action="edit_SCKEY">ç¼–è¾‘SCKEY</button>\n                            </label>\n                        </div>\n                        <div data-toggle="btnArea">\n                            &nbsp;<button data-action="reset" style="color: red;" class="igiftMsg_btn">é‡ç½®æ‰€æœ‰ä¸ºé»˜è®¤</button>\n                            &nbsp;<button data-action="redoAllTasks" style="color: red;" class="igiftMsg_btn">å†æ¬¡æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡</button>\n                            &nbsp;<button data-action="mainSiteTasks" class="igiftMsg_btn">å†æ¬¡æ‰§è¡Œä¸»ç«™ä»»åŠ¡</button><br>\n                            &nbsp;<button data-action="exportConfig" class="igiftMsg_btn">å¯¼å‡ºé…ç½®</button>\n                            &nbsp;<button data-action="importConfig" class="igiftMsg_btn">å¯¼å…¥é…ç½®</button>\n                            <input type="file" id="BLTH_config_file" style="display:none">\n                            &nbsp;<button style="font-size: small" class="igiftMsg_btn" data-action="about">å…³äº</button>\n                        </div>\n                    </fieldset>\n                </div>\n            </div>          \n                </div>\n            </div>\n            </div>`;const o=e=>{let t=void 0,i=void 0,n=parseInt(e.find('div[data-toggle="TIME_AREA_DISABLE"] .startHour').val()),o=parseInt(e.find('div[data-toggle="TIME_AREA_DISABLE"] .endHour').val()),a=parseInt(e.find('div[data-toggle="TIME_AREA_DISABLE"] .startMinute').val()),r=parseInt(e.find('div[data-toggle="TIME_AREA_DISABLE"] .endMinute').val());if(n>=24||o>=24||a>=60||r>=60||n<0||o<0||a<0||r<0)return MY_API.chatLog("[å®šæ—¶ä¼‘çœ ]æ—¶é—´é”™è¯¯","warning");if(MY_API.CONFIG.TIME_AREA_START_H0UR=n,MY_API.CONFIG.TIME_AREA_END_H0UR=o,MY_API.CONFIG.TIME_AREA_START_MINUTE=a,MY_API.CONFIG.TIME_AREA_END_MINUTE=r,t=parseFloat(e.find('div[data-toggle="RANDOM_SKIP"] .per').val()),t<0||t>100)return MY_API.chatLog("[éšæœºè·³è¿‡ç¤¼ç‰©]æ•°æ®å°äº0æˆ–å¤§äº100","warning");if(MY_API.CONFIG.RANDOM_SKIP=t,t=parseFloat(e.find('div[data-toggle="RANDOM_SEND_DANMU"] .per').val()),t>5)return MY_API.chatLog("[æ´»è·ƒå¼¹å¹•]ä¸ºç»´æŠ¤ç›´æ’­é—´å¼¹å¹•æ°›å›´,å¼¹å¹•å‘é€æ¦‚ç‡ä¸å¾—å¤§äº5%","warning");if(t<0)return Y_API.chatLog("[æ´»è·ƒå¼¹å¹•]æ•°æ®å°äº0","warning");if(MY_API.CONFIG.RANDOM_SEND_DANMU=t,t=parseInt(e.find('div[data-toggle="TIME_RELOAD"] .delay-seconds').val()),t<=0||t>1e4)return MY_API.chatLog("[ç›´æ’­é—´é‡è½½æ—¶é—´]æ•°æ®å°äºç­‰äº0æˆ–å¤§äº10000","warning");if(MY_API.CONFIG.TIME_RELOAD_MINUTE=t,t=parseFloat(e.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_START').val()),o=parseFloat(e.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_END').val()),t<0||o>100)return MY_API.chatLog("[æŠ½å¥–å»¶æ—¶]æ•°æ®å°äº0æˆ–å¤§äº100","warning");if(o<=t)return MY_API.chatLog("[æŠ½å¥–å»¶æ—¶]æ•°æ®å¤§å°å…³ç³»ä¸æ­£ç¡®","warning");if(MY_API.CONFIG.RND_DELAY_START=t,MY_API.CONFIG.RND_DELAY_END=o,t=parseInt(e.find('div[data-toggle="COIN"] .coin_number').val()),t<0||t>5)return MY_API.chatLog("[è‡ªåŠ¨æŠ•å¸]æ•°æ®å°äº0æˆ–å¤§äº5","warning");if(MY_API.CONFIG.COIN_NUMBER=t,t=parseInt(e.find('div[data-toggle="CHECK_HOUR_ROOM"] .num').val()),t<=0)return MY_API.chatLog("[æ£€æŸ¥å°æ—¶æ¦œé—´éš”]æ•°æ®å°äºç­‰äº0","warning");MY_API.CONFIG.CHECK_HOUR_ROOM_INTERVAL=t,t=e.find('div[data-toggle="AUTO_GIFT_ROOMID"] .num').val(),i=t.split(",");for(let e=0;e<i.length;e++)""===i[e]&&(i[e]=22474988);MY_API.CONFIG.AUTO_GIFT_ROOMID=i,t=e.find('div[data-toggle="EXCLUDE_ROOMID"] .num').val(),i=t.split(",");for(let e=0;e<i.length;e++)""===i[e]&&(i[e]=0);if(MY_API.CONFIG.EXCLUDE_ROOMID=i,t=parseInt(e.find('div[data-toggle="GIFT_LIMIT"] .num').val()),MY_API.CONFIG.GIFT_LIMIT=t,t=parseInt(e.find('div[data-toggle="GIFT_INTERVAL"] .num').val()),MY_API.CONFIG.GIFT_INTERVAL=t,n=parseInt(e.find('div[data-toggle="GIFT_SEND_TIME"] .Hour').val()),o=parseInt(e.find('div[data-toggle="GIFT_SEND_TIME"] .Minute').val()),n<0||o<0||n>=24||o>=60)return MY_API.chatLog("[é€ç¤¼æ—¶é—´]æ—¶é—´é”™è¯¯","warning");MY_API.CONFIG.GIFT_SEND_HOUR=n,MY_API.CONFIG.GIFT_SEND_MINUTE=o,t=e.find('div[data-toggle="SPARE_GIFT_ROOM"] .num').val(),MY_API.CONFIG.SPARE_GIFT_ROOM=t,t=parseInt(e.find('div[data-toggle="STORM_QUEUE_SIZE"] .num').val()),MY_API.CONFIG.STORM_QUEUE_SIZE=t,t=parseInt(e.find('div[data-toggle="STORM_MAX_COUNT"] .num').val()),MY_API.CONFIG.STORM_MAX_COUNT=t,t=parseInt(e.find('div[data-toggle="STORM_ONE_LIMIT"] .num').val()),MY_API.CONFIG.STORM_ONE_LIMIT=t,t=e.find('div[data-toggle="COIN_UID"] .num').val(),i=t.split(",");for(let e=0;e<i.length;e++)""===i[e]&&(i[e]=0);MY_API.CONFIG.COIN_UID=i,t=parseInt(e.find('div[data-toggle="MAX_TAB"] .num').val()),MY_API.CONFIG.MAX_TAB=t,n=e.find('div[data-toggle="AUTO_DANMU_SETTINGS"] .Danmu').val(),i=n.split(",");for(let e=0;e<i.length;e++)""===i[e]&&(i[e]="è¿™æ˜¯ä¸€æ¡å¼¹å¹•");n=i,o=e.find('div[data-toggle="AUTO_DANMU_SETTINGS"] .Roomid').val(),i=o.split(",");for(let e=0;e<i.length;e++)""===i[e]&&(i[e]="22474988");o=i,a=e.find('div[data-toggle="AUTO_DANMU_SETTINGS"] .Time').val(),i=a.split(",");for(let e=0;e<i.length;e++)""===i[e]&&(i[e]="10m");return a=i,MY_API.CONFIG.DANMU_CONTENT=n,MY_API.CONFIG.DANMU_ROOMID=o,MY_API.CONFIG.DANMU_INTERVAL_TIME=a,t=e.find('div[data-toggle="MATERIAL_LOTTERY_CHECK_INTERVAL"] .num').val(),MY_API.CONFIG.MATERIAL_LOTTERY_CHECK_INTERVAL=parseInt(t),t=e.find('div[data-toggle="MATERIAL_LOTTERY_REM"] .num').val(),isNaN(t)&&(t=9),MY_API.CONFIG.MATERIAL_LOTTERY_REM=parseInt(t),t=parseFloat(e.find('div[data-toggle="ANCHOR_CHECK_INTERVAL"] .num').val()),MY_API.CONFIG.ANCHOR_CHECK_INTERVAL=t,t=e.find('div[data-toggle="ANCHOR_MAXROOM"] .roomNum').val(),t<=0?MY_API.chatLog("[æ£€æŸ¥æˆ¿é—´æœ€å¤§æ•°é‡]æ•°æ®å°äºç­‰äº0","warning"):(MY_API.CONFIG.ANCHOR_MAXROOM=t,t=e.find('div[data-toggle="AHCHOR_NEED_GOLD"] .num').val(),MY_API.CONFIG.AHCHOR_NEED_GOLD=parseInt(t),t=e.find('div[data-toggle="ANCHOR_INTERVAL"] .num').val(),t<0?MY_API.chatLog("[è¯·æ±‚é—´éš”]æ•°æ®å°äº0","warning"):(MY_API.CONFIG.ANCHOR_INTERVAL=parseInt(t),t=e.find('div[data-toggle="ANCHOR_LIVEROOM"] .num').val(),MY_API.CONFIG.ANCHOR_GETDATA_ROOM=t,t=parseInt(e.find('[data-toggle="ANCHOR_UPLOAD_DATA"] .num').val()),MY_API.CONFIG.ANCHOR_UPLOAD_DATA_INTERVAL=t,t=e.find('[data-toggle="ANCHOR_MAXLIVEROOM_SAVE"] .roomNum').val(),MY_API.CONFIG.ANCHOR_MAXLIVEROOM_SAVE=t,t=parseFloat(e.find('[data-toggle="ANCHOR_IGNORE_MONEY"] .num').val()),MY_API.CONFIG.ANCHOR_IGNORE_MONEY=t,MY_API.saveConfig()))},a=["AUTO_DANMU","RANDOM_DELAY","TIME_AREA_DISABLE","AUTO_GROUP_SIGN","LOGIN","WATCH","COIN","SHARE","SILVER2COIN","LIVE_SIGN","IN_TIME_RELOAD_DISABLE","TIME_RELOAD","AUTO_GIFT","SEND_ALL_GIFT","STORM","LITTLE_HEART","REMOVE_ELEMENT_2233","REMOVE_ELEMENT_activity","REMOVE_ELEMENT_rank","LOTTERY","CHECK_HOUR_ROOM","MATERIAL_LOTTERY","MATERIAL_LOTTERY_IGNORE_QUESTIONABLE_LOTTERY","ANCHOR_IGNORE_BLACKLIST","ANCHOR_LOTTERY","FT_NOTICE","ANCHOR_WAIT_REPLY","ANCHOR_AUTO_DEL_FOLLOW","ANCHOR_UPLOAD_DATA","ANCHOR_PRIVATE_LETTER","GM_NOTICE","ANCHOR_ADD_TO_WHITELIST","ANCHOR_MOVETO_FOLLOW_TAG","MEDAL_DANMU","ANCHOR_DANMU","ANCHOR_MOVETO_PRIZE_TAG","ANCHOR_IGNORE_PWDROOM"],r=[{name:"COIN_TYPE",toggle1:"COIN_DYN",toggle2:"COIN_UID"},{name:"GIFT_METHOD",toggle1:"GIFT_INTERVAL",toggle2:"GIFT_SEND_TIME"},{name:"GIFT_SORT",toggle1:"GIFT_SORT_HIGH",toggle2:"GIFT_SORT_LOW"},{name:"ANCHOR_TYPE",toggle1:"ANCHOR_POLLING",toggle2:"ANCHOR_LIVEROOM"},{name:"MEDAL_DANMU_METHOD",toggle1:"MEDAL_DANMU_WHITE",toggle2:"MEDAL_DANMU_BLACK"}],l={ANCHOR_IGNORE_MONEY:"è„šæœ¬ä¼šå°è¯•è¯†åˆ«å¤©é€‰æ ‡é¢˜ä¸­æ˜¯å¦æœ‰é‡‘é¢å¹¶å¿½ç•¥é‡‘é¢å°äºè®¾ç½®å€¼çš„å¤©é€‰ã€‚<h3>æ³¨æ„ï¼š</h3><li>æ”¯æŒè¯†åˆ«é˜¿æ‹‰ä¼¯æ•°å­—å’Œæ±‰å­—æ•°å­—ã€‚</li><li>è¯†åˆ«çš„å•ä½æœ‰é™ã€‚</li><li>ä¸æ”¯æŒè¯†åˆ«å¤–å¸ã€‚</li><li>ç”±äºä¸€äº›å¤©é€‰æ—¶åˆ»çš„å¥–å“åæ¯”è¾ƒç‰¹æ®Šï¼Œå¯èƒ½ä¼šå‡ºç°è¯¯åˆ¤ã€‚</li>",LOTTERY:"å‚ä¸å¤§ä¹±æ–—æŠ½å¥–ã€‚",MEDAL_DANMU:"åœ¨æ‹¥æœ‰ç²‰ä¸å‹‹ç« çš„ç›´æ’­é—´å†…ï¼Œæ¯å¤©å‘é€çš„é¦–æ¡å¼¹å¹•å°†ç‚¹äº®å¯¹åº”å‹‹ç« å¹¶ç»™è¯¥å‹‹ç« +100äº²å¯†åº¦ã€‚<h3>æ³¨æ„ï¼š</h3><li>å¦‚æœè¦å¡«å†™å¤šæ¡å¼¹å¹•ï¼Œæ¯æ¡å¼¹å¹•é—´è¯·ç”¨åŠè§’é€—å·<code>,</code>éš”å¼€ï¼Œå‘å¼¹å¹•æ—¶å°†ä»ä¸­éšæœºæŠ½å–å¼¹å¹•è¿›è¡Œå‘é€ã€‚</li><li>æœ¬åŠŸèƒ½è¿è¡Œæ—¶ã€è‡ªåŠ¨å‘å¼¹å¹•ã€‘å’Œã€è‡ªåŠ¨é€ç¤¼ã€‘å°†æš‚åœè¿è¡Œã€‚</li>",AUTO_DANMU:"å‘é€ç›´æ’­é—´å¼¹å¹•ã€‚<h3>æ³¨æ„ï¼š</h3><ul><li>æœ¬åŠŸèƒ½è¿è¡Œæ—¶ã€ç²‰ä¸å‹‹ç« æ‰“å¡å¼¹å¹•ã€‘å°†æš‚åœè¿è¡Œã€‚</li><li><p>å¼¹å¹•å†…å®¹ï¼Œæˆ¿é—´å·ï¼Œå‘é€æ—¶é—´å¯å¡«å¤šä¸ªï¼Œæ•°æ®ä¹‹é—´ç”¨åŠè§’é€—å·<code>,</code>éš”å¼€(æ•°ç»„æ ¼å¼)ã€‚è„šæœ¬ä¼šæŒ‰é¡ºåºå°†è¿™ä¸‰ä¸ªå€¼ä¸€ä¸€å¯¹åº”ï¼Œå‘é€å¼¹å¹•ã€‚</p></li><li><p>ç”±äºBç«™æœåŠ¡å™¨é™åˆ¶ï¼Œæ¯ç§’æœ€å¤šåªèƒ½å‘1æ¡å¼¹å¹•ã€‚è‹¥åœ¨æŸä¸€æ—¶åˆ»æœ‰å¤šæ¡å¼¹å¹•éœ€è¦å‘é€ï¼Œè„šæœ¬ä¼šåœ¨æ¯æ¡å¼¹å¹•é—´åŠ ä¸Š1.1ç§’é—´éš”æ—¶é—´ï¼ˆå¯¹åœ¨ç‰¹å®šæ—¶é—´ç‚¹å‘é€çš„å¼¹å¹•æ— æ•ˆï¼‰ã€‚</p></li><li><p>å¦‚æœæ•°æ®æ²¡å¯¹é½ï¼Œç¼ºå¤±çš„æ•°æ®ä¼šè‡ªåŠ¨å‘å‰å¯¹é½ã€‚å¦‚å¡«å†™<code>å¼¹å¹•å†…å®¹ lalala</code>ï¼Œ<code>æˆ¿é—´å· 3,4</code>ï¼Œ<code>å‘é€æ—¶é—´ 5m,10:30</code>ï¼Œå°‘å¡«ä¸€ä¸ªå¼¹å¹•å†…å®¹ã€‚é‚£ä¹ˆåœ¨å‘é€ç¬¬äºŒæ¡å¼¹å¹•æ—¶ï¼Œç¬¬äºŒæ¡å¼¹å¹•çš„å¼¹å¹•å†…å®¹ä¼šè‡ªåŠ¨å‘å‰å¯¹é½ï¼ˆå³ç¬¬äºŒæ¡å¼¹å¹•çš„å¼¹å¹•å†…å®¹æ˜¯lalalaï¼‰ã€‚</p></li><li><p>å¯ä»¥ç”¨é»˜è®¤å€¼æ‰€å¡«çš„æˆ¿é—´å·æ¥æµ‹è¯•æœ¬åŠŸèƒ½ã€‚</p></li><li><p>å‘é€æ—¶é—´æœ‰ä¸¤ç§å¡«å†™æ–¹æ³•</p><p>1.ã€å°æ—¶ã€‘hã€åˆ†é’Ÿã€‘mã€ç§’ã€‘s</p><ul><li>æ¯éš”ä¸€æ®µæ—¶é—´å‘é€ä¸€æ¡å¼¹å¹•</li><li>ä¾‹å­ï¼š<code>1h2m3s</code>, <code>300m</code>, <code>30s</code>, <code>1h50s</code>, <code>2m6s</code>, <code>0.5h</code></li><li>å¯ä»¥å¡«å°æ•°</li><li>å¯ä»¥åªå¡«å†™å…¶ä¸­ä¸€é¡¹æˆ–ä¸¤é¡¹</li></ul><p>è„šæœ¬ä¼šæ ¹æ®è¾“å…¥æ•°æ®è®¡ç®—å‡ºé—´éš”æ—¶é—´ï¼Œæ¯éš”ä¸€ä¸ªé—´éš”æ—¶é—´å°±ä¼šå‘é€ä¸€æ¡å¼¹å¹•ã€‚å¦‚æœä¸åŠ å•ä½ï¼Œå¦‚å¡«å†™<code>10</code>åˆ™é»˜è®¤å•ä½æ˜¯åˆ†é’Ÿï¼ˆç­‰åŒäº<code>10m</code>ï¼‰ã€‚</p><p><em>æ³¨æ„ï¼šå¿…é¡»æŒ‰é¡ºåºå¡«å°æ—¶ï¼Œåˆ†é’Ÿï¼Œç§’ï¼Œå¦åˆ™ä¼šå‡ºé”™(å¦‚<code>3s5h</code>å°±æ˜¯é”™è¯¯çš„å†™æ³•)</em></p><p>2.ã€å°æ—¶ã€‘:ã€åˆ†é’Ÿã€‘:ã€ç§’ã€‘</p><ul><li>åœ¨ç‰¹å®šæ—¶é—´ç‚¹å‘ä¸€æ¡å¼¹å¹•</li><li>ä¾‹å­ï¼š <code>10:30:10</code>, <code>0:40</code></li><li>åªèƒ½å¡«æ•´æ•°</li><li>å°æ—¶åˆ†é’Ÿå¿…é¡»å¡«å†™ï¼Œç§’æ•°å¯ä»¥ä¸å¡«</li></ul><p>è„šæœ¬ä¼šåœ¨è¯¥æ—¶é—´ç‚¹å‘ä¸€æ¡å¼¹å¹•ï¼ˆå¦‚<code>13:30:10</code>å°±æ˜¯åœ¨ä¸‹åˆ1ç‚¹30åˆ†10ç§’çš„æ—¶å€™å‘å¼¹å¹•ï¼‰ã€‚</p></li></ul>",NOSLEEP:"å±è”½Bç«™çš„æŒ‚æœºæ£€æµ‹ã€‚ä¸å¼€å¯æœ¬åŠŸèƒ½æ—¶ï¼Œæ ‡ç­¾é¡µåå°æˆ–é•¿æ—¶é—´æ— æ“ä½œå°±ä¼šè§¦å‘Bç«™çš„æŒ‚æœºæ£€æµ‹ã€‚<h3>åŸç†ï¼š</h3><li>åŠ«æŒé¡µé¢ä¸Šçš„<code>addEventListener</code>ç»•è¿‡é¡µé¢å¯è§æ€§æ£€æµ‹ï¼Œæ¯5åˆ†é’Ÿè§¦å‘ä¸€æ¬¡é¼ æ ‡ç§»åŠ¨äº‹ä»¶è§„é¿é¼ æ ‡ç§»åŠ¨æ£€æµ‹ã€‚</li>",INVISIBLE_ENTER:"å¼€å¯åè¿›ä»»æ„ç›´æ’­é—´å…¶ä»–äººéƒ½ä¸ä¼šçœ‹åˆ°ä½ è¿›ç›´æ’­é—´çš„æç¤ºã€xxx è¿›å…¥ç›´æ’­é—´ã€‘ï¼ˆåªæœ‰ä½ è‡ªå·±èƒ½çœ‹åˆ°ï¼‰ã€‚<h3>ç¼ºç‚¹ï¼š</h3>å¼€å¯åæ— æ³•è·å–è‡ªå·±æ˜¯å¦æ˜¯å½“å‰ç›´æ’­é—´æˆ¿ç®¡çš„æ•°æ®ï¼Œå…³æ³¨æŒ‰é’®çŠ¶æ€å‡ä¸ºæœªå…³æ³¨ã€‚æ‰€ä»¥å¼€å¯æœ¬åŠŸèƒ½åè¿›ä»»æ„ç›´æ’­é—´éƒ½ä¼šæœ‰ã€ç¦è¨€ã€‘æŒ‰é’®ï¼ˆå¦‚æœä¸æ˜¯æˆ¿ç®¡ç‚¹å‡»åä¼šæç¤ºæ¥å£è¿”å›é”™è¯¯ï¼‰ï¼Œå‘å¼¹å¹•æ—¶å¼¹å¹•æ—è¾¹ä¼šæœ‰æˆ¿ç®¡æ ‡è¯†ï¼ˆå¦‚æœä¸æ˜¯æˆ¿ç®¡åˆ™åªæœ‰ä½ èƒ½çœ‹åˆ°æ­¤æ ‡è¯†ï¼‰ã€‚",MATERIAL_LOTTERY:"å®ç‰©æŠ½å¥–ï¼Œå³é‡‘å®ç®±æŠ½å¥–ã€‚æŸäº›ç‰¹æ®Šçš„ç›´æ’­é—´ä¼šæœ‰é‡‘å®ç®±æŠ½å¥–ã€‚<h3>æ³¨æ„ï¼š</h3><li>ã€å¿½ç•¥å…³é”®å­—ã€‘ä¸­æ¯ä¸€é¡¹ä¹‹é—´ç”¨åŠè§’é€—å·<code>,</code>éš”å¼€ã€‚</li>",MATERIAL_LOTTERY_REM:"aidæ˜¯æ´»åŠ¨çš„ç¼–å·ã€‚å¦‚æœä½ ä¸ç†è§£æ­¤é¡¹ä¿æŒé»˜è®¤é…ç½®å³å¯ã€‚",ANCHOR_IGNORE_BLACKLIST:"å¿½ç•¥å¥–å“åä¸­å«ç‰¹å®šå…³é”®å­—æˆ–åŒ¹é…ç‰¹å®šæ­£åˆ™è¡¨è¾¾å¼çš„å­˜ç–‘å¤©é€‰ã€‚<h3>æ³¨æ„ï¼š</h3><li>è‹¥è¦å¡«å†™å¤šä¸ªï¼Œæ¯ä¸€é¡¹ä¹‹é—´ç”¨åŠè§’é€—å·<code>,</code>éš”å¼€ã€‚</li><li>å¯ä»¥å¡«æ­£åˆ™è¡¨è¾¾å¼ã€‚æ­£åˆ™æ ¼å¼ä¸ºä»¥<code>/</code>å¼€å¤´ä¸”ä»¥<code>/</code>ç»“å°¾ï¼Œå¦‚<code>/æµ‹.*è¯•/</code>ã€‚</li><li>å…³é”®å­—å¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼Œè€Œæ­£åˆ™ä¼šåŒºåˆ†å¤§å°å†™ã€‚</li>",MATERIAL_LOTTERY_IGNORE_QUESTIONABLE_LOTTERY:"å¿½ç•¥å¥–å“åä¸­å«ç‰¹å®šå…³é”®å­—æˆ–åŒ¹é…ç‰¹å®šæ­£åˆ™è¡¨è¾¾å¼çš„å­˜ç–‘æŠ½å¥–ã€‚<h3>æ³¨æ„ï¼š</h3><li>è‹¥è¦å¡«å†™å¤šä¸ªï¼Œæ¯ä¸€é¡¹ä¹‹é—´ç”¨åŠè§’é€—å·<code>,</code>éš”å¼€ã€‚</li><li>å¯ä»¥å¡«æ­£åˆ™è¡¨è¾¾å¼ã€‚æ­£åˆ™æ ¼å¼ä¸ºä»¥<code>/</code>å¼€å¤´ä¸”ä»¥<code>/</code>ç»“å°¾ï¼Œå¦‚<code>/æµ‹.*è¯•/</code>ã€‚</li><li>å…³é”®å­—å¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼Œè€Œæ­£åˆ™ä¼šåŒºåˆ†å¤§å°å†™ã€‚</li>",FT_NOTICE:"<a href = 'https://sc.ftqq.com/' target = '_blank'>æ–¹ç³–ï¼ˆç‚¹æˆ‘æ³¨å†Œï¼‰</a>ï¼Œå³ã€ŒServeré…±ã€ï¼Œè‹±æ–‡åã€ŒServerChanã€ï¼Œæ˜¯ä¸€æ¬¾ã€Œç¨‹åºå‘˜ã€å’Œã€ŒæœåŠ¡å™¨ã€ä¹‹é—´çš„é€šä¿¡è½¯ä»¶ã€‚è¯´äººè¯ï¼Ÿå°±æ˜¯ä»æœåŠ¡å™¨æ¨æŠ¥è­¦å’Œæ—¥å¿—åˆ°æ‰‹æœºçš„å·¥å…·ã€‚<br>ä½¿ç”¨å‰è¯·å…ˆå‰å¾€æ–¹ç³–å®˜ç½‘å®Œæˆæ³¨å†Œï¼Œç„¶åå›åˆ°è„šæœ¬ç•Œé¢å¡«å†™SCKEYã€‚<hr><li>æ£€æµ‹åˆ°å®ç‰©/å¤©é€‰ä¸­å¥–åä¼šå‘ä¸€æ¡åŒ…å«ä¸­å¥–å…·ä½“ä¿¡æ¯çš„å¾®ä¿¡æ¨é€æé†’ä½ ä¸­å¥–äº†ã€‚</li>",BUY_MEDAL:"è°ƒç”¨å®˜æ–¹apiï¼Œæ¶ˆè€—20ç¡¬å¸è´­ä¹°æŸä½UPçš„ç²‰ä¸å‹‹ç« ã€‚<li>é»˜è®¤å€¼ä¸ºå½“å‰æˆ¿é—´å·ã€‚ç‚¹å‡»è´­ä¹°æŒ‰é’®åæœ‰ç¡®è®¤ç•Œé¢ï¼Œæ— éœ€æ‹…å¿ƒè¯¯è§¦ã€‚</li>",btnArea:"<li>é‡ç½®æ‰€æœ‰ä¸ºé»˜è®¤ï¼šæŒ‡å°†è®¾ç½®å’Œä»»åŠ¡æ‰§è¡Œæ—¶é—´ç¼“å­˜é‡ç½®ä¸ºé»˜è®¤ã€‚</li><li>å†æ¬¡æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡ï¼Œå†æ¬¡æ‰§è¡Œä¸»ç«™ä»»åŠ¡ä¼šä½¿ç›¸å…³ç¼“å­˜é‡ç½®ä¸ºé»˜è®¤ï¼Œå¯ä»¥åœ¨å‹¾é€‰äº†æ–°çš„ä»»åŠ¡è®¾ç½®åä½¿ç”¨ã€‚</li><li>å¯¼å‡ºé…ç½®ï¼šå¯¼å‡ºä¸€ä¸ªåŒ…å«å½“å‰è„šæœ¬è®¾ç½®çš„jsonåˆ°æµè§ˆå™¨çš„é»˜è®¤ä¸‹è½½è·¯å¾„ï¼Œæ–‡ä»¶åä¸º<code>BLTH_CONFIG.json</code>ã€‚</li><li>å¯¼å…¥é…ç½®ï¼šä»ä¸€ä¸ªjsonæ–‡ä»¶å¯¼å…¥è„šæœ¬é…ç½®ï¼Œå¯¼å…¥æˆåŠŸåè„šæœ¬ä¼šè‡ªåŠ¨åˆ·æ–°é¡µé¢ä½¿é…ç½®ç”Ÿæ•ˆã€‚</li>",LITTLE_HEART:"é€šè¿‡å‘é€å®¢æˆ·ç«¯å¿ƒè·³åŒ…è·å–å°å¿ƒå¿ƒï¼ˆæ— è®ºç›®æ ‡æˆ¿é—´æ˜¯å¦å¼€æ’­éƒ½èƒ½è·å–ï¼‰ã€‚<li>æ£€æµ‹åˆ°åŒ…è£¹å†…æœ‰24ä¸ª7å¤©çš„å°å¿ƒå¿ƒåä¼šåœæ­¢ã€‚</li><li>åœ¨è·å–å®Œæ‰€æœ‰å°å¿ƒå¿ƒä¹‹å‰ç›´æ’­é—´ä¸åˆ·æ–°ã€‚</li><li>Bç«™éšæ—¶å¯ä»¥é€šè¿‡çƒ­æ›´æ–°ä½¿è¯¥åŠŸèƒ½å¤±æ•ˆã€‚</li>",STORM:"ä»…ä¼šå‚åŠ è¢«å¹¿æ’­çš„èŠ‚å¥é£æš´ã€‚è‹¥æ— æ³•å‚åŠ è¯·å°è¯•å®ååå†å‚åŠ ã€‚",SEND_ALL_GIFT:"è‹¥ä¸å‹¾é€‰è¯¥é¡¹ï¼Œè‡ªåŠ¨é€ç¤¼åªä¼šé€å‡ºåˆ°æœŸæ—¶é—´å†…çš„è¾£æ¡ï¼Œäº¿åœ†å’Œå°å¿ƒå¿ƒã€‚",AUTO_GIFT_ROOMID:"é€ç¤¼æ—¶ä¼˜å…ˆç»™è¿™äº›æˆ¿é—´é€ç¤¼ï¼Œé€åˆ°å¯¹åº”ç²‰ä¸ç‰Œäº²å¯†åº¦ä¸Šé™åå†é€å…¶å®ƒçš„ã€‚<li>å¦‚æœè¦å¡«å†™å¤šä¸ªæˆ¿é—´ï¼Œæ¯ä¸ªæˆ¿é—´å·ä¹‹é—´éœ€ç”¨åŠè§’é€—å·<code>,</code>éš”å¼€ã€‚å¦‚<code>666,777,888</code>ã€‚</li>",EXCLUDE_ROOMID:"ä¸ç»™è¿™äº›æˆ¿é—´é€ç¤¼ã€‚<li>å¦‚æœè¦å¡«å†™å¤šä¸ªæˆ¿é—´ï¼Œæ¯ä¸ªæˆ¿é—´å·ä¹‹é—´éœ€ç”¨åŠè§’é€—å·<code>,</code>éš”å¼€ã€‚å¦‚<code>666,777,888</code>ã€‚</li>",GIFT_LIMIT:"å°†è¦åœ¨è¿™ä¸ªæ—¶é—´æ®µé‡Œè¿‡æœŸçš„ç¤¼ç‰©ä¼šè¢«é€å‡ºã€‚<h3>æ³¨æ„ï¼š</h3><li>å‹¾é€‰ã€æ— è§†ç¤¼ç‰©ç±»å‹å’Œåˆ°æœŸæ—¶é—´é™åˆ¶ã€‘æ—¶æ— è®ºç¤¼ç‰©æ˜¯å¦å°†è¦è¿‡æœŸéƒ½ä¼šè¢«é€å‡ºã€‚</li>",AUTO_GIFT:"è‡ªåŠ¨ç»™æœ‰ç²‰ä¸å‹‹ç« çš„ç›´æ’­é—´é€å‡ºåŒ…è£¹å†…çš„ç¤¼ç‰©ã€‚<h3>è¯´æ˜ï¼š</h3><li>é€ç¤¼è®¾ç½®ä¼˜å…ˆçº§ï¼š<br>ä¸é€ç¤¼æˆ¿é—´ > ä¼˜å…ˆé€ç¤¼æˆ¿é—´ > ä¼˜å…ˆé«˜/ä½ç­‰çº§ç²‰ä¸ç‰Œã€‚</li><li>é€ç¤¼è®¾ç½®é€»è¾‘è§„åˆ™ï¼š<br>æ— è®ºã€ä¼˜å…ˆé«˜/ä½ç­‰çº§ç²‰ä¸ç‰Œã€‘å¦‚ä½•è®¾ç½®ï¼Œä¼šæ ¹æ®ã€æ— è§†ç¤¼ç‰©ç±»å‹å’Œåˆ°æœŸæ—¶é—´é™åˆ¶ã€‘ï¼ˆå‹¾é€‰åˆ™æ— è§†æ˜¯å¦åˆ°æœŸè¡¥æ»¡äº²å¯†åº¦ï¼Œå¦åˆ™åªé€åˆ°æœŸçš„ï¼‰æ¡ä»¶å»æŒ‰ä¼˜å…ˆé€ç¤¼æˆ¿é—´å…ˆåé¡ºåºé€ç¤¼ã€‚ä¹‹åæ ¹æ®ã€ä¼˜å…ˆé«˜/ä½ç­‰çº§ç²‰ä¸ç‰Œã€‘å†³å®šå…ˆé€é«˜çº§è¿˜æ˜¯ä½çº§ã€‚</li>",SPARE_GIFT_ROOM:"ã€å‰©ä½™ç¤¼ç‰©ã€‘æŒ‡é€æ»¡äº†æ‰€æœ‰ç²‰ä¸ç‰Œï¼Œä½†ä»æœ‰å‰©ä½™çš„å°†åœ¨1å¤©å†…è¿‡æœŸçš„ç¤¼ç‰©ã€‚<li>è¯¥é¡¹å¡«<code>0</code>åˆ™ä¸é€å‰©ä½™ç¤¼ç‰©ã€‚</li>",COIN:"è‡ªåŠ¨ç»™è§†é¢‘æŠ•å¸ï¼Œæ¯å¤©æœ€å¤šæŠ•5ä¸ªã€‚<li>è„šæœ¬ä¼šæ ¹æ®ä»Šæ—¥ä½ å·²è·å¾—çš„æŠ•å¸ç»éªŒå€¼åˆ¤æ–­ä½ å·²ç»æŠ•äº†å¤šå°‘ä¸ªå¸ï¼Œç„¶åè‡ªåŠ¨æŠ•å‰©ä½™æ²¡æŠ•çš„å¸ã€‚<blockquote>å¦‚ä»Šæ—¥å·²è·å¾—æŠ•å¸ç»éªŒ20ï¼Œè„šæœ¬æŠ•å¸æ•°é‡è®¾ç½®ä¸º4ï¼Œåˆ™ä¼šæŠ•2ä¸ªå¸ã€‚</blockquote></li>",COIN_UID:"è¯¥é¡¹è‹¥å¡«<code>0</code>åˆ™ç»™åŠ¨æ€ä¸­çš„è§†é¢‘ä¾æ¬¡æŠ•å¸(ä¸å­˜åœ¨UIDä¸º0çš„ç”¨æˆ·)ã€‚<li>å¯ä»¥å¡«å†™å¤šä¸ªuidï¼Œæ¯ä¸¤ä¸ªuidé—´ç”¨åŠè§’é€—å·<code>,</code>éš”å¼€ã€‚</li><li>å¦‚æœå¡«äº†å¤šä¸ªuidï¼Œåˆ™ä¼šä¾æ¬¡æ£€æŸ¥è¿™äº›UPæ˜¯å¦æœ‰å¯æŠ•å¸çš„è§†é¢‘ã€‚</li>",ANCHOR_INTERVAL:"è½®è¯¢å¤©é€‰ï¼Œå–å…³ï¼Œè·å–æˆ¿é—´åˆ—è¡¨æ—¶æ¯ä¸¤ä¸ªè¯·æ±‚é—´çš„é—´éš”æ—¶é—´ã€‚<h3>æ³¨æ„ï¼š</h3><li>å¦‚æœé—´éš”æ—¶é—´è¿‡çŸ­å¯èƒ½ä¼šè¢«é£æ§ã€‚</li>",ANCHOR_WAIT_REPLY:"å‘èµ·æ£€æŸ¥ç›´æ’­é—´å¤©é€‰ä¿¡æ¯ï¼Œå–å…³çš„è¯·æ±‚åä¼šç­‰å¾…å›å¤ï¼Œæ”¶åˆ°å›å¤åç­‰å¾…ä¸€ä¸ªé—´éš”æ—¶é—´å†å‘èµ·ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚<h3>ä»»åŠ¡æµç¨‹ï¼š</h3><li>å‘èµ·è¯·æ±‚ - ç­‰å¾…å›å¤ - ç­‰å¾…ä¸€ä¸ªé—´éš”æ—¶é—´ - å‘èµ·ä¸‹ä¸€ä¸ªè¯·æ±‚</li>",ANCHOR_AUTO_DEL_FOLLOW:"å¦‚æœè¯¥UPåœ¨ç™½åå•å†…æˆ–ä¸€å¼€å§‹å°±åœ¨é»˜è®¤åˆ†ç»„åˆ™ä¸ä¼šè¢«å–å…³ã€‚",anchorBtnArea:"å‚åŠ å¤©é€‰æ—¶ä¼šå…³æ³¨å¾ˆå¤šUPã€‚å¯ä»¥åœ¨å‚åŠ å¤©é€‰å‰ç‚¹å‡»ã€ä¿å­˜å½“å‰å…³æ³¨åˆ—è¡¨ä¸ºç™½åå•ã€‘ï¼Œå‚ä¸å®Œå¤©é€‰åå†ç‚¹ã€å–å…³ä¸åœ¨ç™½åå•å†…çš„UPä¸»ã€‘æ¥æ¸…ç†å…³æ³¨åˆ—è¡¨ã€‚<li>ä¸å»ºè®®é¢‘ç¹æ¸…ç†ï¼Œå¯èƒ½ä¼šè¢«é£æ§ã€‚</li><li>ã€ç¼–è¾‘ç™½åå•ã€‘æ¯ä¸¤ä¸ªuidä¹‹é—´ç”¨åŠè§’é€—å·<code>,</code>éš”å¼€ã€‚</li><li>æ¨èå¤§å®¶ä½¿ç”¨ã€å–å…³åˆ†ç»„å†…çš„UPä¸»ã€‘çš„åŠŸèƒ½æ¥æ¸…ç†å…³æ³¨åˆ—è¡¨ï¼Œã€å–å…³ä¸åœ¨ç™½åå•å†…çš„UPä¸»ã€‘å¯ä»¥ä½œä¸ºä¸€ä¸ªå¤‡é€‰æ–¹æ¡ˆã€‚</li>",ANCHOR_POLLING:"è½®è¯¢çš„æˆ¿é—´æ¥æºäºå„åˆ†åŒºå°æ—¶æ¦œå’Œçƒ­é—¨æˆ¿é—´åˆ—è¡¨ã€‚è·å–åˆ°æˆ¿é—´åˆ—è¡¨åè„šæœ¬ä¼šç¼“å­˜èµ·æ¥ä»¥ä¾›åç»­ä½¿ç”¨ã€‚",ANCHOR_UPLOAD_DATA:"ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½å‰ä½ å¿…é¡»å…ˆæ‹¥æœ‰è‡ªå·±çš„ç›´æ’­é—´ã€‚  <li>ä¸Šä¼ æ•°æ®æ ¼å¼ï¼šç»<a href = 'https://baike.baidu.com/item/base64/8545775' target = '_blank'>Base64</a>ç¼–ç çš„JSONå­—ç¬¦ä¸²ï¼Œç¼–ç åæ¯ä¸¤ä¸ªå­—ç¬¦é—´æ’å…¥ä¸€ä¸ª<code>-</code>ã€‚JSONæ ¼å¼ï¼š<code>{ roomList: [ç›´æ’­é—´1, ç›´æ’­é—´2, ...], ts: æ—¶é—´æˆ³ }</code>ã€‚</li><li>ã€é—´éš”__ç§’ã€‘ï¼šè¿™ä¸ªè®¾ç½®é¡¹è‹¥å¡«<code>10</code>ç§’ï¼Œåˆ™æ¯<code>10</code>ç§’æ£€æŸ¥ä¸€æ¬¡æ˜¯å¦æ”¶é›†åˆ°äº†æ–°çš„æ•°æ®ï¼Œè‹¥æœ‰æ‰ä¸Šä¼ ã€‚</li>",ANCHOR_MAXLIVEROOM_SAVE:"ä¸ªäººç®€ä»‹æœ‰é•¿åº¦é™åˆ¶ï¼ˆçº¦ä¸ºä¸€ä¸‡ä¸ªå­—ç¬¦ï¼‰ï¼Œè‹¥ã€ä¸ªäººç®€ä»‹å‚¨å­˜æˆ¿é—´æœ€å¤§æ•°é‡ã€‘å¤ªå¤§ä¼šæ— æ³•ä¸Šä¼ ã€‚",ANCHOR_MAXROOM:"è‹¥æ”¶é›†çš„æˆ¿é—´æ€»æ•°è¶…è¿‡ã€æ£€æŸ¥æˆ¿é—´æœ€å¤§æ•°é‡ã€‘åˆ™ä¼šåˆ é™¤ä¸€éƒ¨åˆ†æœ€å¼€å§‹ç¼“å­˜çš„æˆ¿é—´ã€‚<h3>æ³¨æ„ï¼š</h3><li>è¿™ä¸€é¡¹å¹¶ä¸æ˜¯æ•°å€¼è¶Šå¤§æ•ˆç‡å°±è¶Šé«˜ã€‚å¦‚æœæŠŠè¿™ä¸ªå€¼è®¾ç½®å¾—è¿‡é«˜ä¼šæµªè´¹å¾ˆå¤šæ—¶é—´å»æ£€æŸ¥çƒ­åº¦è¾ƒä½çš„ï¼Œç”šè‡³å·²ç»ä¸‹æ’­çš„æˆ¿é—´ã€‚ã€ä¸ªäººç®€ä»‹å‚¨å­˜æˆ¿é—´æœ€å¤§æ•°é‡ã€‘åŒç†ã€‚</li>",ANCHOR_LIVEROOM:"å› ä¸ºåœ¨äº‘ä¸Šéƒ¨ç½²äº†è„šæœ¬ï¼Œ<strong>é»˜è®¤å€¼æ‰€å¡«ç›´æ’­é—´(<a href = 'https://live.bilibili.com/22474988' target = '_blank'>22474988</a>)çš„ä¸ªäººç®€ä»‹å¯ä»¥æŒç»­æä¾›å¤©é€‰æ•°æ®</strong>ï¼ˆé™¤éè¢«é£æ§æˆ–é‡åˆ°ä¸€äº›çªå‘æƒ…å†µï¼‰ã€‚<li>è¿™ä¸ªåŠŸèƒ½ä¸»è¦æ˜¯ä¸ºäº†å‡å°‘è¯·æ±‚æ•°é‡ï¼Œæé«˜æ•ˆç‡åŒæ—¶å‡å°‘é£æ§çš„æ¦‚ç‡ã€‚</li><li>ä½¿ç”¨æœ¬åŠŸèƒ½æ—¶å»ºè®®æŠŠã€å¤©é€‰è·å–æ•°æ®é—´éš”ã€‘è°ƒä½ä¸€äº›å‡å°‘é—æ¼çš„å¤©é€‰æ•°é‡ã€‚</li><li><a href='https://jq.qq.com/?_wv=1027&amp;k=fCSfWf1O' target = '_blank'>qç¾¤ï¼ˆ1106094437ï¼‰</a>çš„ç¾¤åœ¨çº¿æ–‡æ¡£ä¸­æœ‰ä¸€äº›ç¾¤å‹ä¸Šä¼ çš„èƒ½æä¾›å¤©é€‰æ•°æ®çš„ç›´æ’­é—´å·ã€‚</li>",ANCHOR_PRIVATE_LETTER:"è‹¥ä¸­å¥–ï¼Œä¼šåœ¨å¼€å¥–å10ç§’å‘é€ç§ä¿¡ã€‚<li>å»ºè®®æ”¹ä¸€ä¸‹ç§ä¿¡å†…å®¹ï¼Œä¸è¦å’Œé»˜è®¤å€¼å®Œå…¨ä¸€æ ·ã€‚</li>",ANCHOR_MOVETO_FOLLOW_TAG:`åˆ†ç»„çš„åç§°ä¸º<code>${anchorFollowTagName}</code>ã€‚<li><strong>è¯·å‹¿ä¿®æ”¹è¯¥åˆ†ç»„åç§°ã€‚</strong></li>`,RANDOM_DELAY:"æŠ½å¥–å‰é¢å¤–ç­‰å¾…ä¸€æ®µæ—¶é—´ã€‚<li>å¯ä»¥å¡«å°æ•°ã€‚</li>",RANDOM_SKIP:"éšæœºå¿½ç•¥ä¸€éƒ¨åˆ†æŠ½å¥–ã€‚<li>å¯ä»¥å¡«å°æ•°ã€‚</li>",ANCHOR_CHECK_INTERVAL:"æ£€æŸ¥å®Œä¸€è½®å¤©é€‰åç­‰å¾…çš„æ—¶é—´ã€‚<li>å¯ä»¥å¡«å°æ•°ã€‚</li>",TIME_AREA_DISABLE:"å¤„äºè¿™ä¸ªæ—¶æ®µå†…æ—¶ï¼Œè„šæœ¬ä¼šæš‚åœæ£€æŸ¥å°æ—¶æ¦œå’Œå¤©é€‰æ—¶åˆ»ã€‚<br><li>24å°æ—¶åˆ¶ï¼Œåªèƒ½å¡«æ•´æ•°ã€‚</li>",MEDAL_DANMU_METHOD:"å‘é€ç²‰ä¸å‹‹ç« æ‰“å¡å¼¹å¹•çš„é€»è¾‘ï¼Œæœ‰ç™½åå•å’Œé»‘åå•ä¸¤ç§ã€‚åæ–‡ä¸­çš„<code>ç›´æ’­é—´</code>æŒ‡æ‹¥æœ‰ç²‰ä¸å‹‹ç« çš„ç›´æ’­é—´ã€‚<li>ç™½åå•ï¼šä»…ç»™æˆ¿é—´åˆ—è¡¨å†…çš„ç›´æ’­é—´å‘å¼¹å¹•ã€‚</li><li>é»‘åå•ï¼šç»™æˆ¿é—´åˆ—è¡¨ä»¥å¤–çš„ç›´æ’­é—´å‘å¼¹å¹•ã€‚</li><li>è‹¥è¦å¡«å†™å¤šä¸ªç›´æ’­é—´ï¼Œæ¯ä¸¤ä¸ªç›´æ’­é—´å·ä¹‹é—´ç”¨åŠè§’é€—å·<code>éš”å¼€</code>ã€‚</li>",ANCHOR_DANMU:"æ£€æµ‹åˆ°ä¸­å¥–ååœ¨å‘èµ·æŠ½å¥–çš„ç›´æ’­é—´å‘ä¸€æ¡å¼¹å¹•ã€‚<h3>æ³¨æ„ï¼š</h3><li>å¦‚æœè¦å¡«å†™å¤šæ¡å¼¹å¹•ï¼Œæ¯æ¡å¼¹å¹•é—´è¯·ç”¨åŠè§’é€—å·<code>,</code>éš”å¼€ï¼Œå‘å¼¹å¹•æ—¶å°†ä»ä¸­éšæœºæŠ½å–å¼¹å¹•è¿›è¡Œå‘é€ã€‚</li>",topArea:"è¿™é‡Œä¼šæ˜¾ç¤ºä¸€äº›ç»Ÿè®¡ä¿¡æ¯ã€‚ç‚¹å‡»ã€ä¿å­˜æ‰€æœ‰è®¾ç½®ã€‘æŒ‰é’®å³å¯ä¿å­˜å½“å‰è®¾ç½®ã€‚<li>ç»Ÿè®¡ä¿¡æ¯å®æ—¶æ›´æ–°ï¼Œæ¯å¤©0ç‚¹æ—¶é‡ç½®ã€‚</li><li>æ”¯æŒè¾“å…¥æ¡†å›è½¦ä¿å­˜ã€‚</li><li>å•é€‰æ¡†å’Œå¤šé€‰æ¡†è®¾ç½®å‘ç”Ÿå˜åŒ–æ—¶ä¼šè‡ªåŠ¨ä¿å­˜è®¾ç½®ã€‚</li>",ANCHOR_MOVETO_PRIZE_TAG:`åˆ†ç»„çš„åç§°ä¸º<code>${anchorPrizeTagName}</code>ã€‚<li><strong>è¯·å‹¿ä¿®æ”¹è¯¥åˆ†ç»„åç§°ã€‚</strong></li>`,debugSwitch:"å¼€å¯æˆ–å…³é—­æ§åˆ¶æ—¥å¿—ã€‚<li>å¹³æ—¶å»ºè®®å…³é—­ï¼Œå‡å°‘èµ„æºå ç”¨ã€‚</li><li>è¯¥è®¾ç½®åªä¼šå½±å“æ™®é€šæ—¥å¿—(<code>console.log</code>)ï¼Œä¸ä¼šå½±å“æŠ¥é”™(<code>console.error</code>)ã€‚</li>"},s=async()=>{const e=$(".live-player-mounter").offset(),t=$(".live-player-mounter").height();mainIndex=await layer.open({type:1,title:!1,offset:[String(e.top-getScrollPosition().y)+"px",String(e.left-getScrollPosition().x)+"px"],closeBtn:0,shade:0,zIndex:1e7,fixed:!1,area:[,String(t)+"px"],resize:!1,content:n,success:()=>{const e=$("#allsettings");$("#allsettings *").each((function(e,t){let i=$(t);const n=i.attr("data-toggle");void 0!==n&&l.hasOwnProperty(n)&&i.append(`<span id = '${n}_help' class = "clickableText">?</span>`)})),$("#giftCount span:eq(0)").text(MY_API.GIFT_COUNT.ANCHOR_COUNT),$("#giftCount span:eq(1)").text(MY_API.GIFT_COUNT.MATERIAL_COUNT),e.find('div[data-toggle="MATERIAL_LOTTERY_IGNORE_QUESTIONABLE_LOTTERY"] label:eq(0) label:eq(0)').text(String(MY_API.CONFIG.QUESTIONABLE_LOTTERY.length)+"ä¸ª"),e.find('div[data-toggle="ANCHOR_IGNORE_BLACKLIST"] label:eq(0) label:eq(0)').text(String(MY_API.CONFIG.ANCHOR_BLACKLIST_WORD.length)+"ä¸ª"),e.find('div[data-toggle="ANCHOR_IGNORE_MONEY"] .num').val(parseFloat(MY_API.CONFIG.ANCHOR_IGNORE_MONEY).toString()),e.find('div[data-toggle="ANCHOR_MAXLIVEROOM_SAVE"] .roomNum').val(parseInt(MY_API.CONFIG.ANCHOR_MAXLIVEROOM_SAVE).toString()),e.find('div[data-toggle="ANCHOR_UPLOAD_DATA"] .num').val(MY_API.CONFIG.ANCHOR_UPLOAD_DATA_INTERVAL.toString()),e.find('div[data-toggle="ANCHOR_LIVEROOM"] .num').val(MY_API.CONFIG.ANCHOR_GETDATA_ROOM.toString()),e.find('div[data-toggle="ANCHOR_INTERVAL"] .num').val(parseInt(MY_API.CONFIG.ANCHOR_INTERVAL).toString()),e.find('div[data-toggle="AHCHOR_NEED_GOLD"] .num').val(parseInt(MY_API.CONFIG.AHCHOR_NEED_GOLD).toString()),e.find('div[data-toggle="ANCHOR_MAXROOM"] .roomNum').val(parseInt(MY_API.CONFIG.ANCHOR_MAXROOM).toString()),e.find('div[data-toggle="ANCHOR_CHECK_INTERVAL"] .num').val(parseFloat(MY_API.CONFIG.ANCHOR_CHECK_INTERVAL).toString()),e.find('div[data-toggle="MATERIAL_LOTTERY_REM"] .num').val(parseInt(MY_API.CONFIG.MATERIAL_LOTTERY_REM).toString()),e.find('div[data-toggle="MATERIAL_LOTTERY_CHECK_INTERVAL"] .num').val(parseInt(MY_API.CONFIG.MATERIAL_LOTTERY_CHECK_INTERVAL).toString()),e.find('div[data-toggle="AUTO_DANMU_SETTINGS"] .Time').val(MY_API.CONFIG.DANMU_INTERVAL_TIME.toString()),e.find('div[data-toggle="AUTO_DANMU_SETTINGS"] .Roomid').val(MY_API.CONFIG.DANMU_ROOMID.toString()),e.find('div[data-toggle="AUTO_DANMU_SETTINGS"] .Danmu').val(MY_API.CONFIG.DANMU_CONTENT.toString()),e.find('div[data-toggle="MAX_TAB"] .num').val(parseInt(MY_API.CONFIG.MAX_TAB).toString()),e.find('div[data-toggle="GIFT_INTERVAL"] .num').val(parseInt(MY_API.CONFIG.GIFT_INTERVAL).toString()),e.find('div[data-toggle="STORM_MAX_COUNT"] .num').val(parseInt(MY_API.CONFIG.STORM_MAX_COUNT).toString()),e.find('div[data-toggle="STORM_ONE_LIMIT"] .num').val(parseInt(MY_API.CONFIG.STORM_ONE_LIMIT).toString()),e.find('div[data-toggle="STORM_QUEUE_SIZE"] .num').val(parseInt(MY_API.CONFIG.STORM_QUEUE_SIZE).toString()),e.find('div[data-toggle="SPARE_GIFT_ROOM"] .num').val(MY_API.CONFIG.SPARE_GIFT_ROOM.toString()),e.find('div[data-toggle="TIME_RELOAD"] .delay-seconds').val(parseInt(MY_API.CONFIG.TIME_RELOAD_MINUTE).toString()),e.find('div[data-toggle="RANDOM_SKIP"] .per').val(parseFloat(MY_API.CONFIG.RANDOM_SKIP).toString()),e.find('div[data-toggle="RANDOM_SEND_DANMU"] .per').val(parseFloat(MY_API.CONFIG.RANDOM_SEND_DANMU).toString()),e.find('div[data-toggle="COIN"] .coin_number').val(parseInt(MY_API.CONFIG.COIN_NUMBER).toString()),e.find('div[data-toggle="COIN_UID"] .num').val(MY_API.CONFIG.COIN_UID.toString()),e.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_START').val(parseFloat(MY_API.CONFIG.RND_DELAY_START).toString()),e.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_END').val(parseFloat(MY_API.CONFIG.RND_DELAY_END).toString()),e.find('div[data-toggle="TIME_AREA_DISABLE"] .startHour').val(parseInt(MY_API.CONFIG.TIME_AREA_START_H0UR).toString()),e.find('div[data-toggle="TIME_AREA_DISABLE"] .endHour').val(parseInt(MY_API.CONFIG.TIME_AREA_END_H0UR).toString()),e.find('div[data-toggle="TIME_AREA_DISABLE"] .startMinute').val(parseInt(MY_API.CONFIG.TIME_AREA_START_MINUTE).toString()),e.find('div[data-toggle="TIME_AREA_DISABLE"] .endMinute').val(parseInt(MY_API.CONFIG.TIME_AREA_END_MINUTE).toString()),e.find('div[data-toggle="CHECK_HOUR_ROOM"] .num').val(parseInt(MY_API.CONFIG.CHECK_HOUR_ROOM_INTERVAL).toString()),e.find('div[data-toggle="AUTO_GIFT_ROOMID"] .num').val(MY_API.CONFIG.AUTO_GIFT_ROOMID.toString()),e.find('div[data-toggle="EXCLUDE_ROOMID"] .num').val(MY_API.CONFIG.EXCLUDE_ROOMID.toString()),e.find('div[data-toggle="GIFT_SEND_TIME"] .Hour').val(MY_API.CONFIG.GIFT_SEND_HOUR.toString()),e.find('div[data-toggle="GIFT_SEND_TIME"] .Minute').val(MY_API.CONFIG.GIFT_SEND_MINUTE.toString()),e.find('div[data-toggle="GIFT_LIMIT"] .num').val(parseInt(MY_API.CONFIG.GIFT_LIMIT).toString());let t=document.getElementById("BLTH_config_file");t.addEventListener("change",importConfig,!1),e.find('button[data-action="save"]').click(()=>{o(e)}),e.find('button[data-action="exportConfig"]').click(()=>{exportConfig(MY_API.CONFIG,nosleepConfig,INVISIBLE_ENTER_config),layer.msg("é…ç½®å·²å¯¼å‡º",{time:2500})}),e.find('button[data-action="importConfig"]').click(()=>{readConfigArray[1]=$.Deferred(),t.click(),readConfigArray[1].then(()=>{let e=readConfigArray[0];MYDEBUG("readConfigArray æ–‡ä»¶è¯»å–ç»“æœï¼š",readConfigArray[0]),$.extend(!0,MY_API.CONFIG,e.MY_API.CONFIG),MY_API.saveConfig(!1),localStorage.setItem(NAME+"_NOSLEEP",e.nosleepConfig),localStorage.setItem(NAME+"_INVISIBLE_ENTER",e.INVISIBLE_ENTER_config),layer.msg("é…ç½®å¯¼å…¥æˆåŠŸï¼Œ3ç§’åå°†è‡ªåŠ¨åˆ·æ–°é¡µé¢",{time:3e3,icon:1}),setTimeout(()=>{window.location.reload()},3e3)})}),e.find('div[data-toggle="BUY_MEDAL"] [data-action="buy_medal"]').click((function(){const t=parseInt(e.find('div[data-toggle="BUY_MEDAL"] .num').val());MY_API.buyFanMedal(t)})),e.find('button[data-action="reset"]').click(()=>{MY_API.setDefaults()}),e.find('button[data-action="checkUpdate"]').click(()=>{MY_API.checkUpdate()}),e.find('button[data-action="redoAllTasks"]').click(()=>{MY_API.ReDoAllTasks()}),e.find('button[data-action="about"]').click(()=>{layer.open({title:"ç‰ˆæœ¬"+GM_info.script.version,content:`<h3 style="text-align:center">Bç«™ç›´æ’­é—´æŒ‚æœºåŠ©æ‰‹</h3>ä½œè€…ï¼š${linkMsg("andywang425","https://github.com/andywang425/")}<br>è®¸å¯è¯ï¼š${linkMsg("MIT","https://raw.githubusercontent.com/andywang425/BLTH/master/LICENSE")}<br>githubé¡¹ç›®åœ°å€ï¼š${linkMsg("BLTH","https://github.com/andywang425/BLTH")}<br>åé¦ˆï¼š${linkMsg("BLTH/issues","https://github.com/andywang425/BLTH/issues")}<br>äº¤æµqqç¾¤ï¼š${linkMsg("1106094437","https://jq.qq.com/?_wv=1027&amp;k=fCSfWf1O")}<br>`})}),e.find('button[data-action="edit_lightMedalList"]').click(()=>{layer.prompt({formType:2,value:String(MY_API.CONFIG.MEDAL_DANMU_ROOM),title:"è¯·è¾“å…¥ç²‰ä¸å‹‹ç« æ‰“å¡å¼¹å¹•æˆ¿é—´åˆ—è¡¨",btn:["ä¿å­˜","å–æ¶ˆ"]},(function(e,t){let i=e.split(",");for(let e=0;e<i.length;e++)""===i[e]&&(i[e]="0");MY_API.CONFIG.MEDAL_DANMU_ROOM=i,MY_API.saveConfig(!1),layer.msg("ç²‰ä¸å‹‹ç« æ‰“å¡å¼¹å¹•æˆ¿é—´åˆ—è¡¨ä¿å­˜æˆåŠŸ",{time:2500,icon:1}),layer.close(t)}))}),e.find('button[data-action="edit_ANCHOR_DANMU_CONTENT"]').click(()=>{layer.prompt({formType:2,value:String(MY_API.CONFIG.ANCHOR_DANMU_CONTENT),title:"è¯·è¾“å…¥å¤©é€‰æ—¶åˆ»ä¸­å¥–åå¼¹å¹•",btn:["ä¿å­˜","å–æ¶ˆ"]},(function(e,t){let i=e.split(",");for(let e=0;e<i.length;e++)""===i[e]&&(i[e]="æˆ‘ä¸­å•¦ï¼");MY_API.CONFIG.ANCHOR_DANMU_CONTENT=i,MY_API.saveConfig(!1),layer.msg("å¤©é€‰æ—¶åˆ»ä¸­å¥–åå¼¹å¹•ä¿å­˜æˆåŠŸ",{time:2500,icon:1}),layer.close(t)}))}),e.find('button[data-action="edit_medalDanmu"]').click(()=>{layer.prompt({formType:2,value:String(MY_API.CONFIG.MEDAL_DANMU_CONTENT),title:"è¯·è¾“å…¥ç²‰ä¸å‹‹ç« æ‰“å¡å¼¹å¹•",btn:["ä¿å­˜","å–æ¶ˆ"]},(function(e,t){let i=e.split(",");for(let e=0;e<i.length;e++)""===i[e]&&(i[e]="(ï½€ãƒ»Ï‰ãƒ»Â´)");MY_API.CONFIG.MEDAL_DANMU_CONTENT=i,MY_API.saveConfig(!1),layer.msg("ç²‰ä¸å‹‹ç« æ‰“å¡å¼¹å¹•ä¿å­˜æˆåŠŸ",{time:2500,icon:1}),layer.close(t)}))}),e.find('button[data-action="edit_QUESTIONABLE_LOTTERY"]').click(()=>{layer.prompt({formType:2,value:String(MY_API.CONFIG.QUESTIONABLE_LOTTERY),title:"è¯·è¾“å…¥å®ç‰©æŠ½å¥–å¿½ç•¥å…³é”®å­—",btn:["ä¿å­˜","å–æ¶ˆ"]},(function(t,i){let n=t.split(",");for(let e=0;e<n.length;e++)""===n[e]&&(n[e]="test");MY_API.CONFIG.QUESTIONABLE_LOTTERY=n,MY_API.saveConfig(!1),layer.msg("å®ç‰©æŠ½å¥–å¿½ç•¥å…³é”®å­—ä¿å­˜æˆåŠŸ",{time:2500,icon:1}),e.find('div[data-toggle="MATERIAL_LOTTERY_IGNORE_QUESTIONABLE_LOTTERY"] label.str').html(MY_API.CONFIG.QUESTIONABLE_LOTTERY.length+"ä¸ª"),layer.close(i)}))}),e.find('button[data-action="edit_ANCHOR_BLACKLIST_WORD"]').click(()=>{layer.prompt({formType:2,value:String(MY_API.CONFIG.ANCHOR_BLACKLIST_WORD),title:"è¯·è¾“å…¥å¤©é€‰æ—¶åˆ»å¿½ç•¥å…³é”®å­—",btn:["ä¿å­˜","å–æ¶ˆ"]},(function(t,i){let n=t.split(",");for(let e=0;e<n.length;e++)""===n[e]&&(n[e]="é’“é±¼");MY_API.CONFIG.ANCHOR_BLACKLIST_WORD=n,MY_API.saveConfig(!1),layer.msg("å¤©é€‰æ—¶åˆ»å¿½ç•¥å…³é”®å­—ä¿å­˜æˆåŠŸ",{time:2500,icon:1}),e.find('div[data-toggle="ANCHOR_IGNORE_BLACKLIST"] label.str').html(MY_API.CONFIG.ANCHOR_BLACKLIST_WORD.length+"ä¸ª"),layer.close(i)}))}),e.find('button[data-action="edit_ANCHOR_LETTER_CONTENT"]').click(()=>{layer.prompt({formType:2,value:MY_API.CONFIG.ANCHOR_LETTER_CONTENT,title:"è¯·è¾“å…¥å¤©é€‰æ—¶åˆ»ä¸­å¥–åå‘é€ç§ä¿¡å†…å®¹",btn:["ä¿å­˜","å–æ¶ˆ"]},(function(e,t){let i=e;i||(i="UPæˆ‘ä¸­å¤©é€‰äº†ï¼Œæ€ä¹ˆé¢†å¥–"),MY_API.CONFIG.ANCHOR_LETTER_CONTENT=i,MY_API.saveConfig(!1),layer.msg("å¤©é€‰æ—¶åˆ»ç§ä¿¡å†…å®¹ä¿å­˜æˆåŠŸ",{time:2500,icon:1}),layer.close(t)}))}),e.find('button[data-action="mainSiteTasks"]').click(()=>{mainSiteTasksBtnClickable&&(mainSiteTasksBtnClickable=!1,setTimeout(()=>mainSiteTasksBtnClickable=!0,2e3),MY_API.DailyReward.run(!0))}),e.find('button[data-action="edit_SCKEY"]').click(()=>{layer.prompt({formType:0,value:MY_API.CONFIG.FT_SCKEY,title:"è¯·è¾“å…¥æ–¹ç³–SCKEY",btn:["ä¿å­˜","å–æ¶ˆ"]},(function(e,t){MY_API.CONFIG.FT_SCKEY=e,MY_API.saveConfig(!1),layer.msg("æ–¹ç³–SCKEYä¿å­˜æˆåŠŸ",{time:2500,icon:1}),layer.close(t)}))}),e.find('button[data-action="editWhiteList"]').click(()=>{const e=[...(JSON.parse(localStorage.getItem(NAME+"AnchorFollowingList"))||{list:[]}).list];layer.prompt({formType:2,maxlength:Number.MAX_SAFE_INTEGER,value:String(e),title:"å¤©é€‰æ—¶åˆ»UIDç™½åå•",btn:["ä¿å­˜","å–æ¶ˆ"]},(function(e,t){let i=e;i||(i=[]),i=i.split(",");for(let e=0;e<i.length;e++)""===i[e]&&(i[e]="0");localStorage.setItem(NAME+"AnchorFollowingList",JSON.stringify({list:i})),layer.msg("å¤©é€‰æ—¶åˆ»UIDç™½åå•ä¿å­˜æˆåŠŸ",{time:2500,icon:1}),layer.close(t)}))}),e.find('button[data-action="saveFollowingList"]').click(()=>{if(getFollowBtnClickable)return getFollowBtnClickable=!1,window.toast("[ ä¿å­˜å½“å‰å…³æ³¨åˆ—è¡¨ä¸ºç™½åå• ] å¼€å§‹è·å–å…³æ³¨åˆ—è¡¨"),MY_API.AnchorLottery.getFollowingList()}),e.find('button[data-action="removeAnchorPrizeInTag"]').click(()=>{unFollowBtnClickable&&layer.confirm(`[ å¤©é€‰æ—¶åˆ» ] æ˜¯å¦å–å…³åœ¨ã€${anchorPrizeTagName}ã€‘åˆ†ç»„çš„UPä¸»ï¼Ÿ<li>æ³¨ï¼šä¸å»ºè®®å–å…³è¯¥åˆ†ç»„å†…UPã€‚</li>`,{title:"å–å…³ä¸åœ¨åˆ†ç»„å†…çš„UPä¸»",btn:["æ˜¯","å¦"]},(function(){return unFollowBtnClickable=!1,layer.msg("å¼€å§‹å–å…³",{time:2e3}),MY_API.AnchorLottery.getTag(anchorPrizeTagName).then(()=>MY_API.AnchorLottery.delAnchorFollowing(3))}),(function(){layer.msg("å·²å–æ¶ˆ",{time:2e3})}))}),e.find('button[data-action="removeAnchorFollowingInTag"]').click(()=>{unFollowBtnClickable&&layer.confirm(`[ å¤©é€‰æ—¶åˆ» ] æ˜¯å¦å–å…³åœ¨ã€${anchorFollowTagName}ã€‘åˆ†ç»„çš„UPä¸»ï¼Ÿ`,{title:"å–å…³ä¸åœ¨åˆ†ç»„å†…çš„UPä¸»",btn:["æ˜¯","å¦"]},(function(){return unFollowBtnClickable=!1,layer.msg("å¼€å§‹å–å…³",{time:2e3}),MY_API.AnchorLottery.getTag(anchorFollowTagName).then(()=>MY_API.AnchorLottery.delAnchorFollowing(2))}),(function(){layer.msg("å·²å–æ¶ˆ",{time:2e3})}))}),e.find('button[data-action="removeAnchorFollowing"]').click(()=>{unFollowBtnClickable&&layer.confirm("[ å¤©é€‰æ—¶åˆ» ] æ˜¯å¦å–å…³ä¸åœ¨ç™½åå•å†…çš„UPä¸»ï¼Ÿ",{title:"å–å…³ä¸åœ¨ç™½åå•å†…çš„UPä¸»",btn:["æ˜¯","å¦"]},(function(){return unFollowBtnClickable=!1,layer.msg("å¼€å§‹å–å…³",{time:2e3}),MY_API.AnchorLottery.delAnchorFollowing(1)}),(function(){layer.msg("å·²å–æ¶ˆ",{time:2e3})}))}),e.find('button[data-action="sendGiftNow"]').click(()=>{MY_API.CONFIG.AUTO_GIFT?(SEND_GIFT_NOW=!0,MY_API.Gift.run()):window.toast("[ ç«‹åˆ»å¼€å§‹é€ç¤¼ ] è¯·å…ˆå‹¾é€‰ã€è‡ªåŠ¨é€ç¤¼ã€‘å†ç‚¹å‡»æ­¤æŒ‰é’®","info")}),e.find('button[data-action="sendDanmuNow"]').click(()=>{MY_API.CONFIG.AUTO_DANMU?(SEND_DANMU_NOW=!0,MY_API.AUTO_DANMU.run()):window.toast("[ ç«‹åˆ»å‘é€å¼¹å¹• ] è¯·å…ˆå‹¾é€‰ã€è‡ªåŠ¨å‘å¼¹å¹•ã€‘å†ç‚¹å‡»æ­¤æŒ‰é’®","info")}),e.find('button[data-action="clearDanmuCache"]').click(()=>{MY_API.CACHE.AUTO_SEND_DANMU_TS=[],MY_API.saveCache()&&MY_API.chatLog("æ¸…é™¤å¼¹å¹•ç¼“å­˜æˆåŠŸ","success")});for(const t of a){const i=e.find(`div[data-toggle="${t}"] input:checkbox`);MY_API.CONFIG[t]&&i.attr("checked",""),i.change((function(){MY_API.CONFIG[t]=$(this).prop("checked"),o(e)}))}const i=e.find('div[data-toggle="INVISIBLE_ENTER"] input:checkbox');"true"===localStorage.getItem(NAME+"_INVISIBLE_ENTER")&&i.attr("checked",""),i.change((function(){localStorage.setItem(NAME+"_INVISIBLE_ENTER",$(this).prop("checked")),window.toast("[éšèº«å…¥åœº] é…ç½®å·²ä¿å­˜","info")}));const n=e.find('div[data-toggle="NOSLEEP"] input:checkbox');"true"===localStorage.getItem(NAME+"_NOSLEEP")&&n.attr("checked",""),n.change((function(){localStorage.setItem(NAME+"_NOSLEEP",$(this).prop("checked")),window.toast("[å±è”½æŒ‚æœºæ£€æµ‹] é…ç½®å·²ä¿å­˜","info")}));const s=e.find('div[data-toggle="debugSwitch"] input:checkbox');"true"===localStorage.getItem(NAME+"_debugSwitch")&&s.attr("checked",""),s.change((function(){debugSwitch=$(this).prop("checked"),localStorage.setItem(NAME+"_debugSwitch",debugSwitch),window.toast("[æ§åˆ¶å°æ—¥å¿—] é…ç½®å·²ä¿å­˜","info")})),$("input:text").bind("keydown",(function(t){13==t.keyCode&&o(e)}));for(const t of r)MY_API.CONFIG[t.name]===t.toggle1?$("div[data-toggle='"+t.toggle1+"'] input:radio").attr("checked",""):MY_API.CONFIG[t.name]===t.toggle2?$("div[data-toggle='"+t.toggle2+"'] input:radio").attr("checked",""):$("div[data-toggle='"+t.toggle1+"'] input:radio").attr("checked",""),$(`input:radio[name='${t.name}']`).change((function(){$(`div[data-toggle='${t.toggle1}'] input:radio`).is(":checked")?MY_API.CONFIG[t.name]=t.toggle1:$(`div[data-toggle='${t.toggle2}'] input:radio`).is(":checked")?MY_API.CONFIG[t.name]=t.toggle2:MY_API.CONFIG[t.name]=t.toggle1,o(e)}));$(".clickableText").click((function(){const e=$(this).attr("id");if(void 0!==e){const t=e.split("_help")[0];if(l.hasOwnProperty(t))return layer.open({title:"å¸®åŠ©ä¿¡æ¯ "+t,anim:5,area:[String(.382*$(window).width())+"px",String(.618*$(window).height())+"px"],content:l[t]})}}))},end:()=>{msgHide="hide",localStorage.setItem(NAME+"_msgHide",msgHide),$(".link-toast").hide(),document.getElementById("hiderbtn").innerHTML="æ˜¾ç¤ºçª—å£å’Œæç¤ºä¿¡æ¯"}})};e.click(()=>{hideBtnClickable&&(hideBtnClickable=!1,setTimeout((function(){hideBtnClickable=!0}),200),"show"==msgHide?(msgHide="hide",localStorage.setItem(NAME+"_msgHide",msgHide),$(".link-toast").hide(),layer.close(mainIndex),document.getElementById("hiderbtn").innerHTML="æ˜¾ç¤ºçª—å£å’Œæç¤ºä¿¡æ¯"):(msgHide="show",localStorage.setItem(NAME+"_msgHide",msgHide),$(".link-toast").show(),s(),document.getElementById("hiderbtn").innerHTML="éšè—çª—å£å’Œæç¤ºä¿¡æ¯"))}),t.on("DOMNodeInserted",(function(){let e=$(this).attr("data-player-state");"web-fullscreen"!==e&&"fullscreen"!==e||(layer.close(mainIndex),document.getElementById("hiderbtn").innerHTML="æ˜¾ç¤ºçª—å£å’Œæç¤ºä¿¡æ¯",layer.style(menuIndex,{display:"none"}),$("#menuDiv").removeClass("active"),$(".tab-list.dp-flex").children("li")[0].click())})),$(".attention-btn-ctnr").append(e),MY_API.CACHE.DailyReward_TS||(layer.tips("ç‚¹æˆ‘éšè—/æ˜¾ç¤ºæ§åˆ¶é¢æ¿","#hiderbtn",{tips:1}),setTimeout(()=>layer.tips("ç‚¹æˆ‘æŸ¥çœ‹æ—¥å¿—","#menuDiv",{tips:1}),6e3)),"show"==msgHide&&s()},chatLog:function(e,t="info"){let i=$("<div class='chatLogDiv'>"),n=$("<div class='chatLogMsg'>"),o=new Date;switch(n.html(e),i.text(o.toLocaleString()),i.append(n),t){case"warning":i.addClass("chatLogWarning");break;case"success":i.addClass("chatLogSuccess");break;case"error":i.addClass("chatLogError");break;case"prize":i.addClass("chatLogWinPrize");break;default:i.addClass("chatLogDefault")}JQmenuWindow.append(i);let a=i.find('span[id="time"] .num'),r=i.find('div[class="clickableText"]');const l=Number(a.text()),s=r.attr("id");if(void 0!==l){let e=l,t=setInterval(()=>{e--,e<=0?(i.find('span[id="time"]').html("å·²å¼€å¥–"),void 0!==s&&0===s.indexOf(NAME+"_ANCHOR")&&r.remove(),clearInterval(t)):a.text(e)},1e3)}layerMenuWindow_ScrollY>=layerMenuWindow_ScrollHeight&&layerMenuWindow.scrollTop(layerMenuWindow.prop("scrollHeight"))},blocked:!1,max_blocked:!1,listen:(e,t,i="æœ¬ç›´æ’­é—´")=>{BAPI.room.getConf(e).then(n=>{MYDEBUG("è·å–å¼¹å¹•æœåŠ¡å™¨ä¿¡æ¯ "+i,n);let o=new BAPI.DanmuWebSocket(t,e,n.data.host_server_list,n.data.token);o.bind(e=>{o=e,MY_API.chatLog(i+"å¼¹å¹•æœåŠ¡å™¨è¿æ¥æ–­å¼€ï¼Œå°è¯•é‡è¿","warning")},()=>{MY_API.chatLog(`â€”â€”â€”â€”â€”â€”è¿æ¥å¼¹å¹•æœåŠ¡å™¨æˆåŠŸâ€”â€”â€”â€”â€”â€”<br>æˆ¿é—´å·: ${e} åˆ†åŒº: ${i}`,"success")},()=>{(MY_API.blocked||MY_API.stormBlack)&&(o.close(),MY_API.chatLog("è¿›äº†å°é»‘å±‹ä¸»åŠ¨ä¸å¼¹å¹•æœåŠ¡å™¨æ–­å¼€è¿æ¥-"+i,"warning")),MY_API.max_blocked&&!MY_API.CONFIG.STORM&&(o.close(),MY_API.chatLog("è¾£æ¡æœ€å¤§å€¼ä¸»åŠ¨ä¸å¼¹å¹•æœåŠ¡å™¨æ–­å¼€è¿æ¥-"+i,"warning"))},e=>{switch(MYDEBUG("å¼¹å¹•å…¬å‘Š"+i,e),e.cmd){case"GUARD_MSG":e.roomid===e.real_roomid?MY_API.checkRoom(e.roomid,i):(MY_API.checkRoom(e.roomid,i),MY_API.checkRoom(e.real_roomid,i));break;case"PK_BATTLE_SETTLE_USER":e.data.winner?MY_API.checkRoom(e.data.winner.room_id,i):MY_API.checkRoom(e.data.my_info.room_id,i),MY_API.checkRoom(e.data.winner.room_id,i);break;case"NOTICE_MSG":switch(e.msg_type){case 1:break;case 2:case 3:case 4:case 8:e.roomid===e.real_roomid?MY_API.checkRoom(e.roomid,i):(MY_API.checkRoom(e.roomid,i),MY_API.checkRoom(e.real_roomid,i));break;case 5:break;case 6:window.toast(`ç›‘æ§åˆ°æˆ¿é—´ ${e.roomid} çš„èŠ‚å¥é£æš´`,"info"),MY_API.Storm.run(e.roomid);break}break;case"SPECIAL_GIFT":if(e.data[39])switch(e.data[39].action){case"start":window.toast(`ç›‘æ§åˆ°æˆ¿é—´ ${e.roomid} çš„èŠ‚å¥é£æš´`,"info"),MY_API.Storm.run(e.roomid);case"end":}break;default:return}})},()=>{MY_API.chatLog("è·å–å¼¹å¹•æœåŠ¡å™¨åœ°å€é”™è¯¯","error")})},EntryRoom_list_history:{add:function(e){let t=[];try{t=[...JSON.parse(localStorage.getItem(NAME+"_EntryRoom_list")).list],t.push(e),t.length>100&&t.splice(0,50),localStorage.setItem(NAME+"_EntryRoom_list",JSON.stringify({list:t}))}catch(i){t.push(e),localStorage.setItem(NAME+"_EntryRoom_list",JSON.stringify({list:t}))}},isIn:function(e){let t=[];try{const i=JSON.parse(localStorage.getItem(NAME+"_EntryRoom_list"));return t=null===i?[]:[...i.list],t.indexOf(e)>-1}catch(i){return localStorage.setItem(NAME+"_EntryRoom_list",JSON.stringify({list:t})),MYDEBUG("è¯»å–"+NAME+"_EntryRoom_listç¼“å­˜é”™è¯¯å·²é‡ç½®"),t.indexOf(e)>-1}}},RoomId_list:[],err_roomId:[],auto_danmu_list:["(=ãƒ»Ï‰ãƒ»=)","ï¼ˆï¿£â–½ï¿£ï¼‰","nice","666","kksk","(âŒ’â–½âŒ’)","(ï½€ãƒ»Ï‰ãƒ»Â´)","â•®(ï¿£â–½ï¿£)â•­","(ï¿£3ï¿£)","Î£( ï¿£â–¡ï¿£||)","(^ãƒ»Ï‰ãƒ»^ )","_(:3ã€âˆ )_"],checkRoom:function(e,t="æœ¬ç›´æ’­é—´"){MY_API.blocked||MY_API.max_blocked||MY_API.RoomId_list.indexOf(e)>=0||(MY_API.RoomId_list.push(e),!MY_API.EntryRoom_list_history.isIn(e)&&MY_API.CONFIG.LOTTERY&&(BAPI.room.room_entry_action(e),MY_API.EntryRoom_list_history.add(e)),probability(MY_API.CONFIG.RANDOM_SEND_DANMU)&&BAPI.room.get_info(e).then(t=>{MYDEBUG(`API.room.get_info roomId=${e} res`,t),BAPI.sendLiveDanmu(MY_API.auto_danmu_list[Math.floor(Math.random()*MY_API.auto_danmu_list.length)],t.data.room_id).then(e=>{MYDEBUG("[æ´»è·ƒå¼¹å¹•]å¼¹å¹•å‘é€è¿”å›ä¿¡æ¯",e)})}),BAPI.xlive.lottery.check(e).then(i=>{removeValinArray(e,MY_API.RoomId_list),MYDEBUG("æ£€æŸ¥æˆ¿é—´è¿”å›ä¿¡æ¯",i);const n=i.data;if(0===i.code){if(n.gift){const i=n.gift;for(let n in i)i.hasOwnProperty(n)&&MY_API.creat_join(e,i[n],"gift",t)}if(n.guard){const i=n.guard;for(let n in i)i.hasOwnProperty(n)&&MY_API.creat_join(e,i[n],"guard",t)}if(n.pk){const i=n.pk;for(let n in i)i.hasOwnProperty(n)&&MY_API.creat_join(e,i[n],"pk",t)}}else MY_API.chatLog("[æ£€æŸ¥æˆ¿é—´å‡ºé”™]"+response.msg,"error"),MY_API.err_roomId.indexOf(e)>-1?MYDEBUG(`[æ£€æŸ¥æ­¤æˆ¿é—´å‡ºé”™å¤šæ¬¡]${e}${i.message}`):(MY_API.err_roomId.push(e),MY_API.checkRoom(e,t),MYDEBUG(`[æ£€æŸ¥æˆ¿é—´å‡ºé”™_é‡è¯•ä¸€æ¬¡]${e}${i.message}`))}))},Id_list_history:{add:function(e,t){const i=[];try{i=[...JSON.parse(localStorage.getItem(`${NAME}_${t}Id_list`)).list],i.push(e),i.length>200&&i.splice(0,50),localStorage.setItem(`${NAME}_${t}Id_list`,JSON.stringify({list:i})),MYDEBUG(`${NAME}_${t}Id_list_add`,i)}catch(n){i.push(e),localStorage.setItem(`${NAME}_${t}Id_list`,JSON.stringify({list:i}))}},isIn:function(e,t){let i=[];try{const n=JSON.parse(localStorage.getItem(`${NAME}_${t}Id_list`));return i=null===n?[]:[...n.list],MYDEBUG(`${NAME}_${t}Id_list_read`,n),i.indexOf(e)>-1}catch(n){return localStorage.setItem(`${NAME}_${t}Id_list`,JSON.stringify({list:i})),MYDEBUG(`è¯»å–${NAME}_${t}Id_listç¼“å­˜é”™è¯¯å·²é‡ç½®`),i.indexOf(e)>-1}}},raffleId_list:[],guardId_list:[],pkId_list:[],creat_join:function(e,t,i,n="æœ¬ç›´æ’­é—´"){switch(MYDEBUG("ç¤¼ç‰©ä¿¡æ¯",t),i){case"gift":if(MY_API.Id_list_history.isIn(t.raffleId,"raffle"))return void MYDEBUG("ç¤¼ç‰©é‡å¤","raffleId "+t.raffleId);MY_API.raffleId_list.push(t.raffleId),MY_API.Id_list_history.add(t.raffleId,"raffle");break;case"guard":if(MY_API.Id_list_history.isIn(t.id,"guard"))return void MYDEBUG("èˆ°é•¿é‡å¤","id "+t.id);MY_API.guardId_list.push(t.id),MY_API.Id_list_history.add(t.id,"guard");break;case"pk":if(MY_API.Id_list_history.isIn(t.id,"pk"))return void MYDEBUG("pké‡å¤","id "+t.id);MY_API.pkId_list.push(t.id),MY_API.Id_list_history.add(t.id,"pk");break}let o=t.time_wait||0;MY_API.CONFIG.RANDOM_DELAY&&(o+=Math.floor(Math.random()*(MY_API.CONFIG.RND_DELAY_END-MY_API.CONFIG.RND_DELAY_START+1))+MY_API.CONFIG.RND_DELAY_START);let a=$("<div class='chatLogLottery'>"),r=$("<div class='chatLogMsg'>"),l=$("<div>"),s=new Date;r.text(`[${n}]`+t.thank_text.split("<%")[1].split("%>")[0]+t.thank_text.split("%>")[1]),a.text(s.toLocaleString()),a.append(r),l.css("color","red"),l.text("ç­‰å¾…æŠ½å¥–"),r.append(l),JQmenuWindow.append(a),layerMenuWindow_ScrollY>=layerMenuWindow_ScrollHeight&&layerMenuWindow.scrollTop(layerMenuWindow.prop("scrollHeight"));let d=setInterval(()=>{if(l.text(`ç­‰å¾…æŠ½å¥–å€’è®¡æ—¶${o}ç§’`),o<=0){if(probability(MY_API.CONFIG.RANDOM_SKIP))l.text("è·³è¿‡æ­¤ç¤¼ç‰©æŠ½å¥–");else switch(l.text("è¿›è¡ŒæŠ½å¥–..."),i){case"gift":MY_API.gift_join(e,t.raffleId,t.type).then((function(e,i){l.text(e),removeValinArray(t.raffleId,MY_API.raffleId_list)}));break;case"guard":MY_API.guard_join(e,t.id).then((function(e,i){l.text(e),removeValinArray(t.id,MY_API.guardId_list)}));break;case"pk":MY_API.pk_join(e,t.id).then((function(e,i){l.text(e),removeValinArray(t.id,MY_API.pkId_list)}));break}l.css("color","green"),clearInterval(d)}o--},1e3)},gift_join:function(e,t,i){return BAPI.Lottery.Gift.join(e,t,i).then(n=>{let o=$.Deferred();switch(MYDEBUG("æŠ½å¥–è¿”å›ä¿¡æ¯",n),n.code){case 0:n.data.award_text?o.resolve(n.data.award_text,n.data.award_num):o.resolve(n.data.award_name+"X"+n.data.award_num.toString(),n.data.award_num);break;default:n.msg.indexOf("æ‹’ç»")>-1?(MY_API.blocked=!0,o.resolve("è®¿é—®è¢«æ‹’ç»ï¼Œæ‚¨çš„å¸å·å¯èƒ½å·²ç»è¢«å…³å°é»‘å±‹ï¼Œå·²åœæ­¢")):o.resolve(`[ç¤¼ç‰©æŠ½å¥–](roomid=${e},id=${t},type=${i})${n.msg}`);break}return o})},guard_join:function(e,t){return BAPI.Lottery.Guard.join(e,t).then(i=>{MYDEBUG("ä¸Šèˆ¹æŠ½å¥–è¿”å›ä¿¡æ¯",i);let n=$.Deferred();switch(i.code){case 0:i.data.award_text?n.resolve(i.data.award_text,i.data.award_num):n.resolve(i.data.award_name+"X"+i.data.award_num.toString(),i.data.award_num);break;default:i.msg.indexOf("æ‹’ç»")>-1?(MY_API.blocked=!0,n.resolve("è®¿é—®è¢«æ‹’ç»ï¼Œæ‚¨çš„å¸å·å¯èƒ½å·²ç»è¢«å…³å°é»‘å±‹ï¼Œå·²åœæ­¢")):n.resolve(`[ä¸Šèˆ¹](roomid=${e},id=${t})${i.msg}`);break}return n})},pk_join:function(e,t){return BAPI.Lottery.Pk.join(e,t).then(i=>{MYDEBUG("PKæŠ½å¥–è¿”å›ä¿¡æ¯",i);let n=$.Deferred();switch(i.code){case 0:i.data.award_text?n.resolve(i.data.award_text,i.data.award_num):n.resolve(i.data.award_name+"X"+i.data.award_num.toString(),i.data.award_num);break;case-1:n.resolve(i.message);break;case-2:n.resolve(i.message);break;default:i.msg.indexOf("æ‹’ç»")>-1?(MY_API.blocked=!0,n.resolve("è®¿é—®è¢«æ‹’ç»ï¼Œæ‚¨çš„å¸å·å¯èƒ½å·²ç»è¢«å…³å°é»‘å±‹ï¼Œå·²åœæ­¢")):n.resolve(`[PK](roomid=${e},id=${t})${i.msg}`);break}return n})},GroupSign:{getGroups:()=>BAPI.Group.my_groups().then(e=>(MYDEBUG("GroupSign.getGroups: API.Group.my_groups",e),0===e.code?$.Deferred().resolve(e.data.list):(window.toast("[è‡ªåŠ¨åº”æ´å›¢ç­¾åˆ°]'"+e.msg,"caution"),$.Deferred().reject())),()=>(window.toast("[è‡ªåŠ¨åº”æ´å›¢ç­¾åˆ°]è·å–åº”æ´å›¢åˆ—è¡¨å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.GroupSign.getGroups()))),signInList:(e,t=0)=>{if(t>=e.length)return $.Deferred().resolve();const i=e[t];return i.owner_uid==Live_info.uid?MY_API.GroupSign.signInList(e,t+1):BAPI.Group.sign_in(i.group_id,i.owner_uid).then(n=>{MYDEBUG("GroupSign.signInList: API.Group.sign_in",n);let o=$.Deferred();return 0!==n.code?(window.toast("[è‡ªåŠ¨åº”æ´å›¢ç­¾åˆ°]'"+n.msg,"caution"),$.Deferred().reject()):(n.data.add_num>0?(window.toast(`[è‡ªåŠ¨åº”æ´å›¢ç­¾åˆ°]åº”æ´å›¢(group_id=${i.group_id},owner_uid=${i.owner_uid})ç­¾åˆ°æˆåŠŸï¼Œå½“å‰å‹‹ç« äº²å¯†åº¦+${n.data.add_num}`,"success"),o.resolve()):0==n.data.add_num?(window.toast(`[è‡ªåŠ¨åº”æ´å›¢ç­¾åˆ°]åº”æ´å›¢(group_id=${i.group_id},owner_uid=${i.owner_uid})å·²ç­¾åˆ°`,"caution"),o.resolve()):o.reject(),$.when(MY_API.GroupSign.signInList(e,t+1),o))},()=>(window.toast(`[è‡ªåŠ¨åº”æ´å›¢ç­¾åˆ°]åº”æ´å›¢(group_id=${i.group_id},owner_uid=${i.owner_uid})ç­¾åˆ°å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ`,"error"),delayCall(()=>MY_API.GroupSign.signInList(e,t))))},run:()=>{try{return MY_API.CONFIG.AUTO_GROUP_SIGN?checkNewDay(MY_API.CACHE.AUTO_GROUP_SIGH_TS)?(new Date).getHours()<8&&0!=MY_API.CACHE.AUTO_GROUP_SIGH_TS?(setTimeout(MY_API.GroupSign.run,getIntervalTime(8,0)),$.Deferred().resolve()):MY_API.GroupSign.getGroups().then(e=>MY_API.GroupSign.signInList(e).then(()=>(MY_API.CACHE.AUTO_GROUP_SIGH_TS=ts_ms(),MY_API.saveCache(),runTomorrow(MY_API.GroupSign.run,8,0,"åº”æ´å›¢ç­¾åˆ°"),$.Deferred().resolve()),()=>delayCall(()=>MY_API.GroupSign.run())),()=>delayCall(()=>MY_API.GroupSign.run())):(runTomorrow(MY_API.GroupSign.run,8,0,"åº”æ´å›¢ç­¾åˆ°"),$.Deferred().resolve()):$.Deferred().resolve()}catch(e){return window.toast("[è‡ªåŠ¨åº”æ´å›¢ç­¾åˆ°]è¿è¡Œæ—¶å‡ºç°å¼‚å¸¸ï¼Œå·²åœæ­¢","error"),console.error(`[${NAME}]`,e),$.Deferred().reject()}}},DailyReward:{coin_exp:0,login:()=>BAPI.DailyReward.login().then(()=>{MYDEBUG("DailyReward.login: API.DailyReward.login"),window.toast("[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥ç™»å½•]å®Œæˆ","success")},()=>(window.toast("[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥ç™»å½•]å®Œæˆå¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.DailyReward.login()))),watch:(e,t)=>MY_API.CONFIG.WATCH?BAPI.DailyReward.watch(e,t,Live_info.uid,ts_s()).then(t=>{MYDEBUG("DailyReward.watch: API.DailyReward.watch",t),0===t.code?window.toast(`[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥è§‚çœ‹]å®Œæˆ(av=${e})`,"success"):window.toast("[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥è§‚çœ‹]'"+t.msg,"caution")},()=>(window.toast("[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥è§‚çœ‹]å®Œæˆå¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.DailyReward.watch(e,t)))):$.Deferred().resolve(),coin:(e,t,i=0,n=!1)=>{if(!MY_API.CONFIG.COIN)return $.Deferred().resolve();if(MY_API.DailyReward.coin_exp>=10*MY_API.CONFIG.COIN_NUMBER)return window.toast("[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥æŠ•å¸]ä»Šæ—¥æŠ•å¸å·²å®Œæˆ","info"),$.Deferred().resolve();if(i>=e.length)return window.toast("[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥æŠ•å¸]åŠ¨æ€é‡Œå¯æŠ•å¸çš„è§†é¢‘ä¸è¶³","caution"),$.Deferred().resolve();const o=JSON.parse(e[i].card);let a=Math.min(2,t);return n&&(a=1),BAPI.x.getCoinInfo("","jsonp",o.aid,ts_ms()).then(r=>2===r.data.multiply?(MYDEBUG("API.x.getCoinInfo","å·²æŠ•å¸ä¸¤ä¸ª aid = "+o.aid),MY_API.DailyReward.coin(vlist,t,i+1)):(1===r.data.multiply&&(a=1),BAPI.DailyReward.coin(o.aid,a).then(r=>(MYDEBUG("DailyReward.coin: API.DailyReward.coin",r),0===r.code?(MY_API.DailyReward.coin_exp+=10*a,window.toast(`[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥æŠ•å¸]æŠ•å¸æˆåŠŸ(av=${o.aid},num=${a})`,"success"),MY_API.DailyReward.coin(e,t-a,i+1)):-110===r.code?(window.toast("[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥æŠ•å¸]æœªç»‘å®šæ‰‹æœºï¼Œå·²åœæ­¢","error"),$.Deferred().reject()):34003===r.code?n?MY_API.DailyReward.coin(e,t,i+1):MY_API.DailyReward.coin(e,t,i,!0):34005===r.code?MY_API.DailyReward.coin(e,t,i+1):-104===r.code?(window.toast("[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥æŠ•å¸]å‰©ä½™ç¡¬å¸ä¸è¶³ï¼Œå·²åœæ­¢","warning"),$.Deferred().reject()):(window.toast("[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥æŠ•å¸]'"+r.msg,"caution"),MY_API.DailyReward.coin(e,t,i+1))),()=>delayCall(()=>MY_API.DailyReward.coin(e,t,i)))))},coin_uid:(e,t,i,n,o=0,a=!1)=>{if(!MY_API.CONFIG.COIN)return $.Deferred().resolve();if(MY_API.DailyReward.coin_exp>=10*MY_API.CONFIG.COIN_NUMBER)return window.toast("[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥æŠ•å¸]ä»Šæ—¥æŠ•å¸å·²å®Œæˆ","info"),$.Deferred().resolve();if(o>=e.length)return MY_API.DailyReward.UserSpace(n,30,0,i+1,"","pubdate","jsonp");const r=e[o],l=MY_API.CONFIG.COIN_UID[n];if(r.hasOwnProperty("is_union_video")&&1===r.is_union_video&&r.mid!=l)return MYDEBUG("DailyReward.coin_uid","è”åˆæŠ•ç¨¿ä¸”UPä¸æ˜¯æŒ‡å®šUIDç”¨æˆ· aid = "+r.aid),MY_API.DailyReward.coin_uid(e,t,i,n,o+1);let s=Math.min(2,t);return a&&(s=1),BAPI.x.getCoinInfo("","jsonp",r.aid,ts_ms()).then(l=>2===l.data.multiply?(MYDEBUG("API.x.getCoinInfo","å·²æŠ•å¸ä¸¤ä¸ª aid = "+r.aid),MY_API.DailyReward.coin_uid(e,t,i,n,o+1)):(1===l.data.multiply&&(s=1),BAPI.DailyReward.coin(r.aid,s).then(l=>(MYDEBUG("DailyReward.coin_uid: API.DailyReward.coin_uid",l),0===l.code?(MY_API.DailyReward.coin_exp+=10*s,window.toast(`[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥æŠ•å¸]æŠ•å¸æˆåŠŸ(av=${r.aid},num=${s})`,"success"),MY_API.DailyReward.coin_uid(e,t-s,i,n,o+1)):-110===l.code?(window.toast("[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥æŠ•å¸]æœªç»‘å®šæ‰‹æœºï¼Œå·²åœæ­¢","error"),$.Deferred().reject()):34003===l.code?a?MY_API.DailyReward.coin_uid(e,t,i,n,o+1):MY_API.DailyReward.coin_uid(e,t,o,i,n,!0):34005===l.code?MY_API.DailyReward.coin_uid(e,t,i,n,o+1):-104===l.code?(window.toast("[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥æŠ•å¸]å‰©ä½™ç¡¬å¸ä¸è¶³ï¼Œå·²åœæ­¢","warning"),$.Deferred().reject()):(window.toast("[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥æŠ•å¸]'"+l.msg,"caution"),MY_API.DailyReward.coin_uid(e,t,i,n,o+1))),()=>delayCall(()=>MY_API.DailyReward.coin_uid(e,t,i,n,o)))))},share:e=>MY_API.CONFIG.SHARE?BAPI.DailyReward.share(e).then(t=>{MYDEBUG("DailyReward.share: API.DailyReward.share",t),0===t.code?window.toast(`[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥åˆ†äº«]åˆ†äº«æˆåŠŸ(av=${e})`,"success"):71e3===t.code?window.toast("[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥åˆ†äº«]ä»Šæ—¥åˆ†äº«å·²å®Œæˆ","info"):window.toast("[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥åˆ†äº«]'"+t.msg,"caution")},()=>(window.toast("[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥åˆ†äº«]åˆ†äº«å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.DailyReward.share(e)))):$.Deferred().resolve(),dynamic:async()=>{const e=MY_API.CONFIG.COIN_NUMBER-MY_API.DailyReward.coin_exp/10,t=await BAPI.getuserinfo().then(t=>(MYDEBUG("DailyReward.dynamic: API.getuserinfo",t),t.data.biliCoin<e?t.data.biliCoin:e));return t<e&&window.toast(`[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±][æ¯æ—¥æŠ•å¸]å‰©ä½™ç¡¬å¸ä¸è¶³ï¼Œä»…èƒ½æŠ•${t}ä¸ªå¸`,"warning"),BAPI.dynamic_svr.dynamic_new(Live_info.uid,8).then(e=>{if(MYDEBUG("DailyReward.dynamic: API.dynamic_svr.dynamic_new",e),0===e.code){if(e.data.cards){const i=JSON.parse(e.data.cards[0].card),n=MY_API.DailyReward.watch(i.aid,i.cid);let o;o=0==MY_API.CONFIG.COIN_UID||"COIN_DYN"==MY_API.CONFIG.COIN_TYPE?MY_API.DailyReward.coin(e.data.cards,Math.max(t,0)):MY_API.DailyReward.UserSpace(0,30,0,1,"","pubdate","jsonp");const a=MY_API.DailyReward.share(i.aid);return $.when(n,o,a)}window.toast('[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±]"åŠ¨æ€-æŠ•ç¨¿è§†é¢‘"ä¸­æš‚æ— åŠ¨æ€',"info")}else window.toast('[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±]è·å–"åŠ¨æ€-æŠ•ç¨¿è§†é¢‘"\''+e.msg,"caution")},()=>(window.toast('[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±]è·å–"åŠ¨æ€-æŠ•ç¨¿è§†é¢‘"å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ',"error"),delayCall(()=>MY_API.DailyReward.dynamic())))},UserSpace:(e,t,i,n,o,a,r)=>BAPI.x.getUserSpace(MY_API.CONFIG.COIN_UID[e],t,i,n,o,a,r).then(t=>{if(MYDEBUG("DailyReward.UserSpace: API.dynamic_svr.UserSpace",t),0===t.code){if(t.data.list.vlist){const i=MY_API.CONFIG.COIN_NUMBER-MY_API.DailyReward.coin_exp/10;return MY_API.DailyReward.coin_uid(t.data.list.vlist,Math.max(i,0),n,e)}if(e<MY_API.CONFIG.COIN_UID.length-1){const i=MY_API.CONFIG.COIN_NUMBER-MY_API.DailyReward.coin_exp/10;return MY_API.DailyReward.coin_uid(t.data.list.vlist,Math.max(i,0),n,e+1)}window.toast(`[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±]"UID = ${String(MY_API.CONFIG.COIN_UID)}çš„ç©ºé—´-æŠ•ç¨¿è§†é¢‘"ä¸­æš‚æ— è§†é¢‘`,"info")}else window.toast(`[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±]è·å–UID = ${MY_API.CONFIG.COIN_UID[e]}çš„"ç©ºé—´-æŠ•ç¨¿è§†é¢‘"'${t.msg}`,"caution")},()=>(window.toast('[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±]è·å–"ç©ºé—´-æŠ•ç¨¿è§†é¢‘"å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ',"error"),delayCall(()=>MY_API.DailyReward.UserSpace(uid,t,i,n,o,a,r)))),run:(e=!1)=>{try{return MY_API.CONFIG.LOGIN||MY_API.CONFIG.COIN||MY_API.CONFIG.WATCH?checkNewDay(MY_API.CACHE.DailyReward_TS)||e?BAPI.DailyReward.exp().then(e=>{MYDEBUG("DailyReward.run: API.DailyReward.exp",e),0===e.code?(MY_API.DailyReward.coin_exp=e.number,MY_API.DailyReward.login(),MY_API.DailyReward.dynamic(),MY_API.CACHE.DailyReward_TS=ts_ms(),MY_API.saveCache(),runMidnight(MY_API.DailyReward.run,"æ¯æ—¥ä»»åŠ¡")):window.toast("[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±]"+e.message,"caution")},()=>(window.toast("[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±]è·å–æ¯æ—¥å¥–åŠ±ä¿¡æ¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.DailyReward.run()))):(runMidnight(()=>MY_API.DailyReward.run(),"æ¯æ—¥ä»»åŠ¡"),$.Deferred().resolve()):$.Deferred().resolve()}catch(e){return window.toast("[è‡ªåŠ¨æ¯æ—¥å¥–åŠ±]è¿è¡Œæ—¶å‡ºç°å¼‚å¸¸","error"),console.error(`[${NAME}]`,e),$.Deferred().reject()}}},LiveReward:{dailySignIn:()=>BAPI.xlive.dosign().then(e=>{MYDEBUG("LiveReward.dailySignIn: API.xlive.dosign",e),0===e.code?(window.toast("[è‡ªåŠ¨ç›´æ’­ç­¾åˆ°]å®Œæˆ","success"),$(".hinter").remove(),$(".checkin-btn").remove()):1011040===e.code?window.toast("[è‡ªåŠ¨ç›´æ’­ç­¾åˆ°]ä»Šæ—¥ç›´æ’­ç­¾åˆ°å·²å®Œæˆ","info"):(window.toast(`[è‡ªåŠ¨ç›´æ’­ç­¾åˆ°]${e.message}ï¼Œå°è¯•ç‚¹å‡»ç­¾åˆ°æŒ‰é’®`,"caution"),$(".checkin-btn").click())},()=>(window.toast("[è‡ªåŠ¨ç›´æ’­ç­¾åˆ°]ç›´æ’­ç­¾åˆ°å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.LiveReward.dailySignIn()))),run:()=>{try{if(!MY_API.CONFIG.LIVE_SIGN)return $.Deferred().resolve();if(!checkNewDay(MY_API.CACHE.LiveReward_TS))return runMidnight(MY_API.LiveReward.run,"ç›´æ’­ç­¾åˆ°"),$.Deferred().resolve();MY_API.LiveReward.dailySignIn(),MY_API.CACHE.LiveReward_TS=ts_ms(),MY_API.saveCache(),runMidnight(MY_API.LiveReward.run,"ç›´æ’­ç­¾åˆ°")}catch(e){return window.toast("[è‡ªåŠ¨ç›´æ’­ç­¾åˆ°]è¿è¡Œæ—¶å‡ºç°å¼‚å¸¸","error"),console.error(`[${NAME}]`,e),$.Deferred().reject()}}},Exchange:{silver2coin:()=>BAPI.Exchange.silver2coin().then(e=>{MYDEBUG("Exchange.silver2coin: API.SilverCoinExchange.silver2coin",e),0===e.code?window.toast("[é“¶ç“œå­æ¢ç¡¬å¸]"+e.msg,"success"):403===e.code?window.toast("[é“¶ç“œå­æ¢ç¡¬å¸]"+e.msg,"info"):window.toast("[é“¶ç“œå­æ¢ç¡¬å¸]"+e.msg,"caution")},()=>(window.toast("[é“¶ç“œå­æ¢ç¡¬å¸]å…‘æ¢å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.Exchange.silver2coin()))),runS2C:()=>{try{return MY_API.CONFIG.SILVER2COIN?checkNewDay(MY_API.CACHE.Silver2Coin_TS)?MY_API.Exchange.silver2coin().then(()=>{MY_API.CACHE.Silver2Coin_TS=ts_ms(),MY_API.saveCache(),runMidnight(MY_API.Exchange.runS2C,"ç“œå­æ¢ç¡¬å¸")},()=>delayCall(()=>MY_API.Exchange.runS2C())):(runMidnight(MY_API.Exchange.runS2C,"ç“œå­æ¢ç¡¬å¸"),$.Deferred().resolve()):$.Deferred().resolve()}catch(e){return window.toast("[é“¶ç“œå­æ¢ç¡¬å¸]è¿è¡Œæ—¶å‡ºç°å¼‚å¸¸ï¼Œå·²åœæ­¢","error"),console.error(`[${NAME}]`,e),$.Deferred().reject()}}},Gift:{run_timer:void 0,ruid:void 0,room_id:void 0,medal_list:void 0,bag_list:void 0,time:void 0,remain_feed:void 0,over:!1,run_timer:void 0,sendGiftList:[1,6,30607],getMedalList:async(e=1)=>(1===e&&(MY_API.Gift.medal_list=[]),BAPI.i.medal(e,25).then(t=>{if(MYDEBUG("Gift.getMedalList: API.i.medal",t),MY_API.Gift.medal_list=MY_API.Gift.medal_list.concat(t.data.fansMedalList),t.data.pageinfo.curPage<t.data.pageinfo.totalpages)return MY_API.Gift.getMedalList(e+1)},()=>(window.toast("[è‡ªåŠ¨é€ç¤¼]è·å–å‹‹ç« åˆ—è¡¨å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.Gift.getMedalList())))),getBagList:async()=>BAPI.gift.bag_list().then(e=>{MYDEBUG("Gift.getBagList: API.gift.bag_list",e),MY_API.Gift.bag_list=e.data.list,MY_API.Gift.time=e.data.time},()=>(window.toast("[è‡ªåŠ¨é€ç¤¼]è·å–åŒ…è£¹åˆ—è¡¨å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.Gift.getBagList()))),getFeedByGiftID:e=>{if(30607===e)return 50;for(let t=Live_info.gift_list.length-1;t>=0;--t)if(Live_info.gift_list[t].id===e)return Math.ceil(Live_info.gift_list[t].price/100);return 0},sort_medals:e=>{if("GIFT_SORT_HIGH"==MY_API.CONFIG.GIFT_SORT?e.sort((e,t)=>t.level-e.level==0?t.intimacy-e.intimacy:t.level-e.level):e.sort((e,t)=>e.level-t.level==0?e.intimacy-t.intimacy:e.level-t.level),MY_API.CONFIG.AUTO_GIFT_ROOMID&&MY_API.CONFIG.AUTO_GIFT_ROOMID.length>0){let t=[...MY_API.CONFIG.AUTO_GIFT_ROOMID];t.reverse();for(let i of t){let t=e.findIndex(e=>e.roomid==i);if(-1!=t){let i=e[t];e.splice(t,1),e.unshift(i)}}}return e},run:async()=>{try{if(!MY_API.CONFIG.AUTO_GIFT)return $.Deferred().resolve();if(medalDanmuRunning)return window.toast("[è‡ªåŠ¨é€ç¤¼]ã€ç²‰ä¸ç‰Œæ‰“å¡ã€‘ä»»åŠ¡è¿è¡Œä¸­ï¼Œæš‚åœè¿è¡Œï¼Œ30ç§’åå†æ¬¡æ£€æŸ¥","warning"),setTimeout(()=>MY_API.Gift.run(),3e4);if(MY_API.Gift.run_timer&&clearTimeout(MY_API.Gift.run_timer),"GIFT_SEND_TIME"==MY_API.CONFIG.GIFT_METHOD&&!isTime(MY_API.CONFIG.GIFT_SEND_HOUR,MY_API.CONFIG.GIFT_SEND_MINUTE)&&!SEND_GIFT_NOW){let e=getIntervalTime(MY_API.CONFIG.GIFT_SEND_HOUR,MY_API.CONFIG.GIFT_SEND_MINUTE);MY_API.Gift.run_timer=setTimeout(()=>MY_API.Gift.run(),e);let t=new Date(ts_ms()+e).toLocaleString();return MYDEBUG("[è‡ªåŠ¨é€ç¤¼]",`å°†åœ¨${t}è¿›è¡Œè‡ªåŠ¨é€ç¤¼`),$.Deferred().resolve()}if("GIFT_INTERVAL"==MY_API.CONFIG.GIFT_METHOD&&!SEND_GIFT_NOW){let e=6e4*MY_API.CONFIG.GIFT_INTERVAL;if(MY_API.CACHE.GiftInterval_TS){const t=ts_ms()-MY_API.CACHE.GiftInterval_TS;if(t<e){let i=e-t;return MY_API.Gift.run_timer=setTimeout(MY_API.Gift.run,i),void MYDEBUG("[è‡ªåŠ¨é€ç¤¼]",`å°†åœ¨${i}æ¯«ç§’åè¿›è¡Œè‡ªåŠ¨é€ç¤¼`)}}else MY_API.CACHE.GiftInterval_TS=ts_ms(),MY_API.saveCache()}MY_API.Gift.over=!1,await MY_API.Gift.getMedalList();let e=MY_API.Gift.medal_list;if(MYDEBUG("Gift.run: Gift.getMedalList().then: Gift.medal_list",e),e&&e.length>0){if(e=e.filter(e=>e.day_limit-e.today_feed>0&&e.level<20),e=MY_API.Gift.sort_medals(e),MY_API.CONFIG.EXCLUDE_ROOMID&&MY_API.CONFIG.EXCLUDE_ROOMID.length>0){const t=MY_API.CONFIG.EXCLUDE_ROOMID;e=e.filter(e=>-1==t.findIndex(t=>t==e.roomid))}for(let t of e){if(MY_API.Gift.over)break;let e=await BAPI.room.room_init(parseInt(t.roomid,10));MY_API.Gift.room_id=parseInt(e.data.room_id,10),MY_API.Gift.ruid=t.target_id,MY_API.Gift.remain_feed=t.day_limit-t.today_feed,MY_API.Gift.remain_feed>0&&(await MY_API.Gift.getBagList(),MY_API.Gift.remain_feed>0?(window.toast(`[è‡ªåŠ¨é€ç¤¼]å‹‹ç« [${t.medalName}] ä»Šæ—¥äº²å¯†åº¦æœªæ»¡[${t.today_feed}/${t.day_limit}]ï¼Œé¢„è®¡éœ€è¦[${MY_API.Gift.remain_feed}]é€ç¤¼å¼€å§‹`,"info"),await MY_API.Gift.sendGift(t)):window.toast(`[è‡ªåŠ¨é€ç¤¼]å‹‹ç« [${t.medalName}] ä»Šæ—¥äº²å¯†åº¦å·²æ»¡`,"info"))}}await MY_API.Gift.sendRemainGift(MY_API.CONFIG.SPARE_GIFT_ROOM)}catch(e){return window.toast("[è‡ªåŠ¨é€ç¤¼]é€ç¤¼å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.Gift.run()),window.toast("[è‡ªåŠ¨é€ç¤¼]è¿è¡Œæ—¶å‡ºç°å¼‚å¸¸ï¼Œå·²åœæ­¢","error"),console.error(`[${NAME}]`,e),$.Deferred().reject()}return SEND_GIFT_NOW=!1,(()=>{if("GIFT_SEND_TIME"==MY_API.CONFIG.GIFT_METHOD){let e=getIntervalTime(MY_API.CONFIG.GIFT_SEND_HOUR,MY_API.CONFIG.GIFT_SEND_MINUTE);MY_API.Gift.run_timer=setTimeout(()=>MY_API.Gift.run(),e);let t=new Date(ts_ms()+e).toLocaleString();MYDEBUG("[è‡ªåŠ¨é€ç¤¼]",`å°†åœ¨${t}è¿›è¡Œè‡ªåŠ¨é€ç¤¼`),MY_API.CACHE.Gift_TS=ts_ms(),MY_API.saveCache()}else{let e=60*MY_API.CONFIG.GIFT_INTERVAL*1e3;MY_API.Gift.run_timer=setTimeout(()=>MY_API.Gift.run(),e),MYDEBUG("[è‡ªåŠ¨é€ç¤¼]",`å°†åœ¨${MY_API.CONFIG.GIFT_INTERVAL}åˆ†é’Ÿåè¿›è¡Œè‡ªåŠ¨é€ç¤¼`),MY_API.CACHE.GiftInterval_TS=ts_ms(),MY_API.saveCache()}})(),$.Deferred().resolve()},sendGift:async e=>{let t;if(await MY_API.Gift.getBagList(),MY_API.Gift.remain_feed<=0)return window.toast(`[è‡ªåŠ¨é€ç¤¼]å‹‹ç« [${e.medalName}] é€ç¤¼ç»“æŸï¼Œä»Šæ—¥äº²å¯†åº¦å·²æ»¡[${e.today_feed}/${e.day_limit}]`,"info"),$.Deferred().resolve();if(MY_API.Gift.time<=0&&(MY_API.Gift.time=ts_s()),MY_API.CONFIG.SEND_ALL_GIFT){let e=MY_API.Gift.bag_list.filter(e=>e.gift_num>0&&"æ°¸ä¹…"!=e.corner_mark);if(0==e.length)return void(MY_API.Gift.over=!0);t=e}else{let e=MY_API.Gift.bag_list.filter(e=>MY_API.Gift.sendGiftList.includes(e.gift_id)&&e.gift_num>0&&e.corner_mark.substring(0,e.corner_mark.indexOf("å¤©"))<=MY_API.CONFIG.GIFT_LIMIT);if(MYDEBUG("[è‡ªåŠ¨é€ç¤¼]passçš„ç¤¼ç‰©",e),0==e.length)return void(MY_API.Gift.over=!0);t=e}MYDEBUG("bag_list",t);for(let i of t){if(e.day_limit-e.today_feed<=0)return void window.toast(`[è‡ªåŠ¨é€ç¤¼]å‹‹ç« [${e.medalName}] é€ç¤¼ç»“æŸï¼Œä»Šæ—¥äº²å¯†åº¦å·²æ»¡[${e.today_feed}/${e.day_limit}]`,"info");let t=MY_API.Gift.getFeedByGiftID(i.gift_id);if(t>0){let n=Math.floor(MY_API.Gift.remain_feed/t);n>i.gift_num&&(n=i.gift_num),n>0&&(MYDEBUG("[è‡ªåŠ¨é€ç¤¼]é€å‡ºç¤¼ç‰©ç±»å‹",i.gift_name),await BAPI.gift.bag_send(Live_info.uid,i.gift_id,MY_API.Gift.ruid,n,i.bag_id,MY_API.Gift.room_id,Live_info.rnd).then(o=>{MYDEBUG("Gift.sendGift: API.gift.bag_send",o),0===o.code?(i.gift_num-=n,e.today_feed+=n*t,MY_API.Gift.remain_feed-=n*t,window.toast(`[è‡ªåŠ¨é€ç¤¼]å‹‹ç« [${e.medalName}] é€ç¤¼æˆåŠŸï¼Œé€å‡º${n}ä¸ª${i.gift_name}ï¼Œ[${e.today_feed}/${e.day_limit}]è·ç¦»ä»Šæ—¥äº²å¯†åº¦ä¸Šé™è¿˜éœ€[${MY_API.Gift.remain_feed}]`,"success")):window.toast(`[è‡ªåŠ¨é€ç¤¼]å‹‹ç« [${e.medalName}] é€ç¤¼å¼‚å¸¸:${o.msg}`,"caution")},()=>(window.toast("[è‡ªåŠ¨é€ç¤¼]åŒ…è£¹é€ç¤¼å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.Gift.sendGift(e)))))}}},sendRemainGift:async e=>{if(0==e)return $.Deferred().resolve();let t,i=void 0;if(await BAPI.live_user.get_anchor_in_room(e).then(e=>{if(MYDEBUG("API.live_user.get_anchor_in_room",e),!e.data.info.uid)return window.toast("[è‡ªåŠ¨é€ç¤¼]ã€å‰©ä½™ç¤¼ç‰©ã€‘æ£€æŸ¥æˆ¿é—´å‡ºé”™"),$.Deferred().reject();i=e.data.info.uid}),await MY_API.Gift.getBagList(),MY_API.Gift.time<=0&&(MY_API.Gift.time=ts_s()),MY_API.CONFIG.SEND_ALL_GIFT){let e=MY_API.Gift.bag_list.filter(e=>e.gift_num>0&&"æ°¸ä¹…"!=e.corner_mark);if(0==e.length)return void(MY_API.Gift.over=!0);t=e}else{let e=MY_API.Gift.bag_list.filter(e=>MY_API.Gift.sendGiftList.includes(e.gift_id)&&e.gift_num>0&&"1å¤©"==e.corner_mark);if(0==e.length)return void(MY_API.Gift.over=!0);t=e}MYDEBUG("[è‡ªåŠ¨é€ç¤¼]ã€å‰©ä½™ç¤¼ç‰©ã€‘bag_list",t);for(let n of t){if(MY_API.Gift.getFeedByGiftID(n.gift_id)>0){let t=n.gift_num;t>0&&await BAPI.gift.bag_send(Live_info.uid,n.gift_id,i,t,n.bag_id,e,Live_info.rnd).then(i=>{MYDEBUG("Gift.sendGift: API.gift.bag_send",i),0===i.code?(n.gift_num-=t,window.toast(`[è‡ªåŠ¨é€ç¤¼]ã€å‰©ä½™ç¤¼ç‰©ã€‘æˆ¿é—´[${e}] é€ç¤¼æˆåŠŸï¼Œé€å‡º${t}ä¸ª${n.gift_name}`,"success")):window.toast(`[è‡ªåŠ¨é€ç¤¼]ã€å‰©ä½™ç¤¼ç‰©ã€‘æˆ¿é—´[${e}] é€ç¤¼å¼‚å¸¸:${i.msg}`,"caution")},()=>(window.toast("[è‡ªåŠ¨é€ç¤¼]ã€å‰©ä½™ç¤¼ç‰©ã€‘åŒ…è£¹é€ç¤¼å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.Gift.sendGift(medal))))}}}},stormQueue:[],stormBlack:!1,stormIdSet:{add:function(e){let t=[];try{t=[...JSON.parse(localStorage.getItem(NAME+"stormIdSet")).list],t.push(e),t.length>50&&t.splice(0,10),localStorage.setItem(NAME+"stormIdSet",JSON.stringify({list:t})),MYDEBUG(NAME+"storm_Id_list_add",t)}catch(i){t.push(e),localStorage.setItem(NAME+"stormIdSet",JSON.stringify({list:t}))}},isIn:function(e){let t=[];try{const i=JSON.parse(localStorage.getItem(NAME+"stormIdSet"));return t=null===i?[]:[...i.list],MYDEBUG(NAME+"storm_Id_list_read",i),t.indexOf(e)>-1}catch(i){return localStorage.setItem(NAME+"stormIdSet",JSON.stringify({list:t})),MYDEBUG("è¯»å–"+NAME+"stormIdSetç¼“å­˜é”™è¯¯å·²é‡ç½®"),t.indexOf(e)>-1}}},Storm:{check:e=>MY_API.stormQueue.indexOf(e)>-1,append:e=>{MY_API.stormQueue.push(e),MY_API.stormQueue.length>MY_API.CONFIG.STORM_QUEUE_SIZE&&MY_API.stormQueue.shift()},over:e=>{MY_API.stormQueue.indexOf(e)>-1&&MY_API.stormQueue.splice(e,1)},run:e=>{try{return MY_API.CONFIG.STORM?MY_API.stormBlack?$.Deferred().resolve():BAPI.Storm.check(e).then(t=>{if(MYDEBUG("MY_API.Storm.run: MY_API.API.Storm.check",t),0===t.code){let e=t.data;return MY_API.Storm.join(e.id,e.roomid,Math.round((new Date).getTime()/1e3)+e.time),$.Deferred().resolve()}window.toast(`[è‡ªåŠ¨æŠ½å¥–][èŠ‚å¥é£æš´](roomid=${e})${t.msg}`,"caution")},()=>{window.toast(`[è‡ªåŠ¨æŠ½å¥–][èŠ‚å¥é£æš´]æ£€æŸ¥ç›´æ’­é—´(${e})å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ`,"error")}):$.Deferred().resolve()}catch(e){return window.toast("[è‡ªåŠ¨æŠ½å¥–][èŠ‚å¥é£æš´]è¿è¡Œæ—¶å‡ºç°å¼‚å¸¸","error"),console.error(`[${NAME}]`,e),$.Deferred().reject()}},join:(e,t,i)=>{if(t=parseInt(t,10),e=parseInt(e,10),isNaN(t)||isNaN(e))return $.Deferred().reject();let n=Math.round(e/1e6);if(MY_API.stormIdSet.isIn(n))return $.Deferred().resolve();if(MY_API.stormIdSet.add(n),MY_API.Storm.check(e))return;MY_API.Storm.append(e);let o=0;i<=0&&(i=Math.round((new Date).getTime()/1e3)+90);let a=0;return window.toast(`[è‡ªåŠ¨æŠ½å¥–][èŠ‚å¥é£æš´]å°è¯•æŠ½å¥–(roomid=${t},id=${e})`,"success"),o=setInterval(()=>async function(){try{if(!MY_API.Storm.check(e))return void clearInterval(o);let n,r=Math.round((new Date).getTime()/1e3);if(r>i&&i>0)return MY_API.Storm.over(e),void clearInterval(o);if(a++,a>MY_API.CONFIG.STORM_MAX_COUNT&&MY_API.CONFIG.STORM_MAX_COUNT>0)return MY_API.Storm.over(e),clearInterval(o),void window.toast(`[è‡ªåŠ¨æŠ½å¥–][èŠ‚å¥é£æš´]æŠ½å¥–(roomid=${t},id=${e})åˆ°è¾¾å°è¯•æ¬¡æ•°ã€‚\r\nå°è¯•æ¬¡æ•°:${a},è·ç¦»åˆ°æœŸ:${i-r}s`,"caution");try{if(n=userToken&&appToken&&tokenData.access_token?await BAPI.Storm.join_ex(e,t,tokenData.access_token,BilibiliToken.appKey,BilibiliToken.headers):await BAPI.Storm.join(e,captcha_token="",captcha_phrase="",t),MYDEBUG("MY_API.Storm.join: MY_API.API.Storm.join",n),!n.code)return MY_API.Storm.over(e),Statistics.appendGift(n.data.gift_name,n.data.gift_num),window.toast(`[è‡ªåŠ¨æŠ½å¥–][èŠ‚å¥é£æš´]é¢†å–(roomid=${t},id=${e})æˆåŠŸ,${n.data.gift_name+"x"+n.data.gift_num}\r\n${n.data.mobile_content}\r\nå°è¯•æ¬¡æ•°:${a}`,"success"),void clearInterval(o);if(-1!=n.msg.indexOf("é¢†å–"))return MY_API.Storm.over(e),clearInterval(o),void window.toast(`[è‡ªåŠ¨æŠ½å¥–][èŠ‚å¥é£æš´]é¢†å–(roomid=${t},id=${e})æˆåŠŸ,${n.msg}\r\nå°è¯•æ¬¡æ•°:${a}`,"success");if(-1!=n.msg.indexOf("éªŒè¯ç "))return MY_API.Storm.over(e),clearInterval(o),MY_API.stormBlack=!0,void window.toast(`[è‡ªåŠ¨æŠ½å¥–][èŠ‚å¥é£æš´]æŠ½å¥–(roomid=${t},id=${e})å¤±è´¥,ç–‘ä¼¼è´¦å·ä¸æ”¯æŒ,${n.msg}`,"caution");if(n.data&&0==n.data.length&&-1!=n.msg.indexOf("ä¸‹æ¬¡è¦æ›´å¿«ä¸€ç‚¹"))return MY_API.Storm.over(e),window.toast(`[è‡ªåŠ¨æŠ½å¥–][èŠ‚å¥é£æš´]æŠ½å¥–(roomid=${t},id=${e})ç–‘ä¼¼é£æš´é»‘å±‹,ç»ˆæ­¢ï¼`,"error"),clearInterval(o),MY_API.stormBlack=!0,void setTimeout(()=>{MY_API.stormBlack=!1},36e5);if(-1==n.msg.indexOf("ä¸‹æ¬¡è¦æ›´å¿«ä¸€ç‚¹"))return void clearInterval(o)}catch(i){return MY_API.Storm.over(e),window.toast(`[è‡ªåŠ¨æŠ½å¥–][èŠ‚å¥é£æš´]æŠ½å¥–(roomid=${t},id=${e})ç–‘ä¼¼è§¦å‘é£æ§,ç»ˆæ­¢ï¼\r\nå°è¯•æ¬¡æ•°:${a}`,"error"),console.error(i),void clearInterval(o)}}catch(i){return MY_API.Storm.over(e),window.toast(`[è‡ªåŠ¨æŠ½å¥–][èŠ‚å¥é£æš´]æŠ½å¥–(roomid=${t},id=${e})æŠ½å¥–å¼‚å¸¸,ç»ˆæ­¢ï¼`,"error"),console.error(i),void clearInterval(o)}}(),MY_API.CONFIG.STORM_ONE_LIMIT),$.Deferred().resolve()}},LITTLE_HEART:{getInfo:()=>XHR({GM:!0,anonymous:!0,method:"GET",url:"https://passport.bilibili.com/x/passport-login/oauth2/info?"+appToken.signLoginQuery("access_key="+tokenData.access_token),responseType:"json",headers:appToken.headers}),RandomHex:e=>{const t="0123456789abcdef";let i="";i+=t[Math.floor(15*Math.random())+1];for(let n=0;n<e-1;n++)i+=t[Math.floor(16*Math.random())];return i},uuid:()=>MY_API.LITTLE_HEART.RandomHex(32).replace(/(\w{8})(\w{4})\w(\w{3})\w(\w{3})(\w{12})/,`$1-$2-4$3-${"89ab"[Math.floor(4*Math.random())]}$4-$5`),getFansMedal:async()=>{const e=await XHR({GM:!0,anonymous:!0,method:"GET",url:"https://api.live.bilibili.com/fans_medal/v1/FansMedal/get_list_in_room?"+BilibiliToken.signQuery(`access_key=${tokenData.access_token}&target_id=${Live_info.tid}&uid=${Live_info.uid}&${baseQuery}`),responseType:"json",headers:appToken.headers});if(MYDEBUG("[å°å¿ƒå¿ƒ] getFansMedal",e.response),void 0!==e&&200===e.response.status&&0===e.body.code&&e.body.data.length>0)return e.body.data},getGiftNum:async()=>{let e=0;return await BAPI.gift.bag_list().then(t=>{MYDEBUG("[å°å¿ƒå¿ƒ]æ£€æŸ¥åŒ…è£¹ API.gift.bag_list",t);const i=t.data.list.filter(e=>30607==e.gift_id&&"7å¤©"==e.corner_mark);for(const t of i)e+=t.gift_num}),MYDEBUG("[å°å¿ƒå¿ƒ]æ£€æµ‹åˆ°åŒ…è£¹å†…7å¤©å°å¿ƒå¿ƒæ•°é‡",e),e},mobileHeartBeat:async e=>{const t=new WasmHash;await t.init();const i=(n=e,t.hash("BLAKE2b512",t.hash("SHA3-384",t.hash("SHA384",t.hash("SHA3-512",t.hash("SHA512",JSON.stringify(n)))))));var n;let o="";for(const t in e)o+=`${t}=${encodeURIComponent(e[t])}&`;o+="client_sign="+i;const a=await XHR({GM:!0,anonymous:!0,method:"POST",url:"https://live-trace.bilibili.com/xlive/data-interface/v1/heartbeat/mobileHeartBeat",data:BilibiliToken.signQuery(`access_key=${tokenData.access_token}&${o}&${baseQuery}`),responseType:"json",headers:appToken.headers});return MYDEBUG("[å°å¿ƒå¿ƒ] mobileHeartBeat",a.response),void 0!==a&&200===a.response.status&&0===a.body.code},run:async()=>{if(!MY_API.CONFIG.LITTLE_HEART)return $.Deferred().resolve();if(!checkNewDay(MY_API.CACHE.LittleHeart_TS))return runMidnight(MY_API.LITTLE_HEART.run,"è·å–å°å¿ƒå¿ƒ"),$.Deferred().resolve();const e={platform:"android",uuid:MY_API.LITTLE_HEART.uuid(),buvid:appToken.buvid,seq_id:"1",room_id:"{room_id}",parent_id:"6",area_id:"283",timestamp:"{timestamp}",secret_key:"axoaadsffcazxksectbbb",watch_time:"60",up_id:"{target_id}",up_level:"40",jump_from:"30000",gu_id:MY_API.LITTLE_HEART.RandomHex(43),play_type:"0",play_url:"",s_time:"0",data_behavior_id:"",data_source_id:"",up_session:"l:one:live:record:{room_id}:{last_wear_time}",visit_id:MY_API.LITTLE_HEART.RandomHex(32),watch_status:"%7B%22pk_id%22%3A0%2C%22screen_status%22%3A1%7D",click_id:MY_API.LITTLE_HEART.uuid(),session_id:"",player_type:"0",client_ts:"{client_ts}"},t=async(e=!0)=>(e&&await sleep(5e3),!e||await MY_API.LITTLE_HEART.getGiftNum()>=24?(window.toast("[å°å¿ƒå¿ƒ]ä»Šæ—¥å°å¿ƒå¿ƒå·²å…¨éƒ¨è·å–","success"),MY_API.CACHE.LittleHeart_TS=ts_ms(),MY_API.saveCache(),runMidnight(MY_API.LITTLE_HEART.run,"è·å–å°å¿ƒå¿ƒ")):(window.toast("[å°å¿ƒå¿ƒ]å°å¿ƒå¿ƒæœªå…¨éƒ¨è·å–ï¼Œ60ç§’åå°†å†æ¬¡è¿è¡Œ","info"),setTimeout(()=>MY_API.LITTLE_HEART.run(),6e4)));if(void 0===await setToken())return;if(!tokenData.access_token&&!tokenData.mid&&!tokenData.refresh_token){const e=await MY_API.LITTLE_HEART.getInfo();if(MYDEBUG("[å°å¿ƒå¿ƒ]userInfo",e),void 0===e)return console.error(GM_info.script.name+"å°å¿ƒå¿ƒ","è·å–ç”¨æˆ·ä¿¡æ¯é”™è¯¯");if(0!==e.body.code&&void 0===await setToken())return;if(e.body.data.mid!==Live_info.uid&&void 0===await setToken())return}MYDEBUG("[å°å¿ƒå¿ƒ] å¼€å§‹å®¢æˆ·ç«¯å¿ƒè·³ tokenData",tokenData.access_token),window.toast("[å°å¿ƒå¿ƒ]å¼€å§‹è·å–å°å¿ƒå¿ƒ","success");const i=await MY_API.LITTLE_HEART.getGiftNum();if(!(i<24))return t(!1);{const n=await MY_API.LITTLE_HEART.getFansMedal();if(void 0!==n){const o=24-i,a=5*Math.ceil(o/n.length);for(let t=0;t<a;t++){let t=0;for(const i of n){if(t>=o)break;const n=Object.assign({},e,{room_id:i.room_id.toString(),timestamp:(BilibiliToken.TS-60).toString(),up_id:i.target_id.toString(),up_session:`l:one:live:record:${i.room_id}:${i.last_wear_time}`,client_ts:BilibiliToken.TS.toString()});await MY_API.LITTLE_HEART.mobileHeartBeat(n),t++}await sleep(6e4)}return t()}}}},AUTO_DANMU:{setValue:(e,t)=>void 0===MY_API.CONFIG[e][t]&&t>0?MY_API.AUTO_DANMU.setValue(e,t-1):MY_API.CONFIG[e][t],sendDanmu:async(e,t)=>{let i=t;return Number(t)<=1e3&&(i=await BAPI.room.get_info(t).then(e=>(MYDEBUG(`API.room.get_info roomId=${t} res`,e),e.data.room_id))),BAPI.sendLiveDanmu(e,i).then(i=>{MYDEBUG(`[è‡ªåŠ¨å‘å¼¹å¹•]å¼¹å¹•å‘é€å†…å®¹ã€${e}ã€‘ï¼Œæˆ¿é—´å·ã€${t}ã€‘`,i),0!==i.code||i.msg?window.toast(`[è‡ªåŠ¨å‘å¼¹å¹•]å¼¹å¹•ã€${e}ã€‘ï¼ˆæˆ¿é—´å·ã€${t}ã€‘ï¼‰å‡ºé”™ ${i.msg}`,"caution"):window.toast(`[è‡ªåŠ¨å‘å¼¹å¹•]å¼¹å¹•ã€${e}ã€‘ï¼ˆæˆ¿é—´å·ã€${t}ã€‘ï¼‰å‘é€æˆåŠŸ`,"success")},()=>(window.toast(`[è‡ªåŠ¨å‘å¼¹å¹•]å¼¹å¹•ã€${e}ã€‘ï¼ˆæˆ¿é—´å·ã€${t}ã€‘ï¼‰å‘é€å¤±è´¥`,"error"),$.Deferred().reject()))},getMaxLength:()=>{let e=void 0;const t=MY_API.CONFIG.DANMU_CONTENT.length,i=MY_API.CONFIG.DANMU_ROOMID.length,n=MY_API.CONFIG.DANMU_INTERVAL_TIME.length;return e=t>=i?t:i,e<n&&(e=n),e},run:async()=>{if(!MY_API.CONFIG.AUTO_DANMU)return $.Deferred().resolve();if(medalDanmuRunning)return window.toast("[è‡ªåŠ¨å‘å¼¹å¹•]ã€ç²‰ä¸ç‰Œæ‰“å¡ã€‘ä»»åŠ¡è¿è¡Œä¸­ï¼Œæš‚åœè¿è¡Œï¼Œ30ç§’åå†æ¬¡æ£€æŸ¥","warning"),setTimeout(()=>MY_API.AUTO_DANMU.run(),3e4);if(danmuTaskRunning=!0,SEND_DANMU_NOW){for(let e=0;e<MY_API.CONFIG.DANMU_CONTENT.length;e++){let t=MY_API.AUTO_DANMU.setValue("DANMU_CONTENT",e),i=parseInt(MY_API.AUTO_DANMU.setValue("DANMU_ROOMID",e));await MY_API.AUTO_DANMU.sendDanmu(t,i),await sleep(1e3)}SEND_DANMU_NOW=!1}else{let e=MY_API.AUTO_DANMU.getMaxLength();for(let t=0;t<e;t++){let e=MY_API.AUTO_DANMU.setValue("DANMU_CONTENT",t),i=parseInt(MY_API.AUTO_DANMU.setValue("DANMU_ROOMID",t)),n=MY_API.AUTO_DANMU.setValue("DANMU_INTERVAL_TIME",t),o=void 0,a=MY_API.CACHE.AUTO_SEND_DANMU_TS,r=void 0,l=void 0,s=void 0,d=void 0,_=0;if(n.indexOf(":")>-1){l=!0;const e=n.split(":"),t=parseInt(e[0]),i=parseInt(e[1]),o=parseInt(e[2]);isTime(t,i,o)||(_=getIntervalTime(t,i,o))}else if(l=!1,n=n.toLowerCase(),n.indexOf("h")>-1||n.indexOf("m")>-1||n.indexOf("s")>-1){const e=n.split("h"),t=void 0===e[1]?e[0].split("m"):e[1].split("m"),i=void 0===t[1]?t[0].split("s"):t[1].split("s"),o=e[0],a=t[0],r=i[0],l=isNaN(o)?0:o||0,s=isNaN(a)?0:a||0,_=isNaN(r)?0:r||0;d=36e5*l+6e4*s+1e3*_}else d=6e4*n;MYDEBUG("[è‡ªåŠ¨å‘å¼¹å¹•]MY_API.CACHE.AUTO_SEND_DANMU_TS => jsoncache",a);for(const t of a)if(t.roomid==i&&t.content==e){o=t.sendTs,r=a.indexOf(t);break}l||(s=o?ts_ms()-o:ts_ms());const c=()=>{const t={roomid:i,content:e,sendTs:ts_ms()};return o?a[r].sendTs=ts_ms():a.push(t),MY_API.CACHE.AUTO_SEND_DANMU_TS=a,MY_API.saveCache(!1)},A=(t,n)=>(n||c(),setTimeout(async()=>(await MY_API.AUTO_DANMU.sendDanmu(e,i),n||c(),A(t,n)),t));!l&&s>=d?(await MY_API.AUTO_DANMU.sendDanmu(e,i),MYDEBUG(`[è‡ªåŠ¨å‘å¼¹å¹•]å¼¹å¹•å‘é€å†…å®¹ã€${e}ã€‘ï¼Œæˆ¿é—´å·ã€${i}ã€‘ï¼Œè·ä¸‹æ¬¡å‘é€è¿˜æœ‰`,n),A(d,l)):l&&!_?(await MY_API.AUTO_DANMU.sendDanmu(e,i),_=getIntervalTime(danmu_time[0],danmu_time[1],danmu_time[2]),MYDEBUG(`[è‡ªåŠ¨å‘å¼¹å¹•]å¼¹å¹•å‘é€å†…å®¹ã€${e}ã€‘ï¼Œæˆ¿é—´å·ã€${i}ã€‘ï¼Œè·ä¸‹æ¬¡å‘é€è¿˜æœ‰`,"çº¦24å°æ—¶"),A(_,l)):(MYDEBUG(`[è‡ªåŠ¨å‘å¼¹å¹•]å¼¹å¹•å‘é€å†…å®¹ã€${e}ã€‘ï¼Œæˆ¿é—´å·ã€${i}ã€‘ï¼Œè·ä¸‹æ¬¡å‘é€è¿˜æœ‰`,(l?_/6e4:(d-s)/6e4)+"åˆ†é’Ÿ"),setTimeout(async()=>{await MY_API.AUTO_DANMU.sendDanmu(e,i),A(l?864e5:d,l)},l?_:d-s)),await sleep(1100)}}danmuTaskRunning=!1}},MEDAL_DANMU:{medal_list:[],getMedalList:async(e=1)=>(1===e&&(MY_API.MEDAL_DANMU.medal_list=[]),BAPI.i.medal(e,25).then(t=>{if(MYDEBUG("MEDAL_DANMU.getMedalList: API.i.medal",t),MY_API.MEDAL_DANMU.medal_list=MY_API.MEDAL_DANMU.medal_list.concat(t.data.fansMedalList),t.data.pageinfo.curPage<t.data.pageinfo.totalpages)return MY_API.MEDAL_DANMU.getMedalList(e+1)},()=>(MY_API.chatLog("[ç²‰ä¸ç‰Œæ‰“å¡å¼¹å¹•]<br>è·å–å‹‹ç« åˆ—è¡¨å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.MEDAL_DANMU.getRoomList())))),sendDanmu:async(e,t,i)=>{let n=t;return Number(t)<=1e3&&(n=await BAPI.room.get_info(t).then(e=>(MYDEBUG(`API.room.get_info roomId=${t} res`,e),e.data.room_id))),BAPI.sendLiveDanmu(e,n).then(n=>{MYDEBUG(`[ç²‰ä¸ç‰Œæ‰“å¡å¼¹å¹•] å¼¹å¹•å‘é€å†…å®¹ã€${e}ã€‘ï¼Œæˆ¿é—´å·ã€${t}ã€‘ï¼Œç²‰ä¸å‹‹ç« ã€${i}ã€‘`,n),0!==n.code||n.msg?window.toast(`[ç²‰ä¸ç‰Œæ‰“å¡å¼¹å¹•] å¼¹å¹•ã€${e}ã€‘ï¼ˆæˆ¿é—´å·ã€${t}ã€‘ï¼Œç²‰ä¸å‹‹ç« ã€${i}ã€‘ï¼‰å‡ºé”™ ${n.msg}`,"caution"):window.toast(`[ç²‰ä¸ç‰Œæ‰“å¡å¼¹å¹•] å¼¹å¹•ã€${e}ã€‘å‘é€æˆåŠŸï¼Œæˆ¿é—´å·ã€${t}ã€‘ï¼Œç²‰ä¸å‹‹ç« ã€${i}ã€‘å·²ç‚¹äº®ï¼Œå½“å‰äº²å¯†åº¦+100`,"success")},()=>(window.toast(`[ç²‰ä¸ç‰Œæ‰“å¡å¼¹å¹•] å¼¹å¹•ã€${e}ã€‘ï¼ˆæˆ¿é—´å·ã€${t}ã€‘ï¼Œç²‰ä¸å‹‹ç« ã€${i}ã€‘ï¼‰å‘é€å¤±è´¥`,"error"),$.Deferred().reject()))},run:async()=>{if(!MY_API.CONFIG.MEDAL_DANMU)return $.Deferred().resolve();if(!checkNewDay(MY_API.CACHE.medalDanmu_TS))return runMidnight(()=>MY_API.MEDAL_DANMU.run(),"ç²‰ä¸å‹‹ç« æ‰“å¡å¼¹å¹•"),$.Deferred().resolve();if(danmuTaskRunning)return window.toast("[ç²‰ä¸ç‰Œæ‰“å¡]ã€è‡ªåŠ¨å‘å¼¹å¹•ã€‘ä»»åŠ¡è¿è¡Œä¸­ï¼Œæš‚åœè¿è¡Œï¼Œ30ç§’åå†æ¬¡æ£€æŸ¥","warning"),setTimeout(()=>MY_API.MEDAL_DANMU.run(),3e4);let e;medalDanmuRunning=!0,await MY_API.MEDAL_DANMU.getMedalList(),e="MEDAL_DANMU_WHITE"===MY_API.CONFIG.MEDAL_DANMU_METHOD?MY_API.MEDAL_DANMU.medal_list.filter(e=>MY_API.CONFIG.MEDAL_DANMU_ROOM.findIndex(t=>t==e.roomid)>-1):MY_API.MEDAL_DANMU.medal_list.filter(e=>-1===MY_API.CONFIG.MEDAL_DANMU_ROOM.findIndex(t=>t==e.roomid)),MYDEBUG("[ç²‰ä¸ç‰Œæ‰“å¡] è¿‡æ»¤åçš„ç²‰ä¸å‹‹ç« æˆ¿é—´åˆ—è¡¨",e);for(const t of e){const e=t.medal_name,i=t.roomid,n=MY_API.CONFIG.MEDAL_DANMU_CONTENT[Math.floor(Math.random()*MY_API.CONFIG.MEDAL_DANMU_CONTENT.length)];await MY_API.MEDAL_DANMU.sendDanmu(n,i,e),await sleep(1100)}return medalDanmuRunning=!1,window.toast("[ç²‰ä¸ç‰Œæ‰“å¡å¼¹å¹•] ä»Šæ—¥å·²å®Œæˆ","success"),MY_API.CACHE.medalDanmu_TS=ts_ms(),MY_API.saveCache(),runMidnight(MY_API.MEDAL_DANMU.run,"ç²‰ä¸å‹‹ç« æ‰“å¡å¼¹å¹•")}},MaterialObject:{list:[],firstAid:void 0,run:()=>{try{if(!MY_API.CONFIG.MATERIAL_LOTTERY)return $.Deferred().resolve();if(MY_API.CACHE.materialobject_ts){const e=ts_ms()-MY_API.CACHE.materialobject_ts,t=6e4*MY_API.CONFIG.MATERIAL_LOTTERY_CHECK_INTERVAL||6e5;if(e<t)return MYDEBUG("[å®ç‰©æŠ½å¥–]",t-e+"æ¯«ç§’åå†æ¬¡è¿è¡Œ"),setTimeout(MY_API.MaterialObject.run,t-e),$.Deferred().resolve()}return MY_API.chatLog("[å®ç‰©æŠ½å¥–] å¼€å§‹å¯»æ‰¾å¯å‚åŠ çš„æŠ½å¥–"),MY_API.MaterialObject.check().then(e=>{e&&(MY_API.CACHE.last_aid=e,MY_API.CACHE.materialobject_ts=ts_ms(),MY_API.saveCache()),MYDEBUG("[å®ç‰©æŠ½å¥–]",`å°†åœ¨${MY_API.CONFIG.MATERIAL_LOTTERY_CHECK_INTERVAL}åˆ†é’Ÿåå†æ¬¡è¿è¡Œå®ç‰©æŠ½å¥–`),setTimeout(MY_API.MaterialObject.run,6e4*MY_API.CONFIG.MATERIAL_LOTTERY_CHECK_INTERVAL||6e5)},()=>delayCall(()=>MY_API.MaterialObject.run()))}catch(e){return MY_API.chatLog("[å®ç‰©æŠ½å¥–]è¿è¡Œæ—¶å‡ºç°å¼‚å¸¸","error"),console.error(`[${NAME}]`,e),$.Deferred().reject()}},check:(aid,valid=639,rem=MY_API.CONFIG.MATERIAL_LOTTERY_REM||9)=>(aid=parseInt(aid||MY_API.CACHE.last_aid,10),isNaN(aid)&&(aid=valid),MYDEBUG("API.MaterialObject.check: aid=",aid),BAPI.Lottery.MaterialObject.getStatus(aid).then(response=>{if(MYDEBUG("API.MaterialObject.check: API.MY_API.MaterialObject.getStatus",response),0===response.code&&response.data){if(3!=response.data.typeB[response.data.typeB.length-1].status&&void 0===MY_API.MaterialObject.firstAid&&(MY_API.MaterialObject.firstAid=aid),MY_API.CONFIG.MATERIAL_LOTTERY_IGNORE_QUESTIONABLE_LOTTERY)for(const str of MY_API.CONFIG.QUESTIONABLE_LOTTERY)if("/"!=str.charAt(0)&&"/"!=str.charAt(str.length-1)){if(response.data.title.toLowerCase().indexOf(str.toLowerCase())>-1)return MY_API.chatLog(`[å®ç‰©æŠ½å¥–] å¿½ç•¥å­˜ç–‘æŠ½å¥–(aid = ${aid})<br>å«æœ‰å…³é”®å­—ï¼š`+str,"warning"),MY_API.MaterialObject.check(aid+1,aid)}else{let reg=eval(str);if(reg.test(response.data.title))return MY_API.chatLog(`[å®ç‰©æŠ½å¥–] å¿½ç•¥å­˜ç–‘æŠ½å¥–(aid = ${aid})<br>åŒ¹é…æ­£åˆ™ï¼š`+str,"warning"),MY_API.MaterialObject.check(aid+1,aid)}return MY_API.MaterialObject.join(aid,response.data.title,response.data.typeB).then(()=>MY_API.MaterialObject.check(aid+1,aid))}if(-400===response.code||null==response.data)return rem?MY_API.MaterialObject.check(aid+1,valid,rem-1):$.Deferred().resolve(MY_API.MaterialObject.firstAid||valid);MY_API.chatLog("[å®ç‰©æŠ½å¥–] "+response.msg,"warning")},()=>(MY_API.chatLog(`[å®ç‰©æŠ½å¥–] æ£€æŸ¥æŠ½å¥–(aid = ${aid})å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ`,"error"),delayCall(()=>MY_API.MaterialObject.check(aid,valid))))),join:(e,t,i,n=0)=>{if(n>=i.length)return $.Deferred().resolve();if(MY_API.MaterialObject.list.some(t=>t.aid===e&&t.number===n+1))return MY_API.MaterialObject.join(e,t,i,n+1);let o={title:t,aid:e,number:n+1,status:i[n].status,join_start_time:i[n].join_start_time,join_end_time:i[n].join_end_time,list:i[n].list,jpName:""};for(const e of o.list)o.jpName=o.jpName.concat(" ",e.jp_name);switch(o.status){case-1:{MY_API.chatLog(`[å®ç‰©æŠ½å¥–] å°†åœ¨${new Date(1e3*(o.join_start_time+1)).toLocaleString()}å‚åŠ æŠ½å¥–<br>"${o.title}" aid = ${o.aid} ç¬¬${n+1}è½® å¥–å“ï¼š${o.jpName}`,"info"),MY_API.MaterialObject.list.push(o);const e=$.Deferred();e.then(()=>MY_API.MaterialObject.draw(o)),setTimeout(()=>{e.resolve()},1e3*(o.join_start_time-ts_s()+1))}break;case 0:return MY_API.MaterialObject.draw(o).then(()=>MY_API.MaterialObject.join(e,t,i,n+1));case 1:{MY_API.chatLog(`[å®ç‰©æŠ½å¥–] å·²å‚åŠ æŠ½å¥–<br>"${o.title}" aid = ${o.aid} ç¬¬${n+1}è½® å¥–å“ï¼š${o.jpName}`,"info"),MY_API.MaterialObject.list.push(o);const e=$.Deferred();e.then(()=>MY_API.MaterialObject.notice(o)),setTimeout(()=>{e.resolve()},1e3*(o.join_end_time-ts_s()+1))}break}return MY_API.MaterialObject.join(e,t,i,n+1)},draw:e=>BAPI.Lottery.MaterialObject.draw(e.aid,e.number).then(t=>{if(MYDEBUG("API.MaterialObject.check: API.MY_API.MaterialObject.draw",t),0===t.code){$.each(MY_API.MaterialObject.list,(t,i)=>{if(i.aid===e.aid&&i.number===e.number)return i.status=1,MY_API.MaterialObject.list[t]=i,!1}),MY_API.chatLog(`[å®ç‰©æŠ½å¥–] æˆåŠŸå‚åŠ æŠ½å¥–<nr>"${e.title}"(aid = ${e.aid}ï¼Œç¬¬${e.number}è½®) å¥–å“ï¼š${e.jpName}`,"success"),MY_API.addMaterial();const t=$.Deferred();t.then(()=>MY_API.MaterialObject.notice(e)),setTimeout(()=>{t.resolve()},1e3*(e.join_end_time-ts_s()+1))}else MY_API.chatLog(`[å®ç‰©æŠ½å¥–] "${e.title}"(aid = ${e.aid}ï¼Œç¬¬${e.number}è½®)<br>${t.msg}`,"warning")},()=>(MY_API.chatLog(`[å®ç‰©æŠ½å¥–] å‚åŠ "${e.title}"(aid = ${e.aid}ï¼Œç¬¬${e.number}è½®)<br>å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ`,"error"),delayCall(()=>MY_API.MaterialObject.draw(e)))),notice:e=>BAPI.Lottery.MaterialObject.getWinnerGroupInfo(e.aid,e.number).then(t=>{if(MYDEBUG("API.MaterialObject.check: API.MY_API.MaterialObject.getWinnerGroupInfo",t),0===t.code){$.each(MY_API.MaterialObject.list,(t,i)=>{if(i.aid===e.aid&&i.number===e.number)return i.status=3,MY_API.MaterialObject.list[t]=i,!1});for(const n of t.data.groups)for(const t of n.list)if(t.uid===Live_info.uid){if(MY_API.chatLog(`[å®ç‰©æŠ½å¥–] æŠ½å¥–"${e.title}"(aid = ${e.aid}ï¼Œç¬¬${e.number}è½®)è·å¾—å¥–åŠ±<br>"${n.giftTitle}"`,"prize"),winPrizeNum++,winPrizeTotalCount++,JQlogRedPoint.text(winPrizeNum),JQlogRedPoint.is(":hidden")&&JQlogRedPoint.show(),MY_API.CONFIG.FT_NOTICE){function i(){return FT_sendMsg(MY_API.CONFIG.FT_SCKEY,`ã€${GM_info.script.name}ã€‘å®ç‰©æŠ½å¥–ä¸­å¥–é€šçŸ¥ ${e.title}ï¼Œç¬¬${e.number}è½®`,`###å®ç‰©æŠ½å¥–ä¸­å¥–\n###ä¸­å¥–è´¦å·idï¼š${Live_info.uname}\n###${e.title}\n###aid = ${e.aid}\n###ç¬¬${e.number}è½®\n###è·å¾—å¥–åŠ±ï¼š\n###${n.giftTitle}\n###è¯·åŠæ—¶å¡«å†™é¢†å¥–ä¿¡æ¯`).then(e=>{MYDEBUG("FT_sendMsg response",e),0==e.body.errno?window.toast("[å®ç‰©æŠ½å¥–] æ–¹ç³–ä¸­å¥–æç¤ºå‘é€æˆåŠŸ","success"):window.toast("[å®ç‰©æŠ½å¥–] æ–¹ç³–ä¸­å¥–æç¤ºå‘é€å¤±è´¥ "+e.errmsg,"error")}),()=>(MY_API.chatLog("[å®ç‰©æŠ½å¥–] æ–¹ç³–ä¸­å¥–æç¤ºå‘é€å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>i()))}i()}return MY_API.CONFIG.GM_NOTICE&&GM_notice("å®ç‰©æŠ½å¥–ä¸­å¥–",`${e.title}ï¼Œå¥–å“ï¼š${n.giftTitle}`),!0}MY_API.chatLog(`[å®ç‰©æŠ½å¥–] æŠ½å¥–"${e.title}"(aid = ${e.aid}ï¼Œç¬¬${e.number}è½®)æœªä¸­å¥–`,"info")}else MY_API.chatLog(`[å®ç‰©æŠ½å¥–] æŠ½å¥–"${e.title}"(aid = ${e.aid}ï¼Œç¬¬${e.number}è½®)<br>${t.msg}`,"warning")},()=>(MY_API.chatLog(`[å®ç‰©æŠ½å¥–] è·å–æŠ½å¥–"${e.title}"(aid = ${e.aid}ï¼Œç¬¬${e.number}è½®)<br>è·å–ä¸­å¥–åå•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ`,"error"),delayCall(()=>MY_API.MaterialObject.notice(e))))},AnchorLottery:{roomidList:[],oldLotteryResponseList:[],lotteryResponseList:[],myLiveRoomid:0,followingList:[],unfollowList:[],uidInTagList:[],uidInOriginTag:[],medal_list:[],waitForRecheckList:[],anchorFollowTagid:void 0,anchorPrizeTagid:void 0,getMedalList:async(e=1)=>(1===e&&(MY_API.AnchorLottery.medal_list=[]),BAPI.i.medal(e,25).then(t=>{if(MYDEBUG("AnchorLottery.getMedalList: API.i.medal",t),MY_API.AnchorLottery.medal_list=MY_API.AnchorLottery.medal_list.concat(t.data.fansMedalList),t.data.pageinfo.curPage<t.data.pageinfo.totalpages)return MY_API.AnchorLottery.getMedalList(e+1)},()=>(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»]<br>è·å–å‹‹ç« åˆ—è¡¨å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.AnchorLottery.getMedalList())))),getFollowingList:(e=1,t=50)=>(1===e&&(MY_API.AnchorLottery.followingList=[]),BAPI.relation.getFollowings(Live_info.uid,e,t).then(i=>{MYDEBUG(`getFollowingList API.relation.getFollowings ${e}, ${t}`,i);let n=$.Deferred();if(0===i.code){n.resolve();const o=i.data.total;for(const e of i.data.list)MY_API.AnchorLottery.followingList.push(String(e.mid));return o-MY_API.AnchorLottery.followingList.length>0?$.when(MY_API.AnchorLottery.getFollowingList(e+1,t),n):(window.toast("[ä¿å­˜å½“å‰å…³æ³¨åˆ—è¡¨ä¸ºç™½åå•] ä¿å­˜å…³æ³¨åˆ—è¡¨æˆåŠŸ","success"),localStorage.setItem(NAME+"AnchorFollowingList",JSON.stringify({list:MY_API.AnchorLottery.followingList})),getFollowBtnClickable=!0,n)}return window.toast("[ä¿å­˜å½“å‰å…³æ³¨åˆ—è¡¨ä¸ºç™½åå•] è·å–å…³æ³¨åˆ—è¡¨å‡ºé”™ "+i.message,"error"),n.reject()},()=>(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] è·å–å…³æ³¨åˆ—è¡¨å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.AnchorLottery.getFollowingList())))),getTag:async e=>("string"==typeof e&&(e=[e]),BAPI.relation.getTags().then(t=>{if(MYDEBUG("API.relation.getTags",t),0===t.code){let i=$.Deferred(),n=$.Deferred();for(const i of t.data)i.name===anchorFollowTagName?e.indexOf(anchorFollowTagName)>-1&&(MY_API.AnchorLottery.anchorFollowTagid=i.tagid):i.name===anchorPrizeTagName&&e.indexOf(anchorPrizeTagName)>-1&&(MY_API.AnchorLottery.anchorPrizeTagid=i.tagid);return void 0===MY_API.AnchorLottery.anchorFollowTagid&&MY_API.CONFIG.ANCHOR_MOVETO_FOLLOW_TAG?MY_API.AnchorLottery.creatTag(anchorFollowTagName).then(()=>i.resolve()):i.resolve(),void 0===MY_API.AnchorLottery.anchorPrizeTagid&&MY_API.CONFIG.ANCHOR_MOVETO_PRIZE_TAG?i.then(()=>MY_API.AnchorLottery.creatTag(anchorPrizeTagName).then(()=>n.resolve())):n.resolve(),$.when(i,n)}return MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] è·å–å…³æ³¨åˆ†ç»„å‡ºé”™ "+t.message,"error"),p.reject()},()=>(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] è·å–å…³æ³¨åˆ†ç»„å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.AnchorLottery.getTag(e))))),creatTag:e=>BAPI.relation.createTag(e).then(t=>{MYDEBUG("API.relation.createTag "+e,t);let i=$.Deferred();return 0===t.code?(e===anchorFollowTagName?MY_API.AnchorLottery.anchorFollowTagid=t.data.tagid:e===anchorPrizeTagName&&(MY_API.AnchorLottery.anchorPrizeTagid=t.data.tagid),i.resolve()):(MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] åˆ›å»ºåˆ†ç»„ã€${e}ã€‘å‡ºé”™ ${t.message}`,"error"),i.reject())},()=>(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] åˆ›å»ºå…³æ³¨åˆ†ç»„å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.AnchorLottery.creatTag(e)))),getUpInOriginTag:(e,t=0,i=1,n=50)=>BAPI.relation.getUpInTag(e,t,i,n).then(o=>{let a=$.Deferred();if(MYDEBUG(`API.relation.getUpInOriginTag ${t} ${i} ${n}`,o),0===o.code){if(a.resolve(),0===o.data.length)return a;for(const e of o.data)MY_API.AnchorLottery.uidInOriginTag.push(String(e.mid));return $.when(MY_API.AnchorLottery.getUpInOriginTag(e,t,i+1,n),a)}return window.toast("è·å–é»˜è®¤åˆ†ç»„å…³æ³¨åˆ—è¡¨å‡ºé”™ "+o.message,"error"),a.reject()},()=>(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] è·å–Tagå†…UPåˆ—è¡¨å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.AnchorLottery.getUpInOriginTag(e,t=0,i=1,n=50)))),delAnchorFollowing:async(e=1,t=1,i=50)=>{function n(e,t,i=1,o=50){return 1===i&&(MY_API.AnchorLottery.unfollowList=[]),BAPI.relation.getUpInTag(e,t,i,o).then(a=>{let r=$.Deferred();if(MYDEBUG(`API.relation.getUpInTag ${t} ${i} ${o}`,a),0===a.code){if(r.resolve(),0===a.data.length)return r;for(const e of a.data)MY_API.AnchorLottery.uidInTagList.push(String(e.mid));return $.when(n(e,t,i+1,o),r)}return window.toast("[å–å…³BLTHå¤©é€‰åˆ†ç»„å†…çš„UP] è·å–å…³æ³¨åˆ—è¡¨å‡ºé”™ "+a.message,"error"),r.reject()},()=>(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] è·å–Tagå†…UPåˆ—è¡¨å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>n(e,t,i=1,o=50))))}function o(e,t){let i,n;if(1===e){if(i=JSON.parse(localStorage.getItem(NAME+"AnchorFollowingList"))||{list:[]},0===i.list.length)return window.toast("[å–å…³ä¸åœ¨ç™½åå•å†…çš„UPä¸»] è¯·å…ˆç‚¹å‡»ã€ä¿å­˜å½“å‰å…³æ³¨åˆ—è¡¨ä¸ºç™½åå•ã€‘!","info"),$.Deferred().resolve();n=[...i.list]}let a=[],r=[];for(const i of t)1===e?-1===n.indexOf(String(i))&&a.push(i):2!==e&&3!==e||a.push(i);for(let e=0;e<=a.length;e++)r[e]=$.Deferred(),MY_API.CONFIG.ANCHOR_WAIT_REPLY||r[e].resolve();r[0].resolve();for(let e=0;e<a.length;e++)r[e].then(()=>{let t=$.Deferred();setTimeout(()=>t.resolve(),MY_API.CONFIG.ANCHOR_INTERVAL),t.then(()=>{BAPI.relation.modify(a[e],2).then(t=>{MYDEBUG(`API.relation.modify ${a[e]}, 2`,t),0===t.code?(window.toast(`[å¤©é€‰æ—¶åˆ»å–å…³UPä¸»] å–å…³UP(uid = ${a[e]})æˆåŠŸ`,"success"),r[e+1].resolve()):(window.toast(`[å¤©é€‰æ—¶åˆ»å–å…³UPä¸»] å–å…³UP(uid = ${a[e]})å‡ºé”™  ${t.message}`,"error"),r[e+1].reject())},()=>(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] å–æ¶ˆå…³æ³¨å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>o())))})});return $.when(...r)}return 1===e?function e(t,i){return BAPI.relation.getFollowings(Live_info.uid,t,i).then(n=>{MYDEBUG(`delAnchorFollowing API.relation.getFollowings(${t}, ${i})`,n);let o=$.Deferred();if(0===n.code){o.resolve();const a=n.data.total;for(const e of n.data.list)MY_API.AnchorLottery.unfollowList.push(String(e.mid));return a-MY_API.AnchorLottery.unfollowList.length>0?$.when(e(t+1,i),o):o}return window.toast("[å–å…³ä¸åœ¨ç™½åå•å†…çš„UPä¸»] è·å–å…³æ³¨åˆ—è¡¨å‡ºé”™ "+n.message,"error"),o.reject()},()=>(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] è·å–å…³æ³¨åˆ—è¡¨å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>e(t,i))))}(t,i).then(()=>o(1,MY_API.AnchorLottery.unfollowList).then(()=>{unFollowBtnClickable=!0})):2===e?n(Live_info.uid,MY_API.AnchorLottery.anchorFollowTagid).then(()=>o(2,MY_API.AnchorLottery.uidInTagList).then(()=>{unFollowBtnClickable=!0})):3===e?n(Live_info.uid,MY_API.AnchorLottery.anchorPrizeTagid).then(()=>o(2,MY_API.AnchorLottery.uidInTagList).then(()=>{unFollowBtnClickable=!0})):void 0},getRoomList:async()=>{let e=await BAPI.room.getList().then(e=>(MYDEBUG("ç›´æ’­é—´åˆ—è¡¨",e),e.data),()=>(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] è·å–å„åˆ†åŒºçš„æˆ¿é—´å·å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.AnchorLottery.getRoomList())));const t=JSON.parse(localStorage.getItem(NAME+"AnchorRoomidList"))||{list:[]};MY_API.AnchorLottery.roomidList=[...t.list];const i=async()=>{for(const t of e)await BAPI.rankdb.getTopRealTimeHour(t.id).then(e=>{if(MYDEBUG(`API.rankdb.getTopRealTimeHour(${t.id})`,e),0===e.code){const i=e.data.list;MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] è·å–${t.name+"å°æ—¶æ¦œ"}çš„ç›´æ’­é—´`,"info"),MYDEBUG(`[å¤©é€‰æ—¶åˆ»] è·å–${t.name+"å°æ—¶æ¦œ"}æˆ¿é—´åˆ—è¡¨`,e);for(const e of i)-1===MY_API.AnchorLottery.roomidList.indexOf(e.roomid)&&MY_API.AnchorLottery.roomidList.unshift(e.roomid)}else MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] è·å–${t.name+"å°æ—¶æ¦œ"}çš„ç›´æ’­é—´å‡ºé”™<br>${e.message}`,"warning")},()=>(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] è·å–å°æ—¶æ¦œç›´æ’­é—´å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ",error),delayCall(()=>i()))),await sleep(MY_API.CONFIG.ANCHOR_INTERVAL)},n=async()=>{for(const t of e)await BAPI.room.getRoomList(t.id,0,0,1,50).then(e=>{if(MYDEBUG(`API.room.getRoomList(${t.id}, 0, 0, 1, 50)`,e),0===e.code){const i=e.data.list;MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] è·å–${t.name+"åˆ†åŒº"}çš„ç›´æ’­é—´`,"info"),MYDEBUG(`[å¤©é€‰æ—¶åˆ»] è·å–${t.name+"åˆ†åŒº"}æˆ¿é—´åˆ—è¡¨`,e);for(const e of i)-1===MY_API.AnchorLottery.roomidList.indexOf(e.roomid)&&MY_API.AnchorLottery.roomidList.unshift(e.roomid)}else MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] è·å–${t.name+"åˆ†åŒº"}çš„ç›´æ’­é—´å‡ºé”™<br>${e.message}`,"warning")},()=>(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] è·å–åˆ†åŒºç›´æ’­é—´å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>n()))),await sleep(MY_API.CONFIG.ANCHOR_INTERVAL)};return i().then(async()=>(await n(),MY_API.AnchorLottery.roomidList.length>MY_API.CONFIG.ANCHOR_MAXROOM&&(MY_API.AnchorLottery.roomidList=MY_API.AnchorLottery.roomidList.splice(0,MY_API.CONFIG.ANCHOR_MAXROOM)),localStorage.setItem(NAME+"AnchorRoomidList",JSON.stringify({list:MY_API.AnchorLottery.roomidList})),$.Deferred().resolve()))},uploadRoomList:async()=>{let e=void 0,t=$.Deferred();if(0===MY_API.AnchorLottery.lotteryResponseList.length){let t;await BAPI.room.getRoomBaseInfo(MY_API.CONFIG.ANCHOR_GETDATA_ROOM).then(t=>{MYDEBUG(`API.room.getRoomBaseInfo(${MY_API.CONFIG.ANCHOR_GETDATA_ROOM})`,t),0===t.code?e=t.data.by_room_ids[MY_API.CONFIG.ANCHOR_GETDATA_ROOM].description:MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] è·å–ç›´æ’­é—´ä¸ªäººç®€ä»‹é”™è¯¯ "+t.message,"error")},()=>{MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] è·å–ç›´æ’­é—´ä¸ªäººç®€ä»‹å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error")});try{if(void 0===e)throw"undefined";t=JSON.parse(Base64.decode64(e.replaceAll("-",""))),"object"==typeof t&&t||(t=void 0)}catch(e){t=void 0}if(void 0!==t){for(const e of t.roomList)MY_API.AnchorLottery.lotteryResponseList.push(e);MY_API.AnchorLottery.oldLotteryResponseList=[...MY_API.AnchorLottery.lotteryResponseList]}}if(MY_API.AnchorLottery.oldLotteryResponseList.length===MY_API.AnchorLottery.lotteryResponseList.length)return setTimeout(()=>MY_API.AnchorLottery.uploadRoomList(),1e3*MY_API.CONFIG.ANCHOR_UPLOAD_DATA_INTERVAL);if(0===MY_API.AnchorLottery.myLiveRoomid&&await BAPI.room.getRoomInfoOld(Live_info.uid).then(e=>{if(MYDEBUG(`API.room.getRoomInfoOld(${Live_info.uid})`,e),0!==e.code)return MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] è·å–ç›´æ’­é—´ä¿¡æ¯å‡ºé”™ "+e.data.message,"error"),t.reject();MY_API.AnchorLottery.myLiveRoomid=e.data.roomid},()=>(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] è·å–ç›´æ’­é—´ä¿¡æ¯å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.AnchorLottery.uploadRoomList()))),0===MY_API.AnchorLottery.myLiveRoomid)return MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] è¯·å…ˆå¼€é€šç›´æ’­é—´å†ä½¿ç”¨ä¸Šä¼ æ•°æ®çš„åŠŸèƒ½","warning"),t.reject();MY_API.AnchorLottery.lotteryResponseList.length>MY_API.CONFIG.ANCHOR_MAXLIVEROOM_SAVE&&(MY_API.AnchorLottery.lotteryResponseList=MY_API.AnchorLottery.lotteryResponseList.splice(0,MY_API.CONFIG.ANCHOR_MAXLIVEROOM_SAVE));let i={roomList:MY_API.AnchorLottery.lotteryResponseList,ts:ts_ms()};const n=Base64.encode64(JSON.stringify(i));let o="";for(let e=0;e<n.length;e++)o+=n[e]+(e===n.length-1?"":"-");return(a=MY_API.AnchorLottery.myLiveRoomid,r=o,BAPI.room.update(a,r).then(e=>(MYDEBUG("BAPI.room.update MY_API.AnchorLottery.myLiveRoomid encode64(uploadRawStr)",e),0==e.code?(MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] æˆ¿é—´åˆ—è¡¨ä¸Šä¼ æˆåŠŸï¼ˆå…±${MY_API.AnchorLottery.lotteryResponseList.length}ä¸ªæˆ¿é—´ï¼‰`,"success"),MY_API.AnchorLottery.oldLotteryResponseList=[...MY_API.AnchorLottery.lotteryResponseList],t.resolve()):1===e.code?"å‡ºé”™å•¦ï¼Œå†è¯•è¯•å§"===e.message?(MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] ä¸Šä¼ å¤±è´¥ï¼Œ${MY_API.CONFIG.ANCHOR_UPLOAD_DATA_INTERVAL}ç§’åå†æ¬¡å°è¯•`,"warning"),t.resolve()):"ç®€ä»‹å†…å®¹è¿‡é•¿"===e.message?(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] ä¸Šä¼ å¤±è´¥ï¼Œå†…å®¹è¿‡é•¿ï¼Œæ¸…ç©ºæ•°æ®","warning"),MY_API.AnchorLottery.lotteryResponseList=[],MY_API.AnchorLottery.oldLotteryResponseList=[],t.resolve()):"æ‚¨æ‰€å¡«å†™çš„ç®€ä»‹å¯èƒ½æ¶‰åŠä¸ç¬¦åˆç›¸å…³æ³•å¾‹æ³•è§„å’Œæ”¿ç­–çš„å†…å®¹ï¼Œè¯·ä¿®æ”¹"===e.message?(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] ä¸Šä¼ å¤±è´¥ï¼Œ"+e.message,"warning"),MY_API.AnchorLottery.oldLotteryResponseList=[...MY_API.AnchorLottery.lotteryResponseList],t.resolve()):(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] ä¸Šä¼ å¤±è´¥ "+e.message,"warning"),t.reject()):(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] æˆ¿é—´åˆ—è¡¨ä¸Šä¼ å¤±è´¥ "+e.message,"error"),t.reject())),()=>(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] æˆ¿é—´åˆ—è¡¨ä¸Šä¼ å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.AnchorLottery.uploadRoomList())))).then(()=>setTimeout(()=>MY_API.AnchorLottery.uploadRoomList(),1e3*MY_API.CONFIG.ANCHOR_UPLOAD_DATA_INTERVAL));var a,r},getLotteryInfoFromRoom:async()=>{let e,t=void 0;await BAPI.room.getRoomBaseInfo(MY_API.CONFIG.ANCHOR_GETDATA_ROOM).then(e=>{MYDEBUG(`API.room.getRoomBaseInfo(${MY_API.CONFIG.ANCHOR_GETDATA_ROOM})`,e),0===e.code?t=e.data.by_room_ids[MY_API.CONFIG.ANCHOR_GETDATA_ROOM].description:MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] è·å–ç›´æ’­é—´ä¸ªäººç®€ä»‹é”™è¯¯ "+e.message,"error")},()=>{MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] è·å–ç›´æ’­é—´ä¸ªäººç®€ä»‹å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error")});try{if(void 0===t)throw"undefined";if(e=JSON.parse(Base64.decode64(t.replaceAll("-",""))),"object"!=typeof e||!e)throw"Not a JSON"}catch(e){return MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] ç›´æ’­é—´${MY_API.CONFIG.ANCHOR_GETDATA_ROOM}ä¸ªäººç®€ä»‹çš„æ•°æ®æ ¼å¼ä¸ç¬¦åˆè¦æ±‚ `+e,"error"),setTimeout(()=>MY_API.AnchorLottery.getLotteryInfoFromRoom(),6e4*MY_API.CONFIG.ANCHOR_CHECK_INTERVAL)}MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] å¼€å§‹æ£€æŸ¥å¤©é€‰ï¼ˆå…±${e.roomList.length}ä¸ªæˆ¿é—´ï¼‰<br>æ•°æ®æ¥æºï¼šç›´æ’­é—´${linkMsg(MY_API.CONFIG.ANCHOR_GETDATA_ROOM,liveRoomUrl+MY_API.CONFIG.ANCHOR_GETDATA_ROOM)}çš„ä¸ªäººç®€ä»‹<br>è¯¥æ•°æ®æœ€åä¸Šä¼ æ—¶é—´ï¼š${new Date(e.ts).toLocaleString()}`,"success");for(const t of e.roomList){let e=$.Deferred();MY_API.CONFIG.ANCHOR_WAIT_REPLY||e.resolve(),MY_API.AnchorLottery.check(t).then(i=>{if(i[0])return MY_API.AnchorLottery.pwdCheck(t).then(t=>{if(!t)return MY_API.AnchorLottery.join(i).then(()=>e.resolve());MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] å¿½ç•¥åŠ å¯†ç›´æ’­é—´çš„å¤©é€‰<br>roomid = ${linkMsg(t[3],liveRoomUrl+t[3])}, id = ${t[0]}<br>${0===t[8]?"":"æ‰€éœ€é‡‘ç“œå­ï¼š"+t[8]+"<br>"}å¥–å“ï¼š${t[4]}<br>${MY_API.AnchorLottery.countDown(t[5])}`,"warning"),e.resolve()});e.resolve()}),await e,await sleep(MY_API.CONFIG.ANCHOR_INTERVAL)}return MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] æœ¬æ¬¡æ£€æŸ¥ç»“æŸ<br>${MY_API.CONFIG.ANCHOR_CHECK_INTERVAL}åˆ†é’Ÿåå†æ¬¡æ£€æŸ¥å¤©é€‰`,"success"),MY_API.CACHE.AnchorLottery_TS=ts_ms(),MY_API.saveCache(),setTimeout(()=>MY_API.AnchorLottery.getLotteryInfoFromRoom(),6e4*MY_API.CONFIG.ANCHOR_CHECK_INTERVAL)},moneyCheck:e=>{const t=e.replaceAll(" ","").toLowerCase(),i=t.match(/\d+(\.\d+)?/g),n=t.match(/([ä¸€äºŒä¸¤ä¸‰å››äº”å…­ä¸ƒå…«ä¹å]åƒé›¶?[ä¸€äºŒä¸¤ä¸‰å››äº”å…­ä¸ƒå…«ä¹å]?ç™¾?[ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹å]?å?[ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹å]?)|([ä¸€äºŒä¸¤ä¸‰å››äº”å…­ä¸ƒå…«ä¹å]ç™¾[ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹å]?å?[ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹å]?)|([ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹å]?å[ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹å])|[ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹å]/g),o={"é›¶":0,"ä¸€":1,"äºŒ":2,"ä¸‰":3,"å››":4,"äº”":5,"å…­":6,"ä¸ƒ":7,"å…«":8,"ä¹":9},a={"å":{value:10,secUnit:!1},"ç™¾":{value:100,secUnit:!1},"åƒ":{value:1e3,secUnit:!1},"ä¸‡":{value:1e4,secUnit:!0},"äº¿":{value:1e8,secUnit:!0}};if(null!==n&&null===i)return r();if(null===n&&null!==i)return l();if(null!==n&&null!==i){let e=l();return e[0]?e:r()}return[!1];function r(){let e=[];for(const i of n)e.push(_(t,i,e));for(let i=0;i<n.length;i++){const o=n[i];if(void 0!==o){const a=d(o),r=e[i],l=o.length,_=e[i+1];let c="";for(let e=r+l;e<t.length;e++)void 0!==_?e<_&&(c+=t[e]):c+=t[e];let A=s(a,c);if(void 0===A){if(i===n.length-1)return[!1];continue}return[!0,A]}}}function l(){let e=[];for(const n of i)e.push(_(t,n,e));for(let n=0;n<i.length;n++){const o=i[n],a=t.indexOf(o),r=o.length,l=e[n+1];let d="";for(let e=a+r;e<t.length;e++)void 0!==l?e<l&&(d+=t[e]):d+=t[e];let _=s(o,d);if(void 0!==_)return[!0,_];if(n===i.length-1)return[!1]}}function s(e,t){const i=["å…ƒ","r","å—"],n=["rmb","cny","äººæ°‘å¸","è½¯å¦¹å¸","å¾®ä¿¡çº¢åŒ…","çº¢åŒ…","qqçº¢åŒ…"],o=["æ¯›","è§’"],a=["åˆ†"],r=["é‡‘ç“œå­"],l=t[0];let s=void 0;const d=Number(e);for(const e of n)if(t.indexOf(e)>-1){s=d;break}for(const e of r)if(t.indexOf(e)>-1){s=.001*d;break}if(void 0===s)if(i.indexOf(l)>-1)s=d;else if(o.indexOf(l)>-1)s=.1*d;else if(a.indexOf(l)>-1){const e=["åˆ†é’Ÿ"];for(const i of e)if(0===t.indexOf(i))return;s=.01*d}return s}function d(e){let t=0,i=0,n=0,r=!1,l=("å"===e[0]?"ä¸€"+e:e).split("");for(let e=0;e<l.length;e++){let s=o[l[e]];if(void 0!==s)n=s,e===l.length-1&&(i+=n);else{if(!a.hasOwnProperty(l[e]))return;let o=a[l[e]].value;r=a[l[e]].secUnit,r?(i=(i+n)*o,t+=i,i=0):i+=n*o,n=0}}return t+i}function _(e,t,i,n=0,o=0){let a=e.indexOf(t,n),r=i.indexOf(a,o);return r>-1?_(e,t,i,a+1,r+1):a}},check:(roomid,add=!0)=>BAPI.xlive.anchor.check(roomid).then(response=>{if(MYDEBUG(`API.xlive.anchor.check(${roomid}) response`,response),0!==response.code||!response.data)return[!1];{if(0===response.data.time)return MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] å¿½ç•¥è¿‡æœŸå¤©é€‰<br>roomid = ${linkMsg(roomid,liveRoomUrl+roomid)}, id = ${response.data.id}`,"info"),[!1];add&&-1===MY_API.AnchorLottery.lotteryResponseList.indexOf(response.data.room_id)&&MY_API.AnchorLottery.lotteryResponseList.unshift(response.data.room_id);const joinPrice=response.data.gift_num*response.data.gift_price,joinTextTitle=`${NAME}_ANCHOR_${response.data.id}`,ts=ts_ms();let defaultJoinData=[response.data.id,0===joinPrice?void 0:response.data.gift_id,0===joinPrice?void 0:response.data.gift_num,roomid,response.data.award_name,response.data.time,response.data.require_type,void 0,joinPrice],joinText=`<div class = "clickableText" title = "${joinTextTitle}" ts = "${ts}">ç‚¹å‡»å‚åŠ </div>`;function joinAnchorListener(){let e=$('div[title="'+joinTextTitle+'"][ts="'+ts+'"]'),t=setTimeout(()=>e.remove(),1e3*response.data.time);e.click(()=>{BAPI.xlive.anchor.randTime(response.data.id).then(e=>{MYDEBUG("API.xlive.anchor.randTime "+response.data.id,e),0===response.code?defaultJoinData[5]=e.data.time:defaultJoinData[5]=void 0,MY_API.AnchorLottery.join(defaultJoinData);let i=$('div[title="'+joinTextTitle+'"]');i.unbind("click"),i.remove(),clearTimeout(t)})})}if(MY_API.CONFIG.ANCHOR_IGNORE_BLACKLIST)for(const str of MY_API.CONFIG.ANCHOR_BLACKLIST_WORD)if("/"!=str.charAt(0)&&"/"!=str.charAt(str.length-1)){if(response.data.award_name.toLowerCase().indexOf(str.toLowerCase())>-1)return MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] å¿½ç•¥å­˜ç–‘å¤©é€‰<br>roomid = ${linkMsg(roomid,liveRoomUrl+roomid)}, id = ${response.data.id}<br>å¥–å“åï¼š${response.data.award_name}<br>å«æœ‰å…³é”®å­—ï¼š${str}<br>${0===joinPrice?"æ— éœ€é‡‘ç“œå­":"æ‰€éœ€é‡‘ç“œå­ï¼š"+joinPrice}<br>${MY_API.AnchorLottery.countDown(response.data.time)}${joinText}`,"warning"),joinAnchorListener(),[!1]}else{let reg=eval(str);if(reg.test(response.data.award_name))return MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] å¿½ç•¥å­˜ç–‘å¤©é€‰<br>roomid = ${linkMsg(roomid,liveRoomUrl+roomid)}, id = ${response.data.id}<br>å¥–å“åï¼š${response.data.award_name}<br>åŒ¹é…æ­£åˆ™ï¼š${str}<br>${0===joinPrice?"æ— éœ€é‡‘ç“œå­":"æ‰€éœ€é‡‘ç“œå­ï¼š"+joinPrice}<br>${MY_API.AnchorLottery.countDown(response.data.time)}${joinText}`,"warning"),joinAnchorListener(),[!1]}const moneyCheckReturnArray=MY_API.AnchorLottery.moneyCheck(response.data.award_name);if(moneyCheckReturnArray[0]&&moneyCheckReturnArray[1]<MY_API.CONFIG.ANCHOR_IGNORE_MONEY)return MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] å¿½ç•¥é‡‘é¢å°äº${MY_API.CONFIG.ANCHOR_IGNORE_MONEY}å…ƒçš„å¤©é€‰<br>roomid = ${linkMsg(roomid,liveRoomUrl+roomid)}, id = ${response.data.id}<br>å¥–å“åï¼š${response.data.award_name}<br>è¯†åˆ«åˆ°çš„é‡‘é¢ï¼š${moneyCheckReturnArray[1]}å…ƒ<br>${0===joinPrice?"æ— éœ€é‡‘ç“œå­":"æ‰€éœ€é‡‘ç“œå­ï¼š"+joinPrice}<br>${MY_API.AnchorLottery.countDown(response.data.time)}${joinText}`,"warning"),joinAnchorListener(),[!1];if(2===response.data.status)return MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] å¿½ç•¥å·²å‚åŠ å¤©é€‰<br>roomid = ${linkMsg(roomid,liveRoomUrl+roomid)}, id = ${response.data.id}<br>å¥–å“åï¼š${response.data.award_name}<br>`,"info"),[!1];if(joinPrice>MY_API.CONFIG.AHCHOR_NEED_GOLD)return MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] å¿½ç•¥ä»˜è´¹å¤©é€‰<br>roomid = ${linkMsg(roomid,liveRoomUrl+roomid)}, id = ${response.data.id}<br>å¥–å“åï¼š${response.data.award_name}<br>${0===joinPrice?"æ— éœ€é‡‘ç“œå­":"æ‰€éœ€é‡‘ç“œå­ï¼š"+joinPrice}<br>${MY_API.AnchorLottery.countDown(response.data.time)}${joinText}`,"warning"),joinAnchorListener(),[!1];switch(response.data.require_type){case 1:return defaultJoinData;case 2:return BAPI.live_user.get_anchor_in_room(roomid).then(e=>{if(MYDEBUG(`API.live_user.get_anchor_in_room(${roomid})`,e),e.data){let t=e.data.info.uid;for(const e of MY_API.AnchorLottery.medal_list)if(e.target_id===t)return e.level<response.data.require_value?(MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] å¿½ç•¥ç²‰ä¸å‹‹ç« ç­‰çº§ä¸è¶³çš„å¤©é€‰<br>roomid = ${linkMsg(roomid,liveRoomUrl+roomid)}, id = ${response.data.id}<br>å¥–å“åï¼š${response.data.award_name}<br>æ‰€éœ€å‹‹ç« ç­‰çº§ï¼š${response.data.require_value}<br>ä½ çš„å‹‹ç« ç­‰çº§ï¼š${e.level}<br>${MY_API.AnchorLottery.countDown(response.data.time)}`,"warning"),[!1]):defaultJoinData;return MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] å¿½ç•¥æœ‰ç²‰ä¸å‹‹ç« è¦æ±‚çš„å¤©é€‰<br>roomid = ${linkMsg(roomid,liveRoomUrl+roomid)}, id = ${response.data.id}<br>å¥–å“åï¼š${response.data.award_name}<br>æ‰€éœ€å‹‹ç« ç­‰çº§ï¼š${response.data.require_value}<br>ä½ æ²¡æœ‰è¯¥å‹‹ç« <br>${MY_API.AnchorLottery.countDown(response.data.time)}`,"warning"),[!1]}return[!1]});case 3:return BAPI.xlive.getInfoByUser(roomid).then(e=>{if(MYDEBUG("API.xlive.getInfoByUser "+roomid,e),0===e.code){const i=e.data.privilege.privilege_type;if(0!==i&&i<=response.data.require_value)return defaultJoinData;{function t(e){switch(e){case 0:return"æ— ";case 1:return"æ€»ç£";case 2:return"æç£";case 3:return"èˆ°é•¿";default:return"æœªçŸ¥"}}const e=t(response.data.require_value),n=t(i);return MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] å¿½ç•¥å¤§èˆªæµ·ç­‰çº§ä¸è¶³çš„å¤©é€‰<br>roomid = ${linkMsg(roomid,liveRoomUrl+roomid)}, id = ${response.data.id}<br>å¥–å“åï¼š${response.data.award_name}<br>æ‰€éœ€å¤§èˆªæµ·ç­‰çº§ï¼š${e}<br>ä½ çš„å¤§èˆªæµ·ç­‰çº§ï¼š${n}<br>${MY_API.AnchorLottery.countDown(response.data.time)}`,"warning"),[!1]}}return[!1]});case 4:if(Live_info.user_level>=response.data.require_value)return defaultJoinData;MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] å¿½ç•¥ç›´æ’­ç­‰çº§ä¸è¶³çš„å¤©é€‰<br>roomid = ${linkMsg(roomid,liveRoomUrl+roomid)}, id = ${response.data.id}<br>å¥–å“åï¼š${response.data.award_name}<br>æ‰€éœ€ç›´æ’­ç­‰çº§ï¼š${response.data.require_value}<br>ä½ çš„ç›´æ’­ç­‰çº§ï¼šUL.${Live_info.user_level}<br>${MY_API.AnchorLottery.countDown(response.data.time)}`,"warning");case 5:if(Live_info.level>=response.data.require_value)return defaultJoinData;MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] å¿½ç•¥ä¸»ç«™ç­‰çº§ä¸è¶³çš„å¤©é€‰<br>roomid = ${linkMsg(roomid,liveRoomUrl+roomid)}, id = ${response.data.id}<br>å¥–å“åï¼š${response.data.award_name}<br>æ‰€éœ€ç›´æ’­ç­‰çº§ï¼š${response.data.require_value}<br>ä½ çš„ä¸»ç«™ç­‰çº§ï¼šLv${Live_info.level}<br>${MY_API.AnchorLottery.countDown(response.data.time)}`,"warning");default:MYDEBUG("[å¤©é€‰æ—¶åˆ»] æœªè¢«æ”¶å½•çš„ç±»å‹ require_value = "+response.data.require_value,response);break}}},()=>(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] å¤©é€‰æ£€æŸ¥å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.AnchorLottery.check(roomid)))),reCheck:e=>BAPI.xlive.anchor.check(e[3]).then(t=>{if(MYDEBUG(`API.xlive.anchor.reCheck(${e[3]}) response`,t),0===t.code&&t.data&&t.data.hasOwnProperty("award_users")&&t.data.award_users){let i=e[7],n=!1;for(const e of t.data.award_users)if(e.uid===Live_info.uid){n=!0;break}if(n){if(MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] å¤©é€‰æ—¶åˆ»<br>roomid = ${linkMsg(e[3],liveRoomUrl+e[3])}, id = ${e[0]}ä¸­å¥–<br>å¥–å“ï¼š${e[4]}<br>`,"prize"),winPrizeNum++,winPrizeTotalCount++,JQlogRedPoint.text(winPrizeNum),JQlogRedPoint.is(":hidden")&&JQlogRedPoint.show(),MY_API.CONFIG.ANCHOR_PRIVATE_LETTER){const e={sender_uid:Live_info.uid,receiver_id:i,receiver_type:1,msg_type:1,msg_status:0,content:'{"content":"'+MY_API.CONFIG.ANCHOR_LETTER_CONTENT+'"}',dev_id:getMsgDevId()};setTimeout(()=>{BAPI.sendMsg(e).then(t=>{MYDEBUG("API.sendMsg "+e,t),0===t.code?window.toast(`[å¤©é€‰è‡ªåŠ¨ç§ä¿¡] ç§ä¿¡UP(uid = ${i})æˆåŠŸ`,"success"):window.toast(`[å¤©é€‰è‡ªåŠ¨ç§ä¿¡] ç§ä¿¡UP(uid = ${i})å¤±è´¥ ${t.message}`,"error")},()=>{MY_API.chatLog(`[å¤©é€‰è‡ªåŠ¨ç§ä¿¡] ç§ä¿¡UP(uid = ${i})å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ`)})},8e3)}if(MY_API.CONFIG.ANCHOR_MOVETO_PRIZE_TAG&&BAPI.relation.addUsers(i,MY_API.AnchorLottery.anchorPrizeTagid).then(e=>{MYDEBUG(`API.relation.addUsers ${i} ${MY_API.AnchorLottery.anchorPrizeTagid}`,e),0===e.code?window.toast(`[å¤©é€‰æ—¶åˆ»] ç§»åŠ¨UPï¼ˆuid = ${i}ï¼‰è‡³åˆ†ç»„ã€${anchorPrizeTagName}ã€‘æˆåŠŸ`,"success"):window.toast(`[å¤©é€‰æ—¶åˆ»] ç§»åŠ¨UPï¼ˆuid = ${i}ï¼‰è‡³åˆ†ç»„ã€${anchorPrizeTagName}ã€‘å¤±è´¥ ${e.message}`,"warning")},()=>{MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] ç§»åŠ¨UPï¼ˆuid = ${i}ï¼‰åˆ°åˆ†ç»„ã€${anchorPrizeTagName}ã€‘å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ`)}),MY_API.CONFIG.FT_NOTICE){!function t(){return FT_sendMsg(MY_API.CONFIG.FT_SCKEY,`${GM_info.script.name} å¤©é€‰æ—¶åˆ»ä¸­å¥–é€šçŸ¥ ${(new Date).toLocaleString()}`,`###å¤©é€‰æ—¶åˆ»ä¸­å¥–\n###ä¸­å¥–è´¦å·idï¼š${Live_info.uname}\n###æˆ¿é—´å·roomid = ${e[3]}\n###ä¸»æ’­uid = ${i}\n###æŠ½å¥–id = ${e[0]}\n###è·å¾—å¥–å“ï¼š\n###${e[4]}\n###è¯·åŠæ—¶ç§ä¿¡ä¸»æ’­å‘æ”¾å¥–åŠ±`).then(e=>{MYDEBUG("FT_sendMsg response",e),0==e.body.errno?window.toast("[å¤©é€‰æ—¶åˆ»] æ–¹ç³–ä¸­å¥–æç¤ºå‘é€æˆåŠŸ","success"):window.toast("[å¤©é€‰æ—¶åˆ»] æ–¹ç³–ä¸­å¥–æç¤ºå‘é€å¤±è´¥ "+e.errmsg,"error")},()=>(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] æ–¹ç³–ä¸­å¥–æç¤ºå‘é€å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>t())))}()}if(MY_API.CONFIG.GM_NOTICE&&GM_notice("å¤©é€‰æ—¶åˆ»ä¸­å¥–",`æˆ¿é—´å·ï¼š${e[3]}ï¼Œå¥–å“ï¼š${e[4]}`),MY_API.CONFIG.ANCHOR_DANMU){const t=MY_API.CONFIG.ANCHOR_DANMU_CONTENT[Math.floor(Math.random()*MY_API.CONFIG.MEDAL_DANMU_CONTENT.length)];MY_API.AnchorLottery.sendDanmu(t,e[3])}if(MY_API.CONFIG.ANCHOR_ADD_TO_WHITELIST){let e=[...(JSON.parse(localStorage.getItem(NAME+"AnchorFollowingList"))||{list:[]}).list];e.push(String(i)),localStorage.setItem(NAME+"AnchorFollowingList",JSON.stringify({list:e})),window.toast(`[å¤©é€‰æ—¶åˆ»] å·²å°†UPï¼ˆuid = ${i}ï¼‰æ·»åŠ è‡³ç™½åå•`,"success")}}else if(MY_API.CONFIG.ANCHOR_AUTO_DEL_FOLLOW){if(-1===[...(JSON.parse(localStorage.getItem(NAME+"AnchorFollowingList"))||{list:[]}).list].indexOf(String(i))&&-1===MY_API.AnchorLottery.uidInOriginTag.indexOf(String(i)))return BAPI.relation.modify(i,2).then(e=>{MYDEBUG("API.relation.modify response.info.uid, 2",e),0===e.code?window.toast(`[å¤©é€‰è‡ªåŠ¨å–å…³] å–å…³UP(uid = ${i})æˆåŠŸ`,"success"):window.toast(`[å¤©é€‰è‡ªåŠ¨å–å…³] å–å…³UP(uid = ${i})å‡ºé”™  ${e.message}`,"error")},()=>{MY_API.chatLog(`[å¤©é€‰è‡ªåŠ¨å–å…³] å–å…³UP(uid = ${i})å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ`)})}}},()=>(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] å¤©é€‰æ£€æŸ¥å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.AnchorLottery.check(roomid)))),sendDanmu:async(e,t)=>{let i=t;return Number(t)<=1e3&&(i=await BAPI.room.get_info(t).then(e=>(MYDEBUG(`API.room.get_info roomId=${t} res`,e),e.data.room_id))),BAPI.sendLiveDanmu(e,i).then(i=>{MYDEBUG(`[å¤©é€‰ä¸­å¥–å¼¹å¹•] å¼¹å¹•å‘é€å†…å®¹ã€${e}ã€‘ï¼Œæˆ¿é—´å·ã€${t}ã€‘`,i),0!==i.code||i.msg?window.toast(`[å¤©é€‰ä¸­å¥–å¼¹å¹•] å¼¹å¹•ã€${e}ã€‘ï¼ˆæˆ¿é—´å·ã€${t}ã€‘ï¼‰å‡ºé”™ ${i.msg}`,"caution"):window.toast(`[å¤©é€‰ä¸­å¥–å¼¹å¹•] å¼¹å¹•ã€${e}ã€‘å‘é€æˆåŠŸï¼ˆæˆ¿é—´å·ã€${t}ã€‘ï¼‰`,"success")},()=>(window.toast(`[å¤©é€‰ä¸­å¥–å¼¹å¹•] å¼¹å¹•ã€${e}ã€‘ï¼ˆæˆ¿é—´å·ã€${t}ã€‘ï¼‰å‘é€å¤±è´¥`,"error"),$.Deferred().reject()))},countDown:(e,t="#da4939")=>void 0!==e?`<span id="time" style="color:${t};">è·å¼€å¥–è¿˜æœ‰<span class = 'num'>${e}</span>ç§’</span>`:"",pwdCheck:(e,t="")=>BAPI.room.verify_room_pwd(e,t).then(i=>(MYDEBUG(`API.room.verify_room_pwd(${e}, ${t})`,i),-1===i.code||0!==i.code),()=>{MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] ç›´æ’­é—´åŠ å¯†æ£€æŸ¥å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error")}),join:e=>BAPI.xlive.anchor.join(e[0],e[1],e[2]).then(t=>(MYDEBUG(`API.xlive.anchor.join(${e[0]}) response`,t),0===t.code?(MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] æˆåŠŸå‚åŠ å¤©é€‰<br>roomid = ${linkMsg(e[3],liveRoomUrl+e[3])}, id = ${e[0]}<br>${0===e[8]?"":"èŠ±è´¹é‡‘ç“œå­ï¼š"+e[8]+"<br>"}å¥–å“ï¼š${e[4]}<br>${MY_API.AnchorLottery.countDown(e[5])}`,"success"),MY_API.AnchorLottery.waitForRecheckList.push(e[3]),BAPI.live_user.get_anchor_in_room(e[3]).then(t=>{if(MYDEBUG(`API.live_user.get_anchor_in_room(${e[3]})`,t),0===t.code){if(MY_API.addAnchor(),e[7]=t.data.info.uid,MYDEBUG("å¤©é€‰æ—¶åˆ»join data",e),1===e[6]&&MY_API.CONFIG.ANCHOR_MOVETO_FOLLOW_TAG){if(MY_API.AnchorLottery.uidInOriginTag.indexOf(String(e[7]))>-1)return;setTimeout(()=>{BAPI.relation.addUsers(t.data.info.uid,MY_API.AnchorLottery.anchorFollowTagid).then(e=>{MYDEBUG(`API.relation.addUsers ${t.data.info.uid} ${MY_API.AnchorLottery.anchorFollowTagid}`,e),0===e.code?window.toast(`[å¤©é€‰æ—¶åˆ»] ç§»åŠ¨UPï¼ˆuid = ${t.data.info.uid}ï¼‰è‡³åˆ†ç»„ã€${anchorFollowTagName}ã€‘æˆåŠŸ`,"success"):window.toast(`[å¤©é€‰æ—¶åˆ»] ç§»åŠ¨UPï¼ˆuid = ${t.data.info.uid}ï¼‰è‡³åˆ†ç»„ã€${anchorFollowTagName}ã€‘å¤±è´¥ ${e.message}`,"warning")},()=>{MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] ç§»åŠ¨UPï¼ˆuid = ${t.data.info.uid}ï¼‰åˆ°åˆ†ç»„ã€${anchorFollowTagName}ã€‘å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ`)})},4e3)}return setTimeout(()=>MY_API.AnchorLottery.reCheck(e),1e3*e[5]+1500)}})):500===t.code?(MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] å¤©é€‰å‚åŠ å¤±è´¥<br>roomid = ${linkMsg(e[3],liveRoomUrl+e[3])}, id = ${e[0]}<br>å¥–å“ï¼š${e[4]}<br>${t.msg}<br>3ç§’åå†æ¬¡å°è¯•å‚åŠ `,"warning"),setTimeout(()=>MY_API.AnchorLottery.join(e),3e3)):MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] å¤©é€‰å‚åŠ å¤±è´¥<br>roomid = ${linkMsg(e[3],liveRoomUrl+e[3])}, id = ${e[0]}<br>å¥–å“ï¼š${e[4]}<br>${t.msg}`,"warning")),()=>(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] å¤©é€‰å‚åŠ å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error"),delayCall(()=>MY_API.AnchorLottery.join(e)))),run:async()=>{if(!MY_API.CONFIG.ANCHOR_LOTTERY)return $.Deferred().resolve();const e=6e4*MY_API.CONFIG.ANCHOR_CHECK_INTERVAL;function t(e){if(MY_API.CONFIG.TIME_AREA_DISABLE&&inTimeArea(MY_API.CONFIG.TIME_AREA_START_H0UR,MY_API.CONFIG.TIME_AREA_END_H0UR,MY_API.CONFIG.TIME_AREA_START_MINUTE,MY_API.CONFIG.TIME_AREA_END_MINUTE)){const t=getIntervalTime(MY_API.CONFIG.TIME_AREA_END_H0UR,MY_API.CONFIG.TIME_AREA_END_MINUTE);return MYDEBUG("[å¤©é€‰æ—¶åˆ»]",`å¤„äºä¼‘çœ æ—¶æ®µï¼Œ${t}æ¯«ç§’åå†æ¬¡æ£€æŸ¥å¤©é€‰`),MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] å¤„äºä¼‘çœ æ—¶æ®µï¼Œå°†ä¼šåœ¨<br>${new Date(ts_ms()+t).toLocaleString()}<br>ç»“æŸä¼‘çœ å¹¶ç»§ç»­æ£€æŸ¥å¤©é€‰`,"warning"),setTimeout(()=>e(),t)}{const t=ts_ms()-MY_API.CACHE.AnchorLottery_TS,i=t>=6e4*MY_API.CONFIG.ANCHOR_CHECK_INTERVAL?0:t;return MYDEBUG("[å¤©é€‰æ—¶åˆ»]",`å°†åœ¨${i}æ¯«ç§’åå†æ¬¡æ£€æŸ¥å¤©é€‰`),setTimeout(()=>e(),i)}}if(MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] å¼€å§‹è·å–ç²‰ä¸å‹‹ç« ä¿¡æ¯"),await MY_API.AnchorLottery.getMedalList(),MY_API.chatLog("[å¤©é€‰æ—¶åˆ»] å¼€å§‹è·å–å…³æ³¨åˆ†ç»„ä¿¡æ¯"),(MY_API.CONFIG.ANCHOR_MOVETO_FOLLOW_TAG||MY_API.CONFIG.ANCHOR_MOVETO_PRIZE_TAG)&&await MY_API.AnchorLottery.getTag([anchorFollowTagName,anchorPrizeTagName]),await MY_API.AnchorLottery.getUpInOriginTag(Live_info.uid),"ANCHOR_POLLING"==MY_API.CONFIG.ANCHOR_TYPE){async function i(){await MY_API.AnchorLottery.getRoomList();const t=[...(JSON.parse(localStorage.getItem(NAME+"AnchorRoomidList"))||{list:[]}).list];MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] å¼€å§‹æ£€æŸ¥å¤©é€‰ï¼ˆå…±${t.length}ä¸ªæˆ¿é—´ï¼‰`,"success");for(const e of t){let t=$.Deferred();MY_API.CONFIG.ANCHOR_WAIT_REPLY||t.resolve(),MY_API.AnchorLottery.check(e).then(i=>{if(i[0])return MY_API.AnchorLottery.pwdCheck(e).then(e=>{if(!e)return MY_API.AnchorLottery.join(i).then(()=>t.resolve());MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] å¿½ç•¥åŠ å¯†ç›´æ’­é—´çš„å¤©é€‰<br>roomid = ${linkMsg(e[3],liveRoomUrl+e[3])}, id = ${e[0]}<br>${0===e[8]?"":"æ‰€éœ€é‡‘ç“œå­ï¼š"+e[8]+"<br>"}å¥–å“ï¼š${e[4]}<br>${MY_API.AnchorLottery.countDown(e[5])}`,"warning"),t.resolve()});t.resolve()}),await t,await sleep(MY_API.CONFIG.ANCHOR_INTERVAL)}return MY_API.CACHE.AnchorLottery_TS=ts_ms(),MY_API.saveCache(),MY_API.chatLog(`[å¤©é€‰æ—¶åˆ»] æœ¬æ¬¡è½®è¯¢ç»“æŸ<br>${MY_API.CONFIG.ANCHOR_CHECK_INTERVAL}åˆ†é’Ÿåå†æ¬¡æ£€æŸ¥å¤©é€‰`,"success"),setTimeout(()=>i(),e)}return MY_API.CONFIG.ANCHOR_UPLOAD_DATA&&await MY_API.AnchorLottery.uploadRoomList(),t(()=>i())}return t(()=>MY_API.AnchorLottery.getLotteryInfoFromRoom())}}};MY_API.init().then(()=>{try{if(0===parseInt(Live_info.uid)||isNaN(parseInt(Live_info.uid)))return MY_API.chatLog("æœªç™»å½•ï¼Œè¯·å…ˆç™»å½•å†ä½¿ç”¨è„šæœ¬","warning");MY_API.newMessage(GM_info.script.version),MYDEBUG("MY_API.CONFIG",MY_API.CONFIG),StartPlunder(MY_API)}catch(e){console.error("åˆå§‹åŒ–é”™è¯¯",e)}})}async function StartPlunder(e){"use strict";fixVersionDifferences(e);let t=()=>{for(const t in e.GIFT_COUNT)"CLEAR_TS"!==t&&(e.GIFT_COUNT[t]=0);e.GIFT_COUNT.CLEAR_TS=ts_ms(),e.saveGiftCount(),$("#giftCount span:eq(0)").text(e.GIFT_COUNT.ANCHOR_COUNT),$("#giftCount span:eq(1)").text(e.GIFT_COUNT.MATERIAL_COUNT),MYDEBUG("å·²é‡ç½®ç»Ÿè®¡")};checkNewDay(e.GIFT_COUNT.CLEAR_TS)&&t(),runExactMidnight(()=>t(),"é‡ç½®ç»Ÿè®¡"),e.creatSetBox(),e.removeUnnecessary();let i=[...(JSON.parse(localStorage.getItem(NAME+"AnchorFollowingList"))||{list:[]}).list];if(0!==i.length&&"number"==typeof i[0]){for(let e=0;e<i.length;e++)i[e]=String(i[e]);localStorage.setItem(NAME+"AnchorFollowingList",JSON.stringify({list:i}))}if(setTimeout(()=>{e.MEDAL_DANMU.run(),e.GroupSign.run(),e.DailyReward.run(),e.LiveReward.run(),e.Exchange.runS2C()},5e3),setTimeout(()=>{e.AUTO_DANMU.run(),e.LITTLE_HEART.run(),e.Gift.run(),e.MaterialObject.run(),e.AnchorLottery.run()},6e3),e.CONFIG.LOTTERY){let t;if(await BAPI.room.getList().then(i=>{MYDEBUG("ç›´æ’­é—´åˆ—è¡¨",i),t=i.data;for(const t of i.data)BAPI.room.getRoomList(t.id,0,0,1,1).then(i=>{MYDEBUG("ç›´æ’­é—´åˆ—è¡¨",i);for(let n=0;n<i.data.list.length;++n)e.listen(i.data.list[n].roomid,Live_info.uid,t.name+"åŒº")},()=>{MY_API.chatLog("[ç¤¼ç‰©æŠ½å¥–] è·å–ç›´æ’­é—´åˆ—è¡¨å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error")})},()=>{MY_API.chatLog("[ç¤¼ç‰©æŠ½å¥–] è·å–å„åˆ†åŒºçš„æˆ¿é—´å·å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ","error")}),e.CONFIG.CHECK_HOUR_ROOM){let i=async()=>{if(e.blocked||e.max_blocked)return e.blocked?(e.chatLog("è¿›å…¥å°é»‘å±‹æ£€æŸ¥å°æ—¶æ¦œå·²åœæ­¢è¿è¡Œ"),void clearInterval(n)):void e.chatLog("è¾£æ¡å·²è¾¾åˆ°æœ€å¤§å€¼æ£€æŸ¥å°æ—¶æ¦œå·²åœæ­¢è¿è¡Œ");if(inTimeArea(e.CONFIG.TIME_AREA_START_H0UR,e.CONFIG.TIME_AREA_END_H0UR,e.CONFIG.TIME_AREA_START_MINUTE,e.CONFIG.TIME_AREA_END_MINUTE)&&e.CONFIG.TIME_AREA_DISABLE)e.chatLog("å½“å‰æ—¶é—´æ®µä¸æ£€æŸ¥å°æ—¶æ¦œç¤¼ç‰©","warning");else for(const i of t)await BAPI.rankdb.getTopRealTimeHour(i.id).then(t=>{let n=t.data.list;e.chatLog(`æ£€æŸ¥${i.name+"å°æ—¶æ¦œ"}æˆ¿é—´çš„ç¤¼ç‰©`,"warning");for(const t of n)e.checkRoom(t.roomid,`å°æ—¶æ¦œ-${t.area_v2_parent_name}åŒº`)})};setTimeout(i,6e3);let n=setInterval(i,parseInt(1e3*e.CONFIG.CHECK_HOUR_ROOM_INTERVAL))}}const n=t=>{let i=setTimeout(()=>{if(e.raffleId_list.length>0||e.guardId_list.length>0||e.pkId_list.length>0)return MYDEBUG("[åˆ·æ–°ç›´æ’­é—´]","è¿˜æœ‰ç¤¼ç‰©æ²¡æŠ½ï¼Œå»¶è¿Ÿ15sååˆ·æ–°ç›´æ’­é—´"),n(15e3);if(checkNewDay(e.CACHE.LittleHeart_TS))return MYDEBUG("[åˆ·æ–°ç›´æ’­é—´]","æ­£åœ¨è·å–å°å¿ƒå¿ƒï¼Œ10åˆ†é’Ÿåå†æ¬¡æ£€æŸ¥"),clearTimeout(i),n(6e5);if(inTimeArea(e.CONFIG.TIME_AREA_START_H0UR,e.CONFIG.TIME_AREA_END_H0UR,e.CONFIG.TIME_AREA_START_MINUTE,e.CONFIG.TIME_AREA_END_MINUTE)&&e.CONFIG.IN_TIME_RELOAD_DISABLE){let t=getIntervalTime(e.CONFIG.TIME_AREA_START_MINUTE,e.CONFIG.TIME_AREA_END_MINUTE)+6e4;return MYDEBUG("[åˆ·æ–°ç›´æ’­é—´]",`å¤„äºä¼‘çœ æ—¶é—´æ®µï¼Œå°†åœ¨${t}æ¯«ç§’ååˆ·æ–°ç›´æ’­é—´`),n(t)}window.location.reload()},t)};e.CONFIG.TIME_RELOAD&&n(6e4*e.CONFIG.TIME_RELOAD_MINUTE)}function removeValinArray(e,t){const i=t.indexOf(e);if(i>-1)return t.splice(i,1)}function fixVersionDifferences(e){const t=["AUTO_GIFT_ROOMID","EXCLUDE_ROOMID","COIN_UID"];if(!t.every(t=>$.isArray(e.CONFIG[t])))for(const i of t)$.isArray(e.CONFIG[i])||(e.CONFIG[i]=String(e.CONFIG[i]).split(","));"POLLING"==e.CONFIG.ANCHOR_TYPE?e.CONFIG.ANCHOR_TYPE="ANCHOR_POLLING":"LIVEROOM"==e.CONFIG.ANCHOR_TYPE&&(e.CONFIG.ANCHOR_TYPE="ANCHOR_LIVEROOM"),"high"==e.CONFIG.GIFT_SORT?e.CONFIG.GIFT_SORT="GIFT_SORT_HIGH":"low"==e.CONFIG.GIFT_SORT&&(e.CONFIG.GIFT_SORT="GIFT_SORT_LOW"),e.saveConfig(!1)}function downFile(e,t){let i=document.createElement("a");i.setAttribute("href","data:text/plain;charset=utf-8,"+JSON.stringify(t)),i.setAttribute("download",e),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}function exportConfig(e,t,i){return downFile("BLTH_CONFIG.json",{MY_API:e,nosleepConfig:t,INVISIBLE_ENTER_config:i})}function importConfig(){let e=document.getElementById("BLTH_config_file").files[0],t=new FileReader;function i(){return layer.msg("æ–‡ä»¶æ ¼å¼é”™è¯¯",{time:2e3,icon:2})}t.readAsText(e),t.onload=function(){MYDEBUG("importConfig æ–‡ä»¶è¯»å–ç»“æœï¼š",this.result);try{if(readConfigArray[0]=JSON.parse(this.result),"object"==typeof readConfigArray[0]&&readConfigArray[0]){const e=["MY_API","nosleepConfig","INVISIBLE_ENTER_config"];for(const t of e)if(!readConfigArray[0].hasOwnProperty(t))return i();return readConfigArray[1].resolve()}return i()}catch(e){return MYDEBUG("importConfig errorï¼š",e),i()}}}function getIntervalTime(e,t,i=0){const n=new Date,o=3600*e*1e3+60*t*1e3+1e3*i-(3600*n.getHours()*1e3+60*n.getMinutes()*1e3+1e3*n.getSeconds());return MYDEBUG("[getIntervalTime]è·å–é—´éš”æ—¶é—´",o+"æ¯«ç§’"),o<0?864e5+o:o}function isTime(e,t,i){let n=new Date,o=n.getHours(),a=n.getMinutes(),r=n.getSeconds();return o==e&&a==t&&!i||o==e&&a==t&&r==i||(MYDEBUG("isTime é”™è¯¯æ—¶é—´",`ç›®æ ‡æ—¶é—´${e}æ—¶${t}åˆ†${i||0}ç§’ï¼Œå½“å‰æ—¶é—´${o}æ—¶${a}åˆ†${r}ç§’`),!1)}function inTimeArea(e,t,i,n){if(e>23||t>24||e<0||t<1||i>59||i<0||n>59||n<0)return!1;const o=new Date,a=o.getHours(),r=o.getMinutes();return e<t?a>=e&&a<t||a==t&&r>=i&&r<n:e>t?a>=e||a<t||a==t&&r>=i&&r<n:e==t?a==e&&i<=n&&r>=i&&r<n||a==e&&i>n&&r<=n&&r>i:void 0}function sleep(e){return new Promise(t=>{setTimeout(()=>{t()},e)})}function probability(e){if(e<=0)return!1;return e/100>=Math.random()}newWindow.init(),$(document).ready(()=>{if(nosleepConfig=localStorage.getItem(NAME+"_NOSLEEP"),"true"===nosleepConfig){const e=screen.availWidth,t=screen.availHeight;let i=document.createEvent("MouseEvents");setInterval(()=>{let n=parseInt(Math.random()*e),o=parseInt(Math.random()*t);i.initMouseEvent("mousemove",!0,!0,W,0,n,o,n,o,!1,!1,!0,!1,0,null),W.dispatchEvent(i)},3e5),W.addEventListener=(...e)=>e[0].indexOf("visibilitychange")>-1?void 0:eventListener(...e)}if(INVISIBLE_ENTER_config=localStorage.getItem(NAME+"_INVISIBLE_ENTER"),"true"===INVISIBLE_ENTER_config)try{ah.proxy({onRequest:(e,t)=>{e.url.includes("//api.live.bilibili.com/xlive/web-room/v1/index/getInfoByUser")&&(MYDEBUG("getInfoByUser request",e),e.url="//api.live.bilibili.com/xlive/web-room/v1/index/getInfoByUser?room_id=22474988"),t.next(e)},onResponse:async(e,t)=>{e.config.url.includes("//api.live.bilibili.com/xlive/web-room/v1/index/getInfoByUser")&&(MYDEBUG("getInfoByUser response",e),e.response.includes('"code":0')||(MYDEBUG("éšèº«å…¥åœºå‡ºé”™ï¼Œå–æ¶ˆéšèº«å…¥åœºå¹¶ä»¥å½“å‰æˆ¿é—´å·å†æ¬¡è·å–ç”¨æˆ·æ•°æ®"),e.response=await BAPI.xlive.getInfoByUser(W.BilibiliLive.ROOMID).then(e=>{if(MYDEBUG("API.xlive.getInfoByUser(W.BilibiliLive.ROOMID)",e),0===e.code)return JSON.stringify(e);window.toast("è·å–æˆ¿é—´åŸºç¡€ä¿¡æ¯å¤±è´¥","error")})),e.response=e.response.replace('"is_room_admin":false','"is_room_admin":true')),t.next(e)}})}catch(e){MYDEBUG("ah.proxy Ajax-hookä»£ç†è¿è¡Œå‡ºé”™",e)}}),window.onload=()=>{try{let e=localStorage.getItem(NAME+"_UNIQUE_CHECK_CACHE")||0;const t=ts_ms();if(t-e>=0&&t-e<=15e3)return window.toast("æœ‰å…¶ä»–ç›´æ’­é—´é¡µé¢çš„è„šæœ¬æ­£åœ¨è¿è¡Œï¼Œæœ¬é¡µé¢è„šæœ¬åœæ­¢è¿è¡Œ","caution"),$.Deferred().resolve();let i;const n=()=>{i=setTimeout(n,1e4),e=ts_ms(),localStorage.setItem(NAME+"_UNIQUE_CHECK_CACHE",e)};window.addEventListener("unload",()=>{i&&(clearTimeout(i),localStorage.setItem(NAME+"_UNIQUE_CHECK_CACHE",0))}),n()}catch(e){return MYDEBUG("é‡å¤è¿è¡Œæ£€æµ‹é”™è¯¯",e),$.Deferred().reject()}const e=(t=0)=>setTimeout(async()=>{if(void 0===W.BilibiliLive||0===parseInt(W.BilibiliLive.UID)||isNaN(parseInt(W.BilibiliLive.UID)))return e(1e3);Live_info.room_id=W.BilibiliLive.ROOMID,Live_info.uid=W.BilibiliLive.UID,Live_info.tid=W.BilibiliLive.ANCHOR_UID,await BAPI.gift.gift_config().then(e=>{MYDEBUG("InitData: API.gift.gift_config",e),e.data&&$.isArray(e.data)?Live_info.gift_list=e.data:e.data.list&&$.isArray(e.data.list)?Live_info.gift_list=e.data.list:(Live_info.gift_list=[{id:6,price:1e3},{id:1,price:100},{id:30607,price:5e3}],window.toast("ç›´æ’­é—´ç¤¼ç‰©æ•°æ®è·å–å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ•°æ®","warning"))}),await BAPI.getuserinfo().then(e=>{MYDEBUG("InitData: API.getuserinfo",e),e.data?(Live_info.uname=e.data.uname,Live_info.user_level=e.data.user_level):window.toast("API.getuserinfo è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥ "+e.message,"error")}),await BAPI.x.getAccInfo(Live_info.uid).then(e=>{MYDEBUG("InitData: API.x.getAccInfo",e),0===e.code?Live_info.level=e.data.level:window.toast("API.x.getAccInfo è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥ "+e.message,"error")}),Live_info.bili_jct=BAPI.getCookie("bili_jct"),Live_info.ruid=W.BilibiliLive.ANCHOR_UID,Live_info.rnd=W.BilibiliLive.RND,Live_info.visit_id=W.__statisObserver?W.__statisObserver.__visitId:"",MYDEBUG("Live_info",Live_info),init()},t);return e(0)},String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"gm"),t)};const checkNewDay=e=>{if(0===e)return!0;let t=new Date(e),i=new Date,n=t.getDate();return i.getDate()!==n};function FT_sendMsg(e,t,i){return XHR({GM:!0,anonymous:!0,method:"POST",url:`https://sc.ftqq.com/${e}.send`,data:`text=${t}&desp=${i}`,responseType:"json"})}function GM_notice(e,t,i=1e4){return GM_notification({title:e,text:t,timeout:i,onclick:function(){logDiv.hasClass("active")&&logDiv.click()}})}function getMsgDevId(e=NAME){let t=window.localStorage.getItem("im_deviceid_".concat(e));if(!e||!t){let t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16).toUpperCase()}));return function(e,t){Object.keys(localStorage).forEach((function(e){e.match(/^im_deviceid_/)&&window.localStorage.removeItem(e)})),window.localStorage.setItem("im_deviceid_".concat(t),e)}(t,e),t}return t}function XHR(e){return new Promise(t=>{const i=e=>{console.error(GM_info.script.name,e),t(void 0)};if(e.GM)"POST"===e.method&&(void 0===e.headers&&(e.headers={}),void 0===e.headers["Content-Type"]&&(e.headers["Content-Type"]="application/x-www-form-urlencoded; charset=utf-8")),e.timeout=3e4,e.onload=e=>t({response:e,body:e.response}),e.onerror=i,e.ontimeout=i,GM_xmlhttpRequest(e);else{const n=new XMLHttpRequest;n.open(e.method,e.url),"POST"===e.method&&null===n.getResponseHeader("Content-Type")&&n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8"),e.cookie&&(n.withCredentials=!0),void 0!==e.responseType&&(n.responseType=e.responseType),n.timeout=3e4,n.onload=e=>{const i=e.target;t({response:i,body:i.response})},n.onerror=i,n.ontimeout=i,n.send(e.data)}})}})();